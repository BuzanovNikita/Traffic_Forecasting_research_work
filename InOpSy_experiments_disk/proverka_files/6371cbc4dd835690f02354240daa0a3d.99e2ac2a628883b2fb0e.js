/*! For license information please see 6371cbc4dd835690f02354240daa0a3d.99e2ac2a628883b2fb0e.js.LICENSE.txt */
(self.webpackChunkvk=self.webpackChunkvk||[]).push([[40051],{612696:(e,t,s)=>{"use strict";s.d(t,{Icon56IllustrationAntennaDark:()=>n});var n=(0,s(28178).makeIcon)("Icon56IllustrationAntennaDark","illustration_antenna_dark_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56" id="illustration_antenna_dark_56"><path fill="#2929B2" d="m18.834 33.983-.123-.097a3.054 3.054 0 0 0-4.288.516l-6.06 7.717a3.054 3.054 0 0 0 .516 4.289l.123.096a3.054 3.054 0 0 0 4.288-.515l6.06-7.718a3.054 3.054 0 0 0-.516-4.288Z" /><path fill="#07F" d="M44.493 37.686c-7.576 8.417-20.262 7.696-29.437-.505S3.812 16.354 11.388 7.888a68.327 68.327 0 0 1 19.168 12.025 66.294 66.294 0 0 1 13.937 17.773Z" /><path fill="#00EAFF" d="M44.396 37.794c-3.234 3.608-13.227-.108-22.462-8.309-9.235-8.2-13.985-17.773-10.75-21.392.144-.157 1.034-1.203 1.202-1.347 3.607-2.838 12.494 1.816 21.248 9.62 8.273 7.443 13.696 15.488 12.145 19.709a9.272 9.272 0 0 1-1.383 1.72Z" /><path fill="#07F" d="M45.526 36.532c2.785-3.114-2.39-12.285-11.557-20.484-9.167-8.2-18.857-12.323-21.641-9.21-2.785 3.114 2.389 12.285 11.556 20.485 9.168 8.2 18.857 12.323 21.642 9.209Z" /><mask id="illustration_antenna_dark_56_a" width="36" height="33" x="11" y="5" maskUnits="userSpaceOnUse" style="mask-type:alpha"><path fill="#07F" d="M45.526 36.532c2.785-3.114-2.39-12.285-11.557-20.484-9.167-8.2-18.857-12.323-21.641-9.21-2.785 3.114 2.389 12.285 11.556 20.485 9.168 8.2 18.857 12.323 21.642 9.209Z" /></mask><g mask="url(#illustration_antenna_dark_56_a)"><path fill="#2929B2" d="M39.5 42.822c2.784-3.114-2.39-12.285-11.557-20.484-9.168-8.2-18.857-12.323-21.642-9.21-2.785 3.114 2.39 12.285 11.557 20.485s18.857 12.323 21.641 9.21Z" /></g><path fill="#00EAFF" d="m30.808 19.637.205.192L25 28.247a37.414 37.414 0 0 1-2.188-1.96l7.996-6.65Z" /><path fill="#00EAFF" d="M31 21.549a2.2 2.2 0 1 0 0-4.401 2.2 2.2 0 0 0 0 4.4Z" /><path fill="#2929B2" d="M40.705 19.072a.901.901 0 0 1-.89-.794 7.84 7.84 0 0 0-3.92-5.94 7.636 7.636 0 0 0-4.065-1.023.926.926 0 0 1-.926-.877.902.902 0 0 1 .878-.926 9.716 9.716 0 0 1 5.015 1.202 9.62 9.62 0 0 1 4.81 7.287.901.901 0 0 1-.782 1.01l-.12.06Z" /><path fill="#07F" d="M45.767 18.146a.914.914 0 0 1-.902-.794 12.025 12.025 0 0 0-6.012-9.151 11.784 11.784 0 0 0-6.277-1.575.902.902 0 1 1 0-1.804 13.648 13.648 0 0 1 7.215 1.804 13.865 13.865 0 0 1 6.926 10.51.889.889 0 0 1-.781.998l-.169.012Z" /><path fill="#00EAFF" d="M50.457 17.424a.914.914 0 0 1-.902-.842A15.705 15.705 0 0 0 33.213 1.816a.914.914 0 0 1-.926-.854A.926.926 0 0 1 33.13 0a17.46 17.46 0 0 1 9.392 2.26 17.64 17.64 0 0 1 8.838 14.19.914.914 0 0 1-.842.962l-.06.012Z" /><path fill="#07F" d="M14.575 44.444a3.52 3.52 0 0 0-3.518-3.523 3.52 3.52 0 0 0-3.517 3.523v5.435a3.52 3.52 0 0 0 3.517 3.524 3.52 3.52 0 0 0 3.518-3.524v-5.435Z" /><path fill="#07F" d="M24.603 54.4H6.338a.913.913 0 0 1-.926-.925v-3.608a.914.914 0 0 1 .926-.926h10.064c.68 0 1.347.179 1.936.517l6.566 3.836a.601.601 0 0 1-.3 1.107Z" /><path fill="#00EAFF" d="M11.063 45.839a1.527 1.527 0 1 0 0-3.054 1.527 1.527 0 0 0 0 3.054Z" /><path fill="#2929B2" d="M24.964 52.813H5.244a.613.613 0 0 0-.614.614v1.96c0 .338.275.613.613.613h19.721a.613.613 0 0 0 .613-.613v-1.96a.613.613 0 0 0-.613-.614Z" /></symbol>',56,56,!1,void 0)},791771:(e,t,s)=>{"use strict";s.d(t,{Icon56IllustrationAntennaLight:()=>n});var n=(0,s(28178).makeIcon)("Icon56IllustrationAntennaLight","illustration_antenna_light_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56" id="illustration_antenna_light_56"><path fill="#07F" d="m18.834 33.983-.123-.097a3.054 3.054 0 0 0-4.288.516l-6.06 7.717a3.054 3.054 0 0 0 .516 4.289l.123.096a3.054 3.054 0 0 0 4.288-.515l6.06-7.718a3.054 3.054 0 0 0-.516-4.288Z" /><path fill="#00EAFF" d="M44.493 37.686c-7.576 8.417-20.262 7.696-29.437-.505S3.812 16.354 11.388 7.888a68.327 68.327 0 0 1 19.168 12.025 66.294 66.294 0 0 1 13.937 17.773Z" /><path fill="#fff" d="M44.396 37.794c-3.234 3.608-13.227-.108-22.462-8.309-9.235-8.2-13.985-17.773-10.75-21.392.144-.157 1.034-1.203 1.202-1.347 3.607-2.838 12.494 1.816 21.248 9.62 8.273 7.443 13.696 15.488 12.145 19.709a9.272 9.272 0 0 1-1.383 1.72Z" /><path fill="#07F" d="M45.526 36.532c2.785-3.114-2.39-12.285-11.557-20.484-9.167-8.2-18.857-12.323-21.641-9.21-2.785 3.114 2.389 12.285 11.556 20.485 9.168 8.2 18.857 12.323 21.642 9.209Z" /><mask id="illustration_antenna_light_56_a" width="36" height="33" x="11" y="5" maskUnits="userSpaceOnUse" style="mask-type:alpha"><path fill="#07F" d="M45.526 36.532c2.785-3.114-2.39-12.285-11.557-20.484-9.167-8.2-18.857-12.323-21.641-9.21-2.785 3.114 2.389 12.285 11.556 20.485 9.168 8.2 18.857 12.323 21.642 9.209Z" /></mask><g mask="url(#illustration_antenna_light_56_a)"><path fill="#2929B2" d="M39.5 42.822c2.784-3.114-2.39-12.285-11.557-20.484-9.168-8.2-18.857-12.323-21.642-9.21-2.785 3.114 2.39 12.285 11.557 20.485s18.857 12.323 21.641 9.21Z" /></g><path fill="#00EAFF" d="m30.808 19.637.205.192L25 28.247a37.414 37.414 0 0 1-2.188-1.96l7.996-6.65Z" /><path fill="#00EAFF" d="M31 21.549a2.2 2.2 0 1 0 0-4.401 2.2 2.2 0 0 0 0 4.4Z" /><path fill="#2929B2" d="M40.705 19.072a.901.901 0 0 1-.89-.794 7.84 7.84 0 0 0-3.92-5.94 7.636 7.636 0 0 0-4.065-1.023.926.926 0 0 1-.926-.877.902.902 0 0 1 .878-.926 9.716 9.716 0 0 1 5.015 1.202 9.62 9.62 0 0 1 4.81 7.287.901.901 0 0 1-.782 1.01l-.12.06Z" /><path fill="#07F" d="M45.767 18.146a.914.914 0 0 1-.902-.794 12.025 12.025 0 0 0-6.012-9.151 11.784 11.784 0 0 0-6.277-1.575.902.902 0 1 1 0-1.804 13.648 13.648 0 0 1 7.215 1.804 13.865 13.865 0 0 1 6.926 10.51.889.889 0 0 1-.781.998l-.169.012Z" /><path fill="#00EAFF" d="M50.457 17.424a.914.914 0 0 1-.902-.842A15.705 15.705 0 0 0 33.213 1.816a.914.914 0 0 1-.926-.854A.926.926 0 0 1 33.13 0a17.46 17.46 0 0 1 9.392 2.26 17.64 17.64 0 0 1 8.838 14.19.914.914 0 0 1-.842.962l-.06.012Z" /><path fill="#2929B2" d="M14.575 44.444a3.52 3.52 0 0 0-3.518-3.523 3.52 3.52 0 0 0-3.517 3.523v5.435a3.52 3.52 0 0 0 3.517 3.524 3.52 3.52 0 0 0 3.518-3.524v-5.435Z" /><path fill="#00EAFF" d="M24.603 54.4H6.338a.913.913 0 0 1-.926-.925v-3.608a.914.914 0 0 1 .926-.926h10.064c.68 0 1.347.179 1.936.517l6.566 3.836a.601.601 0 0 1-.3 1.107Z" /><path fill="#fff" d="M11.063 45.839a1.527 1.527 0 1 0 0-3.054 1.527 1.527 0 0 0 0 3.054Z" /><path fill="#07F" d="M24.964 52.813H5.244a.613.613 0 0 0-.614.614v1.96c0 .338.275.613.613.613h19.721a.613.613 0 0 0 .613-.613v-1.96a.613.613 0 0 0-.613-.614Z" /></symbol>',56,56,!1,void 0)},20403:(e,t,s)=>{"use strict";s.d(t,{Icon12Favorite:()=>n});var n=(0,s(28178).makeIcon)("Icon12Favorite","favorite_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 12 12" id="favorite_12"><path d="m4.559 2.876-.277.653a.337.337 0 0 1-.044.086.15.15 0 0 1-.048.037.322.322 0 0 1-.093.02l-.403.059c-1.136.163-1.703.245-1.942.516a1.015 1.015 0 0 0-.233.866c.07.357.518.723 1.412 1.454l.153.124c.04.033.06.05.074.07.011.02.019.04.022.062a.344.344 0 0 1-.011.103l-.046.245c-.25 1.347-.375 2.02-.178 2.35.17.285.47.465.796.479.378.016.895-.423 1.93-1.3l.177-.15a.351.351 0 0 1 .111-.077.146.146 0 0 1 .082 0c.03.008.057.031.111.077l.178.15c1.034.877 1.55 1.316 1.929 1.3a.979.979 0 0 0 .796-.479c.197-.33.072-1.003-.178-2.35l-.046-.245a.344.344 0 0 1-.01-.103.154.154 0 0 1 .021-.061.339.339 0 0 1 .074-.07l.153-.125c.894-.731 1.342-1.097 1.412-1.454.06-.31-.025-.631-.233-.866-.239-.27-.806-.353-1.942-.516l-.403-.058c-.048-.007-.072-.01-.093-.02a.15.15 0 0 1-.048-.038c-.015-.018-.024-.04-.044-.086l-.277-.653c-.455-1.071-.682-1.607-1-1.77a.965.965 0 0 0-.881 0c-.319.163-.546.699-1.001 1.77Z" /></symbol>',12,12,!1,void 0)},546134:(e,t,s)=>{"use strict";s.d(t,{Icon12MessageCross:()=>n});var n=(0,s(28178).makeIcon)("Icon12MessageCross","message_cross_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 12 12" id="message_cross_12"><path fill-rule="evenodd" d="M12 5.538C12 2.479 9.318 0 6.01 0 2.704 0 .022 2.48.022 5.538c0 1.087.34 2.102.925 2.952 0 .946-.409 1.912-.778 2.784-.05.118-.1.235-.147.35-.074.178.057.383.236.376 1.56-.066 2.678-.528 3.355-1.386a6.387 6.387 0 0 0 2.399.462c3.307 0 5.989-2.48 5.989-5.538ZM3.72 3.22a.75.75 0 0 1 1.06 0L6 4.438 7.217 3.22a.75.75 0 0 1 1.06 1.06L7.06 5.5l1.218 1.218a.75.75 0 0 1-1.06 1.06L5.999 6.56 4.78 7.777a.75.75 0 0 1-1.06-1.06l1.218-1.218L3.72 4.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" /></symbol>',12,12,!1,void 0)},354819:(e,t,s)=>{"use strict";s.d(t,{Icon16Education:()=>n});var n=(0,s(28178).makeIcon)("Icon16Education","education_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="education_16"><path fill="currentColor" d="M14.495 5.078 8.467 1.625a.936.936 0 0 0-.934 0L1.505 5.078a.995.995 0 0 0-.385.402c-.258.492-.086 1.11.385 1.38l.995.567 5.002 2.874a1 1 0 0 0 .996 0l4.168-2.395 1.167-.668v2.996c0 .337.261.61.583.61a.597.597 0 0 0 .584-.61V5.968c0-.358-.183-.705-.505-.89Z" /><path fill="currentColor" d="M12.666 9.385 8.48 11.666a1 1 0 0 1-.958 0L3.333 9.382v1.055C3.334 12.713 5.447 14.5 8 14.5s4.667-1.787 4.667-4.063V9.385Z" /></symbol>',16,16,!1,void 0)},900917:(e,t,s)=>{"use strict";s.d(t,{Icon16Ghost:()=>n});var n=(0,s(28178).makeIcon)("Icon16Ghost","ghost_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" id="ghost_16"><path fill-rule="evenodd" d="M8 1a6.5 6.5 0 0 0-6.5 6.5v4.881c0 .407.095.809.277 1.172a1.498 1.498 0 0 0 2.11.615l.35-.21a1.406 1.406 0 0 1 1.504.036l.857.571.03.02a2.5 2.5 0 0 0 2.745 0l.03-.02.856-.571a1.406 1.406 0 0 1 1.504-.036l.35.21c.748.449 1.72.166 2.11-.615a2.62 2.62 0 0 0 .277-1.172V7.5A6.5 6.5 0 0 0 8 1Zm-1.091 9.121a.75.75 0 0 0-.818 1.258c.601.39 1.243.618 1.916.619.675 0 1.315-.225 1.911-.625a.75.75 0 1 0-.836-1.246c-.397.267-.75.371-1.072.37-.325 0-.687-.107-1.101-.376ZM5.5 8.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm6-1a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z" clip-rule="evenodd" /></symbol>',16,16,!1,void 0)},397662:(e,t,s)=>{"use strict";s.d(t,{Icon16LogoVk:()=>n});var n=(0,s(28178).makeIcon)("Icon16LogoVk","logo_vk_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="logo_vk_16"><path fill="currentColor" fill-rule="evenodd" d="M2.844 2.844C2 3.687 2 5.044 2 7.76v.48c0 2.715 0 4.073.844 4.916.843.844 2.2.844 4.916.844h.48c2.715 0 4.073 0 4.916-.844.844-.843.844-2.2.844-4.916v-.48c0-2.715 0-4.073-.844-4.916C12.313 2 10.956 2 8.24 2h-.48c-2.715 0-4.073 0-4.916.844ZM4 5.65c.065 3.123 1.624 5 4.357 5h.155V8.863c1.005.1 1.764.836 2.069 1.787H12c-.39-1.421-1.414-2.207-2.054-2.507.64-.37 1.54-1.272 1.754-2.493h-1.29c-.279.991-1.108 1.892-1.898 1.977V5.65H7.223v3.463c-.8-.2-1.809-1.17-1.854-3.463H4Z" clip-rule="evenodd" /></symbol>',16,16,!1,void 0)},277937:(e,t,s)=>{"use strict";s.d(t,{Icon16MessageCross:()=>n});var n=(0,s(28178).makeIcon)("Icon16MessageCross","message_cross_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" id="message_cross_16"><path fill-rule="evenodd" d="M14.5 7.766C14.5 4.582 11.59 2 8 2S1.5 4.582 1.5 7.766c0 1.554.693 2.964 1.82 4-.11.646-.44 1.493-.994 2.54l-.126.235a.313.313 0 0 0 .117.42.294.294 0 0 0 .22.03c1.723-.443 2.954-1.002 3.692-1.675A7.28 7.28 0 0 0 8 13.531c3.59 0 6.5-2.581 6.5-5.766ZM5.721 5.372a.75.75 0 0 1 1.06 0L8 6.59l1.218-1.218a.75.75 0 0 1 1.06 1.06l-1.217 1.22 1.218 1.217a.75.75 0 0 1-1.06 1.061L8 8.712 6.782 9.93a.75.75 0 1 1-1.06-1.06l1.216-1.22-1.217-1.217a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" /></symbol>',16,16,!1,void 0)},998901:(e,t,s)=>{"use strict";s.d(t,{Icon16Muted:()=>n});var n=(0,s(28178).makeIcon)("Icon16Muted","muted_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" id="muted_16"><path d="m4.69 5.496 6.31 6.31v1.702c0 .284-.225.464-.488.488l-3.635-3.489-2.88-.008A1 1 0 0 1 3 9.5V6.497a1 1 0 0 1 1-1l.69-.001Zm.774-2.846 2.191 2.19 2.857-2.344c.263.023.488.204.488.488v5.201l2.596 2.596a.75.75 0 0 1-1.06 1.061L4.404 3.71a.75.75 0 0 1 1.06-1.06Z" /></symbol>',16,16,!1,void 0)},96715:(e,t,s)=>{"use strict";s.d(t,{Icon16Verified:()=>n});var n=(0,s(28178).makeIcon)("Icon16Verified","verified_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="verified_16"><path fill="currentColor" d="M4.5 9.586 2.957 8.043a1 1 0 0 0-1.414 1.414l2.25 2.25a1 1 0 0 0 1.414 0l5.25-5.25a1 1 0 0 0-1.414-1.414L4.5 9.586Z" /></symbol>',16,16,!1,void 0)},820210:(e,t,s)=>{"use strict";s.d(t,{Icon20EducationOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon20EducationOutline","education_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" id="education_outline_20"><g fill="none" fill-rule="evenodd"><path d="M0 0h20v20H0z" /><path fill="currentColor" fill-rule="nonzero" d="m17.5 9.063-1.5.822V13c0 2.8-2.717 5-6 5s-6-2.2-6-5V9.885L1.649 8.596a1.25 1.25 0 0 1 0-2.192l7.75-4.25a1.25 1.25 0 0 1 1.202 0l7.75 4.25c.424.232.66.674.649 1.125v5.221a.75.75 0 1 1-1.5 0V9.063Zm-3 1.645-3.899 2.138a1.25 1.25 0 0 1-1.202 0L5.5 10.708V13c0 1.894 1.984 3.5 4.5 3.5s4.5-1.606 4.5-3.5v-2.292ZM10 3.535 2.77 7.5 10 11.465 17.23 7.5 10 3.535Z" /></g></symbol>',20,20,!1,void 0)},661620:(e,t,s)=>{"use strict";s.d(t,{Icon20FolderOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon20FolderOutline","folder_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="folder_outline_20"><path fill-rule="evenodd" d="M7.066 2.058C6.812 2 6.552 2 6.256 2h-.09c-.65 0-1.18 0-1.612.034-.446.035-.85.11-1.23.295A3.25 3.25 0 0 0 1.83 3.824c-.185.38-.26.784-.295 1.23-.034.432-.034.962-.034 1.611v5.616c0 .674 0 1.224.037 1.672.037.463.118.882.317 1.272a3.25 3.25 0 0 0 1.42 1.42c.391.2.81.28 1.273.318.447.037.998.037 1.671.037h7.563c.674 0 1.224 0 1.672-.037.463-.038.882-.118 1.272-.317a3.25 3.25 0 0 0 1.42-1.42c.2-.391.28-.81.318-1.273.037-.448.037-.998.037-1.672V8.85c0-.673 0-1.224-.037-1.672-.037-.463-.118-.881-.317-1.272a3.25 3.25 0 0 0-1.42-1.42c-.391-.2-.81-.28-1.273-.318-.447-.037-.998-.037-1.672-.037h-3.486c-.404 0-.484-.004-.55-.02a.75.75 0 0 1-.218-.091c-.059-.036-.118-.09-.403-.377l-.758-.764c-.208-.21-.391-.395-.611-.534a2.25 2.25 0 0 0-.69-.287ZM6.196 3.5c.39 0 .466.004.53.02a.75.75 0 0 1 .23.095c.056.035.113.086.388.363l.759.766c.216.218.406.41.636.552.202.125.423.217.653.273.263.063.534.063.84.063h3.518c.712 0 1.202 0 1.58.031.371.03.57.086.714.16.33.167.598.435.765.764.074.144.13.343.16.714.005.063.009.129.012.199H3v-.805c0-.686 0-1.157.03-1.523.027-.357.08-.55.147-.69a1.75 1.75 0 0 1 .805-.805c.14-.068.333-.12.69-.148.366-.029.837-.03 1.523-.03ZM3 9v3.25c0 .712 0 1.202.032 1.58.03.371.085.57.159.714.167.33.435.597.764.765.145.074.344.129.714.16.38.03.869.03 1.581.03h7.5c.712 0 1.202 0 1.58-.03.371-.031.57-.086.714-.16a1.75 1.75 0 0 0 .765-.765c.074-.144.13-.343.16-.713.03-.38.031-.869.031-1.581V9H3Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},561743:(e,t,s)=>{"use strict";s.d(t,{Icon20GlobeCrossOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon20GlobeCrossOutline","globe_cross_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="globe_cross_outline_20"><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"><path d="M8.219 7.999h4.191a.75.75 0 0 0 .7-1.02 19.061 19.061 0 0 0-1.653-3.827 7.013 7.013 0 0 1 5.08 4.339l.01.024a.75.75 0 1 0 1.401-.533l-.01-.03A8.5 8.5 0 1 0 6.973 17.945a.75.75 0 0 0 .533-1.4 7.023 7.023 0 0 1-3.57-3.043H6.86a.75.75 0 1 0 0-1.5H3.29A7 7 0 0 1 3 10c0-.696.101-1.367.29-2.001h3.401a12.457 12.457 0 0 0-.182 1.623l-.003.059a.884.884 0 0 0 .002.106.75.75 0 1 0 1.498-.078l.001-.018c.027-.584.101-1.15.212-1.692zm.361-4.855a7.01 7.01 0 0 0-4.643 3.355h3.116c.39-1.281.942-2.414 1.527-3.355zm1.443.528a17.78 17.78 0 0 1 1.344 2.827H8.63c.375-1.084.876-2.04 1.393-2.827z" /><path d="M14.002 19a5 5 0 1 0 0-10 5 5 0 0 0 0 10zm2.524-6.47a.75.75 0 1 0-1.061-1.06l-1.466 1.468-1.469-1.468a.75.75 0 1 0-1.06 1.06L12.938 14l-1.469 1.47a.75.75 0 1 0 1.062 1.06l1.468-1.47 1.47 1.47a.75.75 0 1 0 1.061-1.06l-1.47-1.471z" /></g></symbol>',20,20,!1,void 0)},707599:(e,t,s)=>{"use strict";s.d(t,{Icon20NotificationOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon20NotificationOutline","notification_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="notification_outline_20"><path fill="currentColor" fill-rule="evenodd" d="M5.5 8a4.5 4.5 0 0 1 9-.008v1.674c0 .297.106.584.299.81l1.523 1.787a.75.75 0 0 1-.571 1.237H4.249a.75.75 0 0 1-.57-1.237L5.2 10.477a1.25 1.25 0 0 0 .299-.811V8zm-1.488-.385a6 6 0 0 1 11.976 0c.008.044.012.089.012.135v1.823l1.463 1.717c1.245 1.461.207 3.71-1.712 3.71h-2.076a3.751 3.751 0 0 1-7.35 0H4.249c-1.919 0-2.957-2.249-1.712-3.71L4 9.575V7.75c0-.046.004-.091.012-.135zM10 16.5A2.25 2.25 0 0 1 7.878 15h4.244A2.251 2.251 0 0 1 10 16.5z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},644695:(e,t,s)=>{"use strict";s.d(t,{Icon20PalleteOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon20PalleteOutline","pallete_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="pallete_outline_20"><g fill="currentColor"><path d="M10.8 6.05a1.25 1.25 0 1 1 2.5 0 1.25 1.25 0 0 1-2.5 0zM14.45 8.2a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5zM4.3 9.45a1.25 1.25 0 1 1 2.5 0 1.25 1.25 0 0 1-2.5 0zM7.85 4.8a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5z" /><path fill-rule="evenodd" d="M14.177 14.037c2.142.23 4.323-.743 4.323-4.037 0-2.347-.951-4.472-2.49-6.01S12.347 1.5 10 1.5s-4.472.951-6.01 2.49S1.5 7.653 1.5 10s.951 4.472 2.49 6.01S7.653 18.5 10 18.5c1.13 0 2.255-1.007 1.977-2.425-.047-.24-.11-.472-.168-.688-.254-.94-.43-1.59 1.076-1.487.036.002.455.047 1.292.137zm.16-1.491-.246-.027c-.653-.07-1.037-.11-1.103-.116-.525-.036-1.172-.024-1.74.264a1.996 1.996 0 0 0-1.102 1.687c-.033.476.089.944.154 1.197l.072.27c.054.197.097.357.133.542a.58.58 0 0 1-.003.277.435.435 0 0 1-.099.173A.574.574 0 0 1 10 17a6.973 6.973 0 0 1-4.95-2.05A6.973 6.973 0 0 1 3 10c0-1.933.782-3.681 2.05-4.95A6.973 6.973 0 0 1 10 3c1.933 0 3.681.782 4.95 2.05A6.973 6.973 0 0 1 17 10c0 1.297-.412 1.873-.774 2.152-.412.317-1.065.482-1.889.394z" clip-rule="evenodd" /></g></symbol>',20,20,!1,void 0)},966430:(e,t,s)=>{"use strict";s.d(t,{Icon20Search:()=>n});var n=(0,s(28178).makeIcon)("Icon20Search","search_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="search_20"><path fill="currentColor" fill-rule="evenodd" d="M9.5 4.5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zM3 9.5a6.5 6.5 0 1 1 11.596 4.035l3.184 3.185a.75.75 0 1 1-1.06 1.06l-3.185-3.184A6.5 6.5 0 0 1 3 9.5z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},331870:(e,t,s)=>{"use strict";s.d(t,{Icon20UserAddOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon20UserAddOutline","user_add_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="user_add_outline_20"><path fill-rule="evenodd" d="M12.5 8.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5ZM8.5 6a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm-4-.25a.75.75 0 1 0-1.5 0v2H1a.75.75 0 0 0 0 1.5h2v2a.75.75 0 0 0 1.5 0v-2h2a.75.75 0 0 0 0-1.5h-2v-2Zm4.155 7.227c.865-.458 2.194-.727 3.845-.727 1.65 0 2.98.27 3.845.727.794.42 1.155.959 1.155 1.71a.685.685 0 0 1-.05.288.325.325 0 0 1-.092.12c-.077.063-.26.155-.599.155H8.241c-.34 0-.522-.092-.6-.156a.325.325 0 0 1-.09-.12.686.686 0 0 1-.051-.287c0-.751.36-1.29 1.155-1.71ZM12.5 10.75c-1.774 0-3.38.283-4.547.902C6.783 12.27 6 13.26 6 14.688c0 .688.268 1.217.687 1.563.408.337.956.499 1.554.499h8.518c.598 0 1.146-.162 1.555-.499.418-.346.686-.875.686-1.564 0-1.426-.783-2.416-1.953-3.035-1.168-.619-2.773-.902-4.547-.902Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},387613:(e,t,s)=>{"use strict";s.d(t,{Icon24Back:()=>n});var n=(0,s(28178).makeIcon)("Icon24Back","back_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="back_24"><g fill="none" fill-rule="evenodd"><path d="M24 0H0v24h24z" /><path fill="currentColor" d="m7.8 11 4.9-4.9a.99.99 0 0 0-1.4-1.4l-6.593 6.593a1 1 0 0 0 0 1.414L11.3 19.3a.99.99 0 0 0 1.4-1.4L7.8 13H20a1 1 0 0 0 0-2H7.8Z" /></g></symbol>',24,24,!1,void 0)},359251:(e,t,s)=>{"use strict";s.d(t,{Icon24BookmarkOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon24BookmarkOutline","bookmark_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="bookmark_outline_24"><path fill="currentColor" fill-rule="evenodd" d="M11.083 3h1.834c1.056 0 1.903 0 2.588.056.704.057 1.316.179 1.88.466a4.789 4.789 0 0 1 2.093 2.093c.287.564.408 1.176.466 1.88C20 8.18 20 9.027 20 10.083v7.615c0 .773 0 1.414-.045 1.914-.045.494-.145 1.026-.482 1.454a2.456 2.456 0 0 1-1.896.935c-.544.007-1.027-.238-1.447-.503-.424-.268-.933-.658-1.546-1.128l-1.617-1.24c-.607-.466-.714-.526-.797-.549a.657.657 0 0 0-.34 0c-.083.022-.19.083-.797.549l-1.617 1.24c-.613.47-1.123.86-1.546 1.128-.42.265-.903.51-1.447.503a2.456 2.456 0 0 1-1.896-.936c-.337-.427-.437-.96-.482-1.453C4 19.112 4 18.47 4 17.698v-7.615c0-1.056 0-1.903.056-2.588.057-.704.179-1.316.466-1.88a4.789 4.789 0 0 1 2.093-2.093c.564-.287 1.176-.409 1.88-.466C9.18 3 10.027 3 11.083 3zM8.641 4.85c-.593.048-.941.14-1.209.276a2.989 2.989 0 0 0-1.306 1.306c-.137.268-.228.616-.276 1.21-.05.603-.05 1.376-.05 2.48v7.532c0 .828 0 1.387.038 1.794.038.414.103.503.103.503a.655.655 0 0 0 .506.25s.11-.003.461-.225c.346-.218.79-.558 1.448-1.062l1.582-1.213.1-.077c.44-.338.85-.654 1.327-.782a2.454 2.454 0 0 1 1.27 0c.478.128.888.444 1.326.782l.101.077 1.582 1.213c.658.504 1.102.844 1.448 1.062.351.222.461.225.461.225a.655.655 0 0 0 .506-.25s.065-.089.103-.503c.037-.407.038-.966.038-1.794v-7.532c0-1.104 0-1.877-.05-2.48-.048-.594-.14-.942-.276-1.21a2.989 2.989 0 0 0-1.306-1.306c-.268-.137-.617-.228-1.21-.276-.603-.05-1.376-.05-2.48-.05h-1.756c-1.104 0-1.877 0-2.48.05z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},483704:(e,t,s)=>{"use strict";s.d(t,{Icon24DotsVertical:()=>n});var n=(0,s(28178).makeIcon)("Icon24DotsVertical","dots_vertical_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="dots_vertical_24"><path fill="currentColor" fill-rule="evenodd" d="M9 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 6a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm2 4a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm4-10a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm2 4a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm-2 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},953783:(e,t,s)=>{"use strict";s.d(t,{Icon24FolderOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon24FolderOutline","folder_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="folder_outline_24"><path fill-rule="evenodd" d="M8.424 3.05C8.18 3 7.93 3 7.67 3h-.094c-.767 0-1.395 0-1.907.04-.528.04-1.007.128-1.457.345A3.9 3.9 0 0 0 2.385 5.21c-.217.45-.304.929-.345 1.457C2 7.18 2 7.808 2 8.575v5.763c0 .808 0 1.469.044 2.006.045.556.142 1.058.381 1.527a3.9 3.9 0 0 0 1.704 1.704c.47.239.971.336 1.527.381C6.193 20 6.854 20 7.662 20h8.676c.808 0 1.469 0 2.006-.044.556-.045 1.058-.142 1.526-.381a3.9 3.9 0 0 0 1.705-1.704c.239-.47.336-.971.381-1.527.044-.537.044-1.198.044-2.006v-3.476c0-.808 0-1.469-.044-2.006-.045-.556-.142-1.058-.381-1.527a3.9 3.9 0 0 0-1.704-1.704c-.47-.239-.971-.336-1.527-.381-.537-.044-1.198-.044-2.006-.044h-4.432c-.374 0-.427-.005-.469-.014a.6.6 0 0 1-.161-.06c-.038-.022-.08-.053-.361-.3L9.718 3.773c-.195-.172-.382-.337-.6-.46a2.4 2.4 0 0 0-.694-.262ZM7.611 4.8c.356 0 .406.004.446.013a.6.6 0 0 1 .173.065c.035.02.076.05.343.285L9.77 6.218c.206.181.403.355.633.482a2.4 2.4 0 0 0 .646.244c.258.057.52.056.794.056H16.3c.855 0 1.442 0 1.897.038.445.036.684.103.856.19a2.1 2.1 0 0 1 .918.919c.088.172.155.411.191.856l.014.197H3.8v-.589c0-.812 0-1.37.034-1.803.033-.423.094-.652.173-.818a2.1 2.1 0 0 1 .983-.983c.166-.08.395-.14.818-.173.433-.033.99-.034 1.803-.034ZM3.8 11v3.3c0 .855 0 1.442.038 1.897.036.445.103.684.19.856a2.1 2.1 0 0 0 .919.918c.172.088.411.155.856.191.455.037 1.042.038 1.897.038h8.6c.855 0 1.442 0 1.897-.038.445-.036.684-.103.856-.19a2.1 2.1 0 0 0 .918-.919c.088-.172.155-.411.191-.856.037-.455.038-1.042.038-1.897V11H3.8Z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},917303:(e,t,s)=>{"use strict";s.d(t,{Icon24PhoneAddOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon24PhoneAddOutline","phone_add_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="phone_add_outline_24"><g fill="currentColor"><path d="M4.495 4.123c-2.92 3.213-1.36 8.186 2.928 12.494 4.198 4.217 9.394 5.794 12.47 2.932 1.681-1.565 1.433-4.337-.645-6.19-1.88-1.596-4.832-1.872-6.714-.106-.634-.533-1.174-1.163-1.754-1.753 1.626-1.706 1.621-4.676-.055-6.679C8.84 2.57 5.98 2.49 4.495 4.123zm4.851 1.852c1.059 1.265 1.2 3.28-.05 4.46-.628.565-1.243.899 1.032 3.213 2.455 2.496 2.76 1.62 3.4.95 1.005-1.008 2.971-1.102 4.323.104 1.496 1.332 1.334 2.864.617 3.531-2.219 2.065-6.468.635-9.97-2.884-3.504-3.52-5.058-7.612-2.873-10.017.508-.558 2.099-1.057 3.521.643zM18.5 2a.9.9 0 0 1 .9.9v1.7h1.7a.9.9 0 0 1 0 1.8h-1.7v1.7a.9.9 0 1 1-1.8 0V6.4h-1.7a.9.9 0 0 1 0-1.8h1.7V2.9a.9.9 0 0 1 .9-.9z" /></g></symbol>',24,24,!1,void 0)},52373:(e,t,s)=>{"use strict";s.d(t,{Icon24Send:()=>n});var n=(0,s(28178).makeIcon)("Icon24Send","send_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="send_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path fill="currentColor" d="M5.739 15.754c-.686 1.855-1.117 3.158-1.293 3.91-.553 2.362-.956 2.894 1.107 1.771 2.062-1.122 12.046-6.683 14.274-7.919 2.904-1.611 2.942-1.485-.156-3.196-2.36-1.302-12.227-6.718-14.118-7.782-1.892-1.063-1.66-.59-1.107 1.772.178.761.616 2.076 1.311 3.944a4 4 0 0 0 2.988 2.531l5.765 1.117a.1.1 0 0 1 0 .196l-5.778 1.116a4 4 0 0 0-2.993 2.54Z" /></g></symbol>',24,24,!1,void 0)},402516:(e,t,s)=>{"use strict";s.d(t,{Icon28CameraAddOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon28CameraAddOutline","camera_add_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="camera_add_outline_28"><path fill-rule="evenodd" d="M12.587 3h2.826c.469 0 .822 0 1.161.058a4 4 0 0 1 2.223 1.19c.237.25.433.543.693.934l.042.063.086.129c.129.193.156.231.18.26a1 1 0 0 0 .673.361c.038.004.085.005.317.005h.09c.574 0 .98 0 1.338.057a4.5 4.5 0 0 1 3.727 3.727c.057.357.057.764.057 1.338V15.5a1 1 0 1 1-2 0v-4.288c0-.7-.003-.932-.032-1.11a2.5 2.5 0 0 0-2.07-2.07c-.178-.029-.41-.032-1.11-.032h-.036c-.176 0-.33 0-.481-.015a3 3 0 0 1-2.018-1.08 4.888 4.888 0 0 1-.28-.392l-.02-.03-.085-.128c-.32-.482-.418-.621-.522-.731a2 2 0 0 0-1.112-.595c-.149-.026-.319-.029-.897-.029h-2.674c-.578 0-.748.003-.897.029a2 2 0 0 0-1.112.595c-.104.11-.201.25-.522.73l-.085.129-.02.03a4.814 4.814 0 0 1-.28.392 3 3 0 0 1-2.018 1.08C7.579 8 7.424 8 7.249 8h-.037c-.7 0-.932.003-1.11.032a2.5 2.5 0 0 0-2.07 2.07c-.029.178-.032.41-.032 1.11V15c0 1.417 0 2.419.065 3.203.063.771.182 1.243.371 1.613a4 4 0 0 0 1.748 1.748c.37.189.842.308 1.613.371C8.581 22 9.583 22 11 22h4.5a1 1 0 1 1 0 2h-4.544c-1.363 0-2.447 0-3.321-.072-.896-.073-1.66-.226-2.359-.582a6 6 0 0 1-2.622-2.622c-.356-.7-.51-1.463-.583-2.359C2 17.491 2 16.407 2 15.044v-3.922c0-.574 0-.98.057-1.338a4.5 4.5 0 0 1 3.727-3.727C6.141 6 6.548 6 7.122 6h.09c.232 0 .28-.001.317-.005a1 1 0 0 0 .673-.36c.024-.03.052-.068.18-.261l.086-.129.042-.063c.26-.39.456-.684.693-.934a4 4 0 0 1 2.223-1.19C11.766 3 12.118 3 12.587 3ZM14 11a3 3 0 1 0 0 6 3 3 0 0 0 0-6Zm-5 3a5 5 0 1 1 10 0 5 5 0 0 1-10 0Zm13 3a1 1 0 0 1 1 1v2h2a1 1 0 1 1 0 2h-2v2a1 1 0 1 1-2 0v-2h-2a1 1 0 1 1 0-2h2v-2a1 1 0 0 1 1-1Z" clip-rule="evenodd" /></symbol>',28,28,!1,void 0)},152335:(e,t,s)=>{"use strict";s.d(t,{Icon28SchoolOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon28SchoolOutline","school_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="school_outline_28"><path fill="currentColor" fill-rule="evenodd" d="M14.637 6.104a2 2 0 0 0-1.274 0c-.17.057-.38.177-.724.483-.353.314-.774.754-1.39 1.402l-3.525 3.7A1 1 0 0 1 7 12H4v7c0 .717 0 1.194.03 1.56.03.356.081.518.133.621a1.5 1.5 0 0 0 .656.655c.103.053.265.104.62.133C5.806 22 6.283 22 7 22h3.5v-3.5a3.5 3.5 0 1 1 7 0V22H21c.717 0 1.194 0 1.56-.03.356-.03.518-.081.621-.133a1.5 1.5 0 0 0 .655-.656c.053-.103.104-.265.133-.62C24 20.194 24 19.717 24 19v-7h-3a1 1 0 0 1-.724-.31l-3.524-3.7c-.617-.649-1.038-1.09-1.39-1.403-.345-.306-.555-.426-.725-.483zM15.5 18.5V22h-3v-3.5a1.5 1.5 0 0 1 3 0zM7 24h14.04c.666 0 1.226 0 1.683-.037.48-.04.934-.124 1.366-.345a3.5 3.5 0 0 0 1.53-1.529c.22-.432.304-.887.344-1.366.037-.457.037-1.017.037-1.683V10.96c0-.666 0-1.226-.037-1.683-.04-.48-.124-.934-.345-1.366a3.5 3.5 0 0 0-1.529-1.53c-.432-.22-.887-.305-1.366-.344C22.266 6 21.706 6 21.04 6h-3.423a17.647 17.647 0 0 0-.927-.908c-.438-.389-.883-.705-1.417-.884a4 4 0 0 0-2.546 0c-.534.18-.98.495-1.417.884-.28.25-.584.554-.927.908H6.96c-.666 0-1.226 0-1.683.037-.48.04-.934.124-1.366.344a3.5 3.5 0 0 0-1.53 1.53c-.22.432-.305.887-.344 1.366C2 9.734 2 10.294 2 10.96V19.04c0 .666 0 1.226.037 1.683.04.48.124.934.344 1.366a3.5 3.5 0 0 0 1.53 1.53c.432.22.887.304 1.366.344C5.734 24 6.294 24 6.96 24zm16.994-14a9.244 9.244 0 0 0-.025-.56c-.029-.356-.08-.518-.133-.621a1.5 1.5 0 0 0-.655-.656c-.103-.052-.265-.103-.62-.132C22.194 8 21.717 8 21 8h-1.476l1.905 2zM8.476 8H7c-.717 0-1.194 0-1.56.03-.356.03-.518.081-.621.133a1.5 1.5 0 0 0-.656.656c-.052.103-.103.265-.132.62-.013.162-.021.345-.025.561H6.57zM14 9a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z" clip-rule="evenodd" /></symbol>',28,28,!1,void 0)},999411:(e,t,s)=>{"use strict";s.d(t,{Icon56BookmarkOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon56BookmarkOutline","bookmark_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 56 56" id="bookmark_outline_56"><path fill="currentColor" fill-rule="evenodd" d="M25.433 5h5.134c2.744 0 4.894 0 6.623.141 1.76.144 3.215.442 4.53 1.112a11.5 11.5 0 0 1 5.027 5.026c.67 1.316.968 2.77 1.112 4.53.141 1.73.141 3.88.141 6.624v20.321c0 1.783 0 3.224-.101 4.336-.1 1.102-.317 2.18-.984 3.02A5 5 0 0 1 43.024 52c-1.072.005-2.054-.491-2.982-1.094-.936-.607-2.07-1.499-3.47-2.6l-6.433-5.06c-1.206-.948-1.476-1.124-1.718-1.19a1.6 1.6 0 0 0-.843 0c-.24.066-.51.242-1.717 1.19l-6.433 5.06c-1.4 1.101-2.534 1.993-3.47 2.6-.928.603-1.91 1.1-2.982 1.094a5 5 0 0 1-3.891-1.89c-.667-.84-.884-1.918-.984-3.02C8 45.978 8 44.536 8 42.754V22.433c0-2.743 0-4.894.141-6.623.144-1.76.442-3.215 1.112-4.53a11.5 11.5 0 0 1 5.026-5.027c1.316-.67 2.77-.968 4.53-1.112C20.54 5 22.69 5 25.434 5zm-6.379 3.131c-1.575.129-2.59.376-3.413.795a8.5 8.5 0 0 0-3.715 3.715c-.419.823-.666 1.838-.795 3.413-.13 1.592-.131 3.621-.131 6.446v20.177c0 1.878.002 3.182.089 4.141.09.986.252 1.309.345 1.426A2 2 0 0 0 12.99 49c.149 0 .503-.071 1.333-.61.808-.524 1.835-1.33 3.31-2.49l6.372-5.012.19-.15c.904-.712 1.684-1.328 2.592-1.576a4.601 4.601 0 0 1 2.424 0c.908.248 1.688.864 2.592 1.576l.19.15 6.371 5.011c1.476 1.161 2.503 1.967 3.31 2.491.83.539 1.185.61 1.334.61a2 2 0 0 0 1.557-.756c.093-.117.256-.44.345-1.426.088-.959.089-2.263.089-4.141V22.5c0-2.825-.001-4.854-.131-6.446-.129-1.575-.376-2.59-.795-3.413a8.5 8.5 0 0 0-3.715-3.715c-.823-.419-1.838-.666-3.413-.795C35.354 8.001 33.325 8 30.5 8h-5c-2.825 0-4.854.001-6.446.131z" clip-rule="evenodd" /></symbol>',56,56,!1,void 0)},537090:(e,t,s)=>{"use strict";s.d(t,{Icon56ErrorOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon56ErrorOutline","error_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56" id="error_outline_56"><g fill="none" fill-rule="evenodd"><path d="M0 0h56v56H0z" /><path fill="currentColor" fill-rule="nonzero" d="M28 4c13.255 0 24 10.745 24 24S41.255 52 28 52 4 41.255 4 28 14.745 4 28 4Zm0 3C16.402 7 7 16.402 7 28s9.402 21 21 21 21-9.402 21-21S39.598 7 28 7Zm0 27a2 2 0 1 1 0 4 2 2 0 0 1 0-4Zm0-17.5a1.5 1.5 0 0 1 1.5 1.5v11l-.007.144A1.5 1.5 0 0 1 26.5 29V18l.007-.144A1.5 1.5 0 0 1 28 16.5Z" /></g></symbol>',56,56,!1,void 0)},233699:(e,t,s)=>{"use strict";s.d(t,{Icon56FolderPlusBadgeOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon56FolderPlusBadgeOutline","folder_plus_badge_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 56 56" id="folder_plus_badge_outline_56"><path fill-rule="evenodd" d="M4 35.2V20.8c0-4.48 0-6.72.872-8.432a8 8 0 0 1 3.496-3.496C10.08 8 12.32 8 16.8 8h2.549c.978 0 1.468 0 1.928.11.408.099.798.26 1.156.48.404.247.75.593 1.442 1.284L27 13h12.2c4.48 0 6.72 0 8.432.872a8 8 0 0 1 3.496 3.496C52 19.08 52 21.32 52 25.8v1.7a1.5 1.5 0 0 1-3 0V25H7v12.8c0 2.52 0 3.78.49 4.743a4.5 4.5 0 0 0 1.967 1.967c.963.49 2.223.49 4.743.49h11.3a1.5 1.5 0 0 1 0 3h-8.7c-4.48 0-6.72 0-8.432-.872a8 8 0 0 1-3.496-3.496C4 41.92 4 39.68 4 35.2ZM7 22v-3.8c0-2.52 0-3.78.49-4.743a4.5 4.5 0 0 1 1.967-1.966C10.42 11 11.68 11 14.2 11h6.3l3.125 3.126c.692.691 1.038 1.037 1.442 1.285.358.219.748.38 1.156.479.46.11.95.11 1.928.11H41.8c2.52 0 3.78 0 4.743.49a4.5 4.5 0 0 1 1.967 1.967c.405.796.475 1.796.488 3.543H7Zm46 19c0 6.627-5.373 12-12 12s-12-5.373-12-12 5.373-12 12-12 12 5.373 12 12Zm-12-7a1.5 1.5 0 0 0-1.5 1.5v4h-4a1.5 1.5 0 0 0 0 3h4v4a1.5 1.5 0 0 0 3 0v-4h4a1.5 1.5 0 0 0 0-3h-4v-4A1.5 1.5 0 0 0 41 34Z" clip-rule="evenodd" /></symbol>',56,56,!1,void 0)},194805:(e,t,s)=>{"use strict";s.d(t,{Icon56MessagesOutline:()=>n});var n=(0,s(28178).makeIcon)("Icon56MessagesOutline","messages_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 56 56" id="messages_outline_56"><path fill="currentColor" fill-rule="evenodd" d="M22.029 10c-8.474 0-14.971 5.925-14.971 12.806 0 2.468.817 4.782 2.253 6.738a1.5 1.5 0 0 1 .291.888c0 1.638-.425 3.23-.953 4.674-.351.962-.772 1.919-1.17 2.803 3.314-.334 5.494-1.392 6.807-2.955a1.5 1.5 0 0 1 1.68-.437 17.062 17.062 0 0 0 6.063 1.095c8.474 0 14.97-5.925 14.97-12.806C37 15.925 30.504 10 22.03 10zM4.058 22.806C4.058 13.886 12.309 7 22.028 7 31.749 7 40 13.885 40 22.806c0 8.92-8.251 15.806-17.971 15.806-2.165 0-4.244-.337-6.172-.956-2.254 2.144-5.545 3.181-9.592 3.342-1.618.065-2.726-1.62-2.077-3.08.14-.318.282-.633.423-.946.434-.963.861-1.911 1.22-2.895.41-1.12.689-2.184.756-3.19-1.6-2.346-2.53-5.115-2.53-8.081z" clip-rule="evenodd" /><path fill="currentColor" fill-rule="evenodd" d="M43.012 18.768a1.5 1.5 0 0 0 .377 2.088c3.437 2.385 5.553 5.988 5.553 9.95 0 2.469-.817 4.782-2.253 6.738a1.5 1.5 0 0 0-.291.888c0 1.638.425 3.23.952 4.674.352.962.773 1.919 1.17 2.803-3.314-.334-5.493-1.392-6.806-2.955a1.5 1.5 0 0 0-1.68-.437 17.063 17.063 0 0 1-6.063 1.095c-2.986 0-5.755-.748-8.078-2.026a1.5 1.5 0 0 0-1.446 2.63c2.77 1.523 6.037 2.396 9.524 2.396 2.164 0 4.244-.337 6.172-.956 2.254 2.144 5.545 3.181 9.592 3.342 1.618.065 2.726-1.62 2.077-3.08-.14-.318-.282-.633-.423-.946-.434-.962-.861-1.911-1.22-2.895-.41-1.12-.69-2.184-.756-3.19 1.6-2.346 2.53-5.115 2.53-8.081 0-5.09-2.725-9.557-6.843-12.415a1.5 1.5 0 0 0-2.088.377z" clip-rule="evenodd" /></symbol>',56,56,!1,void 0)},130845:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});var n=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function r(e,t){if(e.length!==t.length)return!1;for(var s=0;s<e.length;s++)if(r=e[s],a=t[s],!(r===a||n(r)&&n(a)))return!1;var r,a;return!0}const a=function(e,t){var s;void 0===t&&(t=r);var n,a=[],o=!1;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return o&&s===this&&t(r,a)||(n=e.apply(this,r),o=!0,s=this,a=r),n}}},968641:()=>{},81290:()=>{},760398:()=>{},380283:()=>{},320428:()=>{},810874:()=>{},419308:()=>{},677749:()=>{},200930:()=>{},988426:()=>{},774996:()=>{},215334:()=>{},709639:()=>{},167509:()=>{},554410:()=>{},518617:()=>{},420526:()=>{},589648:()=>{},809206:()=>{},891695:()=>{},150637:()=>{},784256:()=>{},928910:()=>{},522283:()=>{},950652:()=>{},705875:()=>{},360862:()=>{},58245:()=>{},181362:()=>{},279478:()=>{},42505:()=>{},932823:()=>{},737968:()=>{},501954:()=>{},994718:()=>{},324402:()=>{},883061:()=>{},669721:()=>{},466135:()=>{},929894:()=>{},321248:()=>{},661342:()=>{},168577:()=>{},980160:()=>{},516073:()=>{},126449:()=>{},974004:(e,t,s)=>{"use strict";s.d(t,{default:()=>h});var n=s(263366),r=s(487462),a=s(497326),o=s(894578),i=s(667294),c=s(500220),l=s(597803),d=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},u=function(e){function t(t,s){var n,r=(n=e.call(this,t,s)||this).handleExited.bind((0,a.default)(n));return n.state={contextValue:{isMounting:!0},handleExited:r,firstRender:!0},n}(0,o.default)(t,e);var s=t.prototype;return s.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},s.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var s=t.children,n=t.handleExited;return{children:t.firstRender?(0,l.getInitialChildMapping)(e,n):(0,l.getNextChildMapping)(e,s,n),firstRender:!1}},s.handleExited=function(e,t){var s=(0,l.getChildMapping)(this.props.children);e.key in s||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var s=(0,r.default)({},t.children);return delete s[e.key],{children:s}})))},s.render=function(){var e=this.props,t=e.component,s=e.childFactory,r=(0,n.default)(e,["component","childFactory"]),a=this.state.contextValue,o=d(this.state.children).map(s);return delete r.appear,delete r.enter,delete r.exit,null===t?i.createElement(c.default.Provider,{value:a},o):i.createElement(c.default.Provider,{value:a},i.createElement(t,r,o))},t}(i.Component);u.propTypes={},u.defaultProps={component:"div",childFactory:function(e){return e}};const h=u},597803:(e,t,s)=>{"use strict";s.d(t,{getChildMapping:()=>r,getInitialChildMapping:()=>o,getNextChildMapping:()=>i});var n=s(667294);function r(e,t){var s=Object.create(null);return e&&n.Children.map(e,(function(e){return e})).forEach((function(e){s[e.key]=function(e){return t&&(0,n.isValidElement)(e)?t(e):e}(e)})),s}function a(e,t,s){return null!=s[t]?s[t]:e.props[t]}function o(e,t){return r(e.children,(function(s){return(0,n.cloneElement)(s,{onExited:t.bind(null,s),in:!0,appear:a(s,"appear",e),enter:a(s,"enter",e),exit:a(s,"exit",e)})}))}function i(e,t,s){var o=r(e.children),i=function(e,t){function s(s){return s in t?t[s]:e[s]}e=e||{},t=t||{};var n,r=Object.create(null),a=[];for(var o in e)o in t?a.length&&(r[o]=a,a=[]):a.push(o);var i={};for(var c in t){if(r[c])for(n=0;n<r[c].length;n++){var l=r[c][n];i[r[c][n]]=s(l)}i[c]=s(c)}for(n=0;n<a.length;n++)i[a[n]]=s(a[n]);return i}(t,o);return Object.keys(i).forEach((function(r){var c=i[r];if((0,n.isValidElement)(c)){var l=r in t,d=r in o,u=t[r],h=(0,n.isValidElement)(u)&&!u.props.in;!d||l&&!h?d||!l||h?d&&l&&(0,n.isValidElement)(u)&&(i[r]=(0,n.cloneElement)(c,{onExited:s.bind(null,c),in:u.props.in,exit:a(c,"exit",e),enter:a(c,"enter",e)})):i[r]=(0,n.cloneElement)(c,{in:!1}):i[r]=(0,n.cloneElement)(c,{onExited:s.bind(null,c),in:!0,exit:a(c,"exit",e),enter:a(c,"enter",e)})}})),i}},619688:(e,t,s)=>{"use strict";s.d(t,{default:()=>f});var n,r=s(667294),a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==s.g?s.g:{};let o;o="undefined"!=typeof window?window:"undefined"!=typeof self?self:a;let i=null,c=null;const l=o.clearTimeout,d=o.setTimeout,u=o.cancelAnimationFrame||o.mozCancelAnimationFrame||o.webkitCancelAnimationFrame,h=o.requestAnimationFrame||o.mozRequestAnimationFrame||o.webkitRequestAnimationFrame;function m(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}null==u||null==h?(i=l,c=function(e){return d(e,20)}):(i=function([e,t]){u(e),l(t)},c=function(e){const t=h((function(){l(s),e()})),s=d((function(){u(t),e()}),20);return[t,s]}),n={createDetectElementResize:function(e){let t,s,n,r,a,l,d;const u="undefined"!=typeof document&&document.attachEvent;if(!u){l=function(e){const t=e.__resizeTriggers__,s=t.firstElementChild,n=t.lastElementChild,r=s.firstElementChild;n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,r.style.width=s.offsetWidth+1+"px",r.style.height=s.offsetHeight+1+"px",s.scrollLeft=s.scrollWidth,s.scrollTop=s.scrollHeight},a=function(e){return e.offsetWidth!==e.__resizeLast__.width||e.offsetHeight!==e.__resizeLast__.height},d=function(e){if(e.target.className&&"function"==typeof e.target.className.indexOf&&e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)return;const t=this;l(this),this.__resizeRAF__&&i(this.__resizeRAF__),this.__resizeRAF__=c((function(){a(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(s){s.call(t,e)})))}))};let e=!1,o="";n="animationstart";const u="Webkit Moz O ms".split(" ");let h="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),m="";{const t=document.createElement("fakeelement");if(void 0!==t.style.animationName&&(e=!0),!1===e)for(let s=0;s<u.length;s++)if(void 0!==t.style[u[s]+"AnimationName"]){m=u[s],o="-"+m.toLowerCase()+"-",n=h[s],e=!0;break}}s="resizeanim",t="@"+o+"keyframes "+s+" { from { opacity: 0; } to { opacity: 0; } } ",r=o+"animation: 1ms "+s+"; "}return{addResizeListener:function(a,i){if(u)a.attachEvent("onresize",i);else{if(!a.__resizeTriggers__){const i=a.ownerDocument,c=o.getComputedStyle(a);c&&"static"===c.position&&(a.style.position="relative"),function(s){if(!s.getElementById("detectElementResize")){const n=(t||"")+".resize-triggers { "+(r||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',a=s.head||s.getElementsByTagName("head")[0],o=s.createElement("style");o.id="detectElementResize",o.type="text/css",null!=e&&o.setAttribute("nonce",e),o.styleSheet?o.styleSheet.cssText=n:o.appendChild(s.createTextNode(n)),a.appendChild(o)}}(i),a.__resizeLast__={},a.__resizeListeners__=[],(a.__resizeTriggers__=i.createElement("div")).className="resize-triggers";const u=i.createElement("div");u.className="expand-trigger",u.appendChild(i.createElement("div"));const h=i.createElement("div");h.className="contract-trigger",a.__resizeTriggers__.appendChild(u),a.__resizeTriggers__.appendChild(h),a.appendChild(a.__resizeTriggers__),l(a),a.addEventListener("scroll",d,!0),n&&(a.__resizeTriggers__.__animationListener__=function(e){e.animationName===s&&l(a)},a.__resizeTriggers__.addEventListener(n,a.__resizeTriggers__.__animationListener__))}a.__resizeListeners__.push(i)}},removeResizeListener:function(e,t){if(u)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",d,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(n,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(e){}}}}}};class p extends r.Component{constructor(...e){super(...e),m(this,"state",{height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0}),m(this,"_autoSizer",null),m(this,"_detectElementResize",null),m(this,"_parentNode",null),m(this,"_resizeObserver",null),m(this,"_onResize",(()=>{const{disableHeight:e,disableWidth:t,onResize:s}=this.props;if(this._parentNode){var n,r,a,o;const i=window.getComputedStyle(this._parentNode)||{},c=parseInt(null!==(n=i.paddingLeft)&&void 0!==n?n:"0",10),l=parseInt(null!==(r=i.paddingRight)&&void 0!==r?r:"0",10),d=parseInt(null!==(a=i.paddingTop)&&void 0!==a?a:"0",10),u=parseInt(null!==(o=i.paddingBottom)&&void 0!==o?o:"0",10),h=this._parentNode.getBoundingClientRect(),m=h.height-d-u,p=h.width-c-l,f=this._parentNode.offsetHeight-d-u,g=this._parentNode.offsetWidth-c-l;(e||this.state.height===f&&this.state.scaledHeight===m)&&(t||this.state.width===g&&this.state.scaledWidth===p)||(this.setState({height:f,width:g,scaledHeight:m,scaledWidth:p}),"function"==typeof s&&s({height:f,scaledHeight:m,scaledWidth:p,width:g}))}})),m(this,"_setRef",(e=>{this._autoSizer=e}))}componentDidMount(){const{nonce:e}=this.props;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,null!=this._parentNode&&("undefined"!=typeof ResizeObserver?(this._resizeObserver=new ResizeObserver((()=>{setTimeout(this._onResize,0)})),this._resizeObserver.observe(this._parentNode)):(this._detectElementResize=(0,n.createDetectElementResize)(e),this._detectElementResize.addResizeListener(this._parentNode,this._onResize)),this._onResize()))}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._resizeObserver&&(this._resizeObserver.observe(this._parentNode),this._resizeObserver.disconnect()))}render(){const{children:e,defaultHeight:t,defaultWidth:s,disableHeight:n,disableWidth:a,nonce:o,onResize:i,style:c,tagName:l="div",...d}=this.props,{height:u,scaledHeight:h,scaledWidth:m,width:p}=this.state,f={overflow:"visible"},g={};let v=!1;return n||(0===u&&(v=!0),f.height=0,g.height=u,g.scaledHeight=h),a||(0===p&&(v=!0),f.width=0,g.width=p,g.scaledWidth=m),(0,r.createElement)(l,{ref:this._setRef,style:{...f,...c},...d},!v&&e(g))}}m(p,"defaultProps",{onResize:()=>{},disableHeight:!1,disableWidth:!1,style:{}});var f=p},365691:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var n=s(667294);var r=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t};const o=function(e){function t(){var e,s,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return s=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n._lastRenderedStartIndex=-1,n._lastRenderedStopIndex=-1,n._memoizedUnloadedRanges=[],n._onItemsRendered=function(e){var t=e.visibleStartIndex,s=e.visibleStopIndex;n._lastRenderedStartIndex=t,n._lastRenderedStopIndex=s,n._ensureRowsLoaded(t,s)},n._setRef=function(e){n._listRef=e},a(n,s)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"resetloadMoreItemsCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._memoizedUnloadedRanges=[],e&&this._ensureRowsLoaded(this._lastRenderedStartIndex,this._lastRenderedStopIndex)}},{key:"componentDidMount",value:function(){0}},{key:"render",value:function(){return(0,this.props.children)({onItemsRendered:this._onItemsRendered,ref:this._setRef})}},{key:"_ensureRowsLoaded",value:function(e,t){var s=this.props,n=s.isItemLoaded,r=s.itemCount,a=s.minimumBatchSize,o=void 0===a?10:a,i=s.threshold,c=void 0===i?15:i,l=function(e){for(var t=e.isItemLoaded,s=e.itemCount,n=e.minimumBatchSize,r=e.startIndex,a=e.stopIndex,o=[],i=null,c=null,l=r;l<=a;l++)t(l)?null!==c&&(o.push(i,c),i=c=null):(c=l,null===i&&(i=l));if(null!==c){for(var d=Math.min(Math.max(c,i+n-1),s-1),u=c+1;u<=d&&!t(u);u++)c=u;o.push(i,c)}if(o.length)for(;o[1]-o[0]+1<n&&o[0]>0;){var h=o[0]-1;if(t(h))break;o[0]=h}return o}({isItemLoaded:n,itemCount:r,minimumBatchSize:o,startIndex:Math.max(0,e-c),stopIndex:Math.min(r-1,t+c)});(this._memoizedUnloadedRanges.length!==l.length||this._memoizedUnloadedRanges.some((function(e,t){return l[t]!==e})))&&(this._memoizedUnloadedRanges=l,this._loadUnloadedRanges(l))}},{key:"_loadUnloadedRanges",value:function(e){for(var t=this,s=this.props.loadMoreItems||this.props.loadMoreRows,n=function(n){var r=e[n],a=e[n+1],o=s(r,a);null!=o&&o.then((function(){if(function(e){var t=e.lastRenderedStartIndex,s=e.lastRenderedStopIndex,n=e.startIndex,r=e.stopIndex;return!(n>s||r<t)}({lastRenderedStartIndex:t._lastRenderedStartIndex,lastRenderedStopIndex:t._lastRenderedStopIndex,startIndex:r,stopIndex:a})){if(null==t._listRef)return;"function"==typeof t._listRef.resetAfterIndex?t._listRef.resetAfterIndex(r,!0):("function"==typeof t._listRef._getItemStyleCache&&t._listRef._getItemStyleCache(-1),t._listRef.forceUpdate())}}))},r=0;r<e.length;r+=2)n(r)}}]),t}(n.PureComponent)},274061:(e,t,s)=>{"use strict";s.d(t,{FixedSizeList:()=>E,VariableSizeList:()=>I});var n=s(487462),r=s(497326),a=s(894578),o=s(130845),i=s(667294),c=(s(263366),"object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()});function l(e){cancelAnimationFrame(e.id)}function d(e,t){var s=c();var n={id:requestAnimationFrame((function r(){c()-s>=t?e.call(null):n.id=requestAnimationFrame(r)}))};return n}var u=-1;function h(e){if(void 0===e&&(e=!1),-1===u||e){var t=document.createElement("div"),s=t.style;s.width="50px",s.height="50px",s.overflow="scroll",document.body.appendChild(t),u=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return u}var m=null;function p(e){if(void 0===e&&(e=!1),null===m||e){var t=document.createElement("div"),s=t.style;s.width="50px",s.height="50px",s.overflow="scroll",s.direction="rtl";var n=document.createElement("div"),r=n.style;return r.width="100px",r.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?m="positive-descending":(t.scrollLeft=1,m=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),m}return m}var f=function(e,t){return e};function g(e){var t,s=e.getItemOffset,c=e.getEstimatedTotalSize,u=e.getItemSize,m=e.getOffsetForIndexAndAlignment,g=e.getStartIndexForOffset,_=e.getStopIndexForStartIndex,C=e.initInstanceProps,y=e.shouldResetStyleCacheOnItemSizeChange,k=e.validateProps;return t=function(e){function t(t){var n;return(n=e.call(this,t)||this)._instanceProps=C(n.props,(0,r.default)(n)),n._outerRef=void 0,n._resetIsScrollingTimeoutId=null,n.state={instance:(0,r.default)(n),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof n.props.initialScrollOffset?n.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},n._callOnItemsRendered=void 0,n._callOnItemsRendered=(0,o.default)((function(e,t,s,r){return n.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:s,visibleStopIndex:r})})),n._callOnScroll=void 0,n._callOnScroll=(0,o.default)((function(e,t,s){return n.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:s})})),n._getItemStyle=void 0,n._getItemStyle=function(e){var t,r=n.props,a=r.direction,o=r.itemSize,i=r.layout,c=n._getItemStyleCache(y&&o,y&&i,y&&a);if(c.hasOwnProperty(e))t=c[e];else{var l=s(n.props,e,n._instanceProps),d=u(n.props,e,n._instanceProps),h="horizontal"===a||"horizontal"===i,m="rtl"===a,p=h?l:0;c[e]=t={position:"absolute",left:m?void 0:p,right:m?p:void 0,top:h?0:l,height:h?"100%":d,width:h?d:"100%"}}return t},n._getItemStyleCache=void 0,n._getItemStyleCache=(0,o.default)((function(e,t,s){return{}})),n._onScrollHorizontal=function(e){var t=e.currentTarget,s=t.clientWidth,r=t.scrollLeft,a=t.scrollWidth;n.setState((function(e){if(e.scrollOffset===r)return null;var t=n.props.direction,o=r;if("rtl"===t)switch(p()){case"negative":o=-r;break;case"positive-descending":o=a-s-r}return o=Math.max(0,Math.min(o,a-s)),{isScrolling:!0,scrollDirection:e.scrollOffset<r?"forward":"backward",scrollOffset:o,scrollUpdateWasRequested:!1}}),n._resetIsScrollingDebounced)},n._onScrollVertical=function(e){var t=e.currentTarget,s=t.clientHeight,r=t.scrollHeight,a=t.scrollTop;n.setState((function(e){if(e.scrollOffset===a)return null;var t=Math.max(0,Math.min(a,r-s));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),n._resetIsScrollingDebounced)},n._outerRefSetter=function(e){var t=n.props.outerRef;n._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},n._resetIsScrollingDebounced=function(){null!==n._resetIsScrollingTimeoutId&&l(n._resetIsScrollingTimeoutId),n._resetIsScrollingTimeoutId=d(n._resetIsScrolling,150)},n._resetIsScrolling=function(){n._resetIsScrollingTimeoutId=null,n.setState({isScrolling:!1},(function(){n._getItemStyleCache(-1,null)}))},n}(0,a.default)(t,e),t.getDerivedStateFromProps=function(e,t){return v(e,t),k(e),null};var I=t.prototype;return I.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},I.scrollToItem=function(e,t){void 0===t&&(t="auto");var s=this.props,n=s.itemCount,r=s.layout,a=this.state.scrollOffset;e=Math.max(0,Math.min(e,n-1));var o=0;if(this._outerRef){var i=this._outerRef;o="vertical"===r?i.scrollWidth>i.clientWidth?h():0:i.scrollHeight>i.clientHeight?h():0}this.scrollTo(m(this.props,e,t,a,this._instanceProps,o))},I.componentDidMount=function(){var e=this.props,t=e.direction,s=e.initialScrollOffset,n=e.layout;if("number"==typeof s&&null!=this._outerRef){var r=this._outerRef;"horizontal"===t||"horizontal"===n?r.scrollLeft=s:r.scrollTop=s}this._callPropsCallbacks()},I.componentDidUpdate=function(){var e=this.props,t=e.direction,s=e.layout,n=this.state,r=n.scrollOffset;if(n.scrollUpdateWasRequested&&null!=this._outerRef){var a=this._outerRef;if("horizontal"===t||"horizontal"===s)if("rtl"===t)switch(p()){case"negative":a.scrollLeft=-r;break;case"positive-ascending":a.scrollLeft=r;break;default:var o=a.clientWidth,i=a.scrollWidth;a.scrollLeft=i-o-r}else a.scrollLeft=r;else a.scrollTop=r}this._callPropsCallbacks()},I.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&l(this._resetIsScrollingTimeoutId)},I.render=function(){var e=this.props,t=e.children,s=e.className,r=e.direction,a=e.height,o=e.innerRef,l=e.innerElementType,d=e.innerTagName,u=e.itemCount,h=e.itemData,m=e.itemKey,p=void 0===m?f:m,g=e.layout,v=e.outerElementType,_=e.outerTagName,C=e.style,y=e.useIsScrolling,k=e.width,I=this.state.isScrolling,E="horizontal"===r||"horizontal"===g,b=E?this._onScrollHorizontal:this._onScrollVertical,w=this._getRangeToRender(),M=w[0],S=w[1],R=[];if(u>0)for(var A=M;A<=S;A++)R.push((0,i.createElement)(t,{data:h,key:p(A,h),index:A,isScrolling:y?I:void 0,style:this._getItemStyle(A)}));var P=c(this.props,this._instanceProps);return(0,i.createElement)(v||_||"div",{className:s,onScroll:b,ref:this._outerRefSetter,style:(0,n.default)({position:"relative",height:a,width:k,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:r},C)},(0,i.createElement)(l||d||"div",{children:R,ref:o,style:{height:E?"100%":P,pointerEvents:I?"none":void 0,width:E?P:"100%"}}))},I._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],s=e[1],n=e[2],r=e[3];this._callOnItemsRendered(t,s,n,r)}if("function"==typeof this.props.onScroll){var a=this.state,o=a.scrollDirection,i=a.scrollOffset,c=a.scrollUpdateWasRequested;this._callOnScroll(o,i,c)}},I._getRangeToRender=function(){var e=this.props,t=e.itemCount,s=e.overscanCount,n=this.state,r=n.isScrolling,a=n.scrollDirection,o=n.scrollOffset;if(0===t)return[0,0,0,0];var i=g(this.props,o,this._instanceProps),c=_(this.props,i,o,this._instanceProps),l=r&&"backward"!==a?1:Math.max(1,s),d=r&&"forward"!==a?1:Math.max(1,s);return[Math.max(0,i-l),Math.max(0,Math.min(t-1,c+d)),i,c]},t}(i.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var v=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},_=function(e,t,s){var n=e.itemSize,r=s.itemMetadataMap,a=s.lastMeasuredIndex;if(t>a){var o=0;if(a>=0){var i=r[a];o=i.offset+i.size}for(var c=a+1;c<=t;c++){var l=n(c);r[c]={offset:o,size:l},o+=l}s.lastMeasuredIndex=t}return r[t]},C=function(e,t,s,n,r){for(;n<=s;){var a=n+Math.floor((s-n)/2),o=_(e,a,t).offset;if(o===r)return a;o<r?n=a+1:o>r&&(s=a-1)}return n>0?n-1:0},y=function(e,t,s,n){for(var r=e.itemCount,a=1;s<r&&_(e,s,t).offset<n;)s+=a,a*=2;return C(e,t,Math.min(s,r-1),Math.floor(s/2),n)},k=function(e,t){var s=e.itemCount,n=t.itemMetadataMap,r=t.estimatedItemSize,a=t.lastMeasuredIndex,o=0;if(a>=s&&(a=s-1),a>=0){var i=n[a];o=i.offset+i.size}return o+(s-a-1)*r},I=g({getItemOffset:function(e,t,s){return _(e,t,s).offset},getItemSize:function(e,t,s){return s.itemMetadataMap[t].size},getEstimatedTotalSize:k,getOffsetForIndexAndAlignment:function(e,t,s,n,r,a){var o=e.direction,i=e.height,c=e.layout,l=e.width,d="horizontal"===o||"horizontal"===c?l:i,u=_(e,t,r),h=k(e,r),m=Math.max(0,Math.min(h-d,u.offset)),p=Math.max(0,u.offset-d+u.size+a);switch("smart"===s&&(s=n>=p-d&&n<=m+d?"auto":"center"),s){case"start":return m;case"end":return p;case"center":return Math.round(p+(m-p)/2);default:return n>=p&&n<=m?n:n<p?p:m}},getStartIndexForOffset:function(e,t,s){return function(e,t,s){var n=t.itemMetadataMap,r=t.lastMeasuredIndex;return(r>0?n[r].offset:0)>=s?C(e,t,r,0,s):y(e,t,Math.max(0,r),s)}(e,s,t)},getStopIndexForStartIndex:function(e,t,s,n){for(var r=e.direction,a=e.height,o=e.itemCount,i=e.layout,c=e.width,l="horizontal"===r||"horizontal"===i?c:a,d=_(e,t,n),u=s+l,h=d.offset+d.size,m=t;m<o-1&&h<u;)m++,h+=_(e,m,n).size;return m},initInstanceProps:function(e,t){var s={itemMetadataMap:{},estimatedItemSize:e.estimatedItemSize||50,lastMeasuredIndex:-1};return t.resetAfterIndex=function(e,n){void 0===n&&(n=!0),s.lastMeasuredIndex=Math.min(s.lastMeasuredIndex,e-1),t._getItemStyleCache(-1),n&&t.forceUpdate()},s},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.itemSize}}),E=g({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,s,n,r,a){var o=e.direction,i=e.height,c=e.itemCount,l=e.itemSize,d=e.layout,u=e.width,h="horizontal"===o||"horizontal"===d?u:i,m=Math.max(0,c*l-h),p=Math.min(m,t*l),f=Math.max(0,t*l-h+l+a);switch("smart"===s&&(s=n>=f-h&&n<=p+h?"auto":"center"),s){case"start":return p;case"end":return f;case"center":var g=Math.round(f+(p-f)/2);return g<Math.ceil(h/2)?0:g>m+Math.floor(h/2)?m:g;default:return n>=f&&n<=p?n:n<f?f:p}},getStartIndexForOffset:function(e,t){var s=e.itemCount,n=e.itemSize;return Math.max(0,Math.min(s-1,Math.floor(t/n)))},getStopIndexForStartIndex:function(e,t,s){var n=e.direction,r=e.height,a=e.itemCount,o=e.itemSize,i=e.layout,c=e.width,l=t*o,d="horizontal"===n||"horizontal"===i?c:r,u=Math.ceil((d+s-l)/o);return Math.max(0,Math.min(a-1,t+u-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}})},163293:function(e){e.exports=function(){"use strict";var e=function(){return e=Object.assign||function(e){for(var t,s=1,n=arguments.length;s<n;s++)for(var r in t=arguments[s])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},e.apply(this,arguments)};function t(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(s[n[r]]=e[n[r]])}return s}var s=function(){function e(e,t){this.ATT_FACTOR=4,this.GRAPH_X=2,this.AMPLITUDE_FACTOR=.6,this.ctrl=e,this.definition=t}return e.prototype.globalAttFn=function(e){return Math.pow(this.ATT_FACTOR/(this.ATT_FACTOR+Math.pow(e,this.ATT_FACTOR)),this.ATT_FACTOR)},e.prototype.xPos=function(e){return this.ctrl.width*((e+this.GRAPH_X)/(2*this.GRAPH_X))},e.prototype.yPos=function(e){return this.AMPLITUDE_FACTOR*(this.globalAttFn(e)*(this.ctrl.heightMax*this.ctrl.amplitude)*(1/this.definition.attenuation)*Math.sin(this.ctrl.opt.frequency*e-this.ctrl.phase))},e.prototype.draw=function(){var e=this.ctrl.ctx;e.moveTo(0,0),e.beginPath();var t=(this.definition.color||this.ctrl.color).replace(/rgb\(/g,"").replace(/\)/g,"");e.strokeStyle="rgba(".concat(t,",").concat(this.definition.opacity,")"),e.lineWidth=this.definition.lineWidth;for(var s=-this.GRAPH_X;s<=this.GRAPH_X;s+=this.ctrl.opt.pixelDepth)e.lineTo(this.xPos(s),this.ctrl.heightMax+this.yPos(s));e.stroke()},e.getDefinition=function(){return[{attenuation:-2,lineWidth:1,opacity:.1},{attenuation:-6,lineWidth:1,opacity:.2},{attenuation:4,lineWidth:1,opacity:.4},{attenuation:2,lineWidth:1,opacity:.6},{attenuation:1,lineWidth:1.5,opacity:1}]},e}(),n=function(){function e(e,t){this.GRAPH_X=25,this.AMPLITUDE_FACTOR=.8,this.SPEED_FACTOR=1,this.DEAD_PX=2,this.ATT_FACTOR=4,this.DESPAWN_FACTOR=.02,this.NOOFCURVES_RANGES=[2,5],this.AMPLITUDE_RANGES=[.3,1],this.OFFSET_RANGES=[-3,3],this.WIDTH_RANGES=[1,3],this.SPEED_RANGES=[.5,1],this.DESPAWN_TIMEOUT_RANGES=[500,2e3],this.ctrl=e,this.definition=t,this.noOfCurves=0,this.spawnAt=0,this.prevMaxY=0,this.phases=[],this.offsets=[],this.speeds=[],this.finalAmplitudes=[],this.widths=[],this.amplitudes=[],this.despawnTimeouts=[],this.verses=[]}return e.prototype.getRandomRange=function(e){return e[0]+Math.random()*(e[1]-e[0])},e.prototype.spawnSingle=function(e){this.phases[e]=0,this.amplitudes[e]=0,this.despawnTimeouts[e]=this.getRandomRange(this.DESPAWN_TIMEOUT_RANGES),this.offsets[e]=this.getRandomRange(this.OFFSET_RANGES),this.speeds[e]=this.getRandomRange(this.SPEED_RANGES),this.finalAmplitudes[e]=this.getRandomRange(this.AMPLITUDE_RANGES),this.widths[e]=this.getRandomRange(this.WIDTH_RANGES),this.verses[e]=this.getRandomRange([-1,1])},e.prototype.getEmptyArray=function(e){return new Array(e)},e.prototype.spawn=function(){this.spawnAt=Date.now(),this.noOfCurves=Math.floor(this.getRandomRange(this.NOOFCURVES_RANGES)),this.phases=this.getEmptyArray(this.noOfCurves),this.offsets=this.getEmptyArray(this.noOfCurves),this.speeds=this.getEmptyArray(this.noOfCurves),this.finalAmplitudes=this.getEmptyArray(this.noOfCurves),this.widths=this.getEmptyArray(this.noOfCurves),this.amplitudes=this.getEmptyArray(this.noOfCurves),this.despawnTimeouts=this.getEmptyArray(this.noOfCurves),this.verses=this.getEmptyArray(this.noOfCurves);for(var e=0;e<this.noOfCurves;e++)this.spawnSingle(e)},e.prototype.globalAttFn=function(e){return Math.pow(this.ATT_FACTOR/(this.ATT_FACTOR+Math.pow(e,2)),this.ATT_FACTOR)},e.prototype.sin=function(e,t){return Math.sin(e-t)},e.prototype.yRelativePos=function(e){for(var t=0,s=0;s<this.noOfCurves;s++){var n=4*(s/(this.noOfCurves-1)*2-1);n+=this.offsets[s];var r=e*(1/this.widths[s])-n;t+=Math.abs(this.amplitudes[s]*this.sin(this.verses[s]*r,this.phases[s])*this.globalAttFn(r))}return t/this.noOfCurves},e.prototype.yPos=function(e){return this.AMPLITUDE_FACTOR*this.ctrl.heightMax*this.ctrl.amplitude*this.yRelativePos(e)*this.globalAttFn(e/this.GRAPH_X*2)},e.prototype.xPos=function(e){return this.ctrl.width*((e+this.GRAPH_X)/(2*this.GRAPH_X))},e.prototype.drawSupportLine=function(){var e=this.ctrl.ctx,t=[0,this.ctrl.heightMax,this.ctrl.width,1],s=e.createLinearGradient.apply(e,t);s.addColorStop(0,"transparent"),s.addColorStop(.1,"rgba(255,255,255,.5)"),s.addColorStop(.8,"rgba(255,255,255,.5)"),s.addColorStop(1,"transparent"),e.fillStyle=s,e.fillRect.apply(e,t)},e.prototype.draw=function(){var e=this.ctrl.ctx;if(e.globalAlpha=.7,e.globalCompositeOperation="lighter",0===this.spawnAt&&this.spawn(),this.definition.supportLine)return this.drawSupportLine();for(var t=0;t<this.noOfCurves;t++)this.spawnAt+this.despawnTimeouts[t]<=Date.now()?this.amplitudes[t]-=this.DESPAWN_FACTOR:this.amplitudes[t]+=this.DESPAWN_FACTOR,this.amplitudes[t]=Math.min(Math.max(this.amplitudes[t],0),this.finalAmplitudes[t]),this.phases[t]=(this.phases[t]+this.ctrl.speed*this.speeds[t]*this.SPEED_FACTOR)%(2*Math.PI);for(var s=-1/0,n=0,r=[1,-1];n<r.length;n++){var a=r[n];e.beginPath();for(var o=-this.GRAPH_X;o<=this.GRAPH_X;o+=this.ctrl.opt.pixelDepth){var i=this.xPos(o),c=this.yPos(o);e.lineTo(i,this.ctrl.heightMax-a*c),s=Math.max(s,c)}e.closePath(),e.fillStyle="rgba(".concat(this.definition.color,", 1)"),e.strokeStyle="rgba(".concat(this.definition.color,", 1)"),e.fill()}return s<this.DEAD_PX&&this.prevMaxY>s&&(this.spawnAt=0),this.prevMaxY=s,null},e.getDefinition=function(){return[{color:"255,255,255",supportLine:!0},{color:"15, 82, 169"},{color:"173, 57, 76"},{color:"48, 220, 155"}]},e}();return function(){function r(r){var a=this,o=r.container,i=t(r,["container"]);this.phase=0,this.run=!1,this.curves=[];var c=window.getComputedStyle(o);this.opt=e({container:o,style:"ios",ratio:window.devicePixelRatio||1,speed:.2,amplitude:1,frequency:6,color:"#fff",cover:!1,width:parseInt(c.width.replace("px",""),10),height:parseInt(c.height.replace("px",""),10),autostart:!0,pixelDepth:.02,lerpSpeed:.1},i),this.speed=Number(this.opt.speed),this.amplitude=Number(this.opt.amplitude),this.width=Number(this.opt.ratio*this.opt.width),this.height=Number(this.opt.ratio*this.opt.height),this.heightMax=Number(this.height/2)-6,this.color="rgb(".concat(this.hex2rgb(this.opt.color),")"),this.interpolation={speed:this.speed,amplitude:this.amplitude},this.canvas=document.createElement("canvas");var l=this.canvas.getContext("2d");if(null===l)throw new Error("Unable to create 2D Context");this.ctx=l,this.canvas.width=this.width,this.canvas.height=this.height,!0===this.opt.cover?this.canvas.style.width=this.canvas.style.height="100%":(this.canvas.style.width="".concat(this.width/this.opt.ratio,"px"),this.canvas.style.height="".concat(this.height/this.opt.ratio,"px")),"ios9"===this.opt.style?this.curves=(this.opt.curveDefinition||n.getDefinition()).map((function(e){return new n(a,e)})):this.curves=(this.opt.curveDefinition||s.getDefinition()).map((function(e){return new s(a,e)})),this.opt.container.appendChild(this.canvas),this.opt.autostart&&this.start()}return r.prototype.hex2rgb=function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(function(e,t,s,n){return t+t+s+s+n+n}));var s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return s?"".concat(parseInt(s[1],16).toString(),",").concat(parseInt(s[2],16).toString(),",").concat(parseInt(s[3],16).toString()):null},r.prototype.intLerp=function(e,t,s){return e*(1-s)+t*s},r.prototype.lerp=function(e){var t=this.interpolation[e];return null!==t&&(this[e]=this.intLerp(this[e],t,this.opt.lerpSpeed),this[e]-t==0&&(this.interpolation[e]=null)),this[e]},r.prototype.clear=function(){this.ctx.globalCompositeOperation="destination-out",this.ctx.fillRect(0,0,this.width,this.height),this.ctx.globalCompositeOperation="source-over"},r.prototype.draw=function(){this.curves.forEach((function(e){return e.draw()}))},r.prototype.startDrawCycle=function(){this.clear(),this.lerp("amplitude"),this.lerp("speed"),this.draw(),this.phase=(this.phase+Math.PI/2*this.speed)%(2*Math.PI),window.requestAnimationFrame?this.animationFrameId=window.requestAnimationFrame(this.startDrawCycle.bind(this)):this.timeoutId=setTimeout(this.startDrawCycle.bind(this),20)},r.prototype.start=function(){if(!this.canvas)throw new Error("This instance of SiriWave has been disposed, please create a new instance");this.phase=0,this.run||(this.run=!0,this.startDrawCycle())},r.prototype.stop=function(){this.phase=0,this.run=!1,this.animationFrameId&&window.cancelAnimationFrame(this.animationFrameId),this.timeoutId&&clearTimeout(this.timeoutId)},r.prototype.dispose=function(){this.stop(),this.canvas&&(this.canvas.remove(),this.canvas=null)},r.prototype.set=function(e,t){this.interpolation[e]=t},r.prototype.setSpeed=function(e){this.set("speed",e)},r.prototype.setAmplitude=function(e){this.set("amplitude",e)},r}()}()},906978:(e,t,s)=>{"use strict";s.d(t,{API_ERROR_ACCESS:()=>l,API_ERROR_AUTH:()=>r,API_ERROR_AUTH_VALIDATION:()=>d,API_ERROR_CAPTCHA:()=>c,API_ERROR_FLOOD:()=>o,API_ERROR_LIMITS:()=>g,API_ERROR_MESSAGES_CHAT_DISABLED:()=>I,API_ERROR_MESSAGES_CHAT_MEMBER_NOT_STAFF:()=>w,API_ERROR_MESSAGES_CHAT_NOT_ADMIN:()=>_,API_ERROR_MESSAGES_CHAT_UNSUPPORTED:()=>E,API_ERROR_MESSAGES_CHAT_USER_NO_ACCESS:()=>v,API_ERROR_MESSAGES_CONTACT_NOT_FOUND:()=>y,API_ERROR_MESSAGES_GROUP_PEER_ACCESS:()=>C,API_ERROR_MESSAGES_MEMBER_ACCESS_TO_GROUP_DENIED:()=>b,API_ERROR_MESSAGES_MESSAGE_REQUEST_ALREADY_SENT:()=>k,API_ERROR_METHOD_DISABLED:()=>u,API_ERROR_PARAM:()=>f,API_ERROR_RATE_LIMIT:()=>h,API_ERROR_SECTION_DISABLED:()=>p,API_ERROR_SERVER:()=>i,API_ERROR_TOO_MANY:()=>a,API_ERROR_UNKNOWN:()=>n,API_ERROR_UNKNOWN_USER:()=>m,API_ERROR_USER_DEACTIVATED:()=>M});const n=1,r=5,a=6,o=9,i=10,c=14,l=15,d=17,u=23,h=29,m=39,p=43,f=100,g=103,v=917,_=925,C=932,y=936,k=939,I=945,E=946,b=947,w=967,M=3610},199195:(e,t,s)=>{"use strict";s.d(t,{Player:()=>i});var n=s(434788),r=s(302278),a=s(851369);const o="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=";class i extends r.EventEmitter{play(e,t){var s,n;(null==(n=this.state.currentTrackEntity)||null==(s=n.audioTrack)?void 0:s.url)!==e.audioTrack.url?("stopped"!==this.state.status&&this.stopCurrentTrackBeforeStartingNewTrack(),this.startNewTrack(e,t)):"stopped"===this.state.status?this.repeateCurrentTrack(e,t):"paused"===this.state.status?this.resumeTrack(e,t):this.player.currentTime=e.audioTrack.duration*e.audioTrack.progress}playNext(e,t){var s;const{shuffle:n,repeatMode:r}=this.getState(),a=null==(s=t)?void 0:s.getNext(e,n,r);a&&this.play(a,t)}playPrev(e,t){var s;const{shuffle:n,repeatMode:r}=this.getState(),a=null==(s=t)?void 0:s.getPrev(e,n,r);a&&this.play(a,t)}pause(){var e;const{currentTrackEntity:t,playlist:s,playedTimeAccumulator:r}=this.state,o=null==(e=t)?void 0:e.audioTrack;if(o){const{currentTime:e}=this.player,{duration:i}=o,c=(0,n._)({},this.state,{status:"paused",playlist:s,playedTimeAccumulator:r,currentTrackEntity:(0,n._)({},t,{audioTrack:(0,n._)({},o,{progress:e/i})})});this.setState(c),this.player.pause();const l={state:c};this.emit(a.PlayerEventTypes.PAUSE_CURRENT_TRACK,l)}}resume(){var e;const{currentTrackEntity:t,playlist:s}=this.state;(null==(e=t)?void 0:e.audioTrack)&&this.resumeTrack(t,s)}resetCurrentTrackState(){var e;const{currentTrackEntity:t,playlist:s,playedTimeAccumulator:r}=this.state,a=null==(e=t)?void 0:e.audioTrack;if(a){const e=(0,n._)({},this.state,{status:"stopped",playlist:s,playedTimeAccumulator:r,currentTrackEntity:(0,n._)({},t,{audioTrack:(0,n._)({},a,{progress:0})})});this.setState(e)}}startNewTrack(e,t){const s=this.getState(),r=(0,n._)({},s,{status:"playing",playlist:t,playedTimeAccumulator:{},currentTrackEntity:e});this.setState(r);const o={state:r};this.emit(a.PlayerEventTypes.START_NEW_TRACK,o);const i=e.audioTrack.url,c=e.audioTrack.duration*e.audioTrack.progress;this.playHTML5Player(i,c)}resumeTrack(e,t){var s,r,o,i;const c=this.getState(),l=(0,n._)({},c,{status:"playing",playlist:t,playedTimeAccumulator:c.playedTimeAccumulator,currentTrackEntity:e}),d=null==(r=c.currentTrackEntity)||null==(s=r.audioTrack)?void 0:s.url;let u;this.player.duration!==1/0&&(null==(i=this.state.currentTrackEntity)||null==(o=i.audioTrack)?void 0:o.progress)!==e.audioTrack.progress&&(u=e.audioTrack.duration*e.audioTrack.progress),this.setState(l);const h={state:l};this.emit(a.PlayerEventTypes.RESUME_TRACK,h),this.playHTML5Player(d,u)}repeateCurrentTrack(e,t){this.startNewTrack(e,t)}startNextTrackAutomatically(){const e=this.getState(),{playlist:t,currentTrackEntity:s,repeatMode:r,shuffle:o}=e;let i={state:e};if(!t||!s)return void this.emit(a.PlayerEventTypes.PLAYLIST_ENDED,i);const c="one"===r?(0,n._)({},s,{audioTrack:(0,n._)({},s.audioTrack,{progress:0})}):t.getNext(s,o,r);if(!c)return void this.emit(a.PlayerEventTypes.PLAYLIST_ENDED,i);const l=(0,n._)({},e,{status:"playing",playlist:t,playedTimeAccumulator:{},currentTrackEntity:c});this.setState(l),i={state:l},this.emit(a.PlayerEventTypes.START_NEXT_TRACK_AUTOMATICALLY,i);const d=c.audioTrack.url,u=c.audioTrack.duration*c.audioTrack.progress;this.playHTML5Player(d,u)}stopCurrentTrackAutomatically(){const{currentTrackEntity:e}=this.state;if(e){const e={state:(0,n._)({},this.state)};this.emit(a.PlayerEventTypes.STOP_CURRENT_TRACK_AUTOMATICALLY,e),this.resetCurrentTrackState(),this.player.duration===1/0&&(this.player.src="")}}stopCurrentTrackBeforeStartingNewTrack(){var e;const{currentTrackEntity:t,status:s}=this.state,r=null==(e=t)?void 0:e.audioTrack;if(r&&"playing"===s){this.player.pause();const e={state:(0,n._)({},this.state,{status:"stopped"})};this.emit(a.PlayerEventTypes.STOP_CURRENT_TRACK_BEFORE_STARTING_NEW_TRACK,e),this.resetCurrentTrackState()}else r&&"paused"===s&&this.resetCurrentTrackState()}stopCurrentTrackByError(){var e;const{currentTrackEntity:t}=this.state;if(null==(e=t)?void 0:e.audioTrack){this.resetCurrentTrackState();const e={state:this.state};this.emit(a.PlayerEventTypes.STOP_CURRENT_TRACK_BY_ERROR,e)}}stopPlayer(){var e;(null==(e=this.state.currentTrackEntity)?void 0:e.audioTrack)&&(this.pause(),this.resetCurrentTrackState(),this.setState((0,n._)({},this.state,{currentTrackEntity:void 0,playlist:void 0})))}seek(e){var t;const s=this.getState(),{currentTrackEntity:r}=s,a=null==(t=r)?void 0:t.audioTrack;if(!a)return;const o=(0,n._)({},s,{currentTrackEntity:(0,n._)({},r,{audioTrack:(0,n._)({},a,{progress:e})})});this.player.currentTime=a.duration*e,this.setState(o)}setState(e){this.state=e,this.player.volume=e.volume/100,this.player.muted=e.mute,this.player.playbackRate=e.playbackRate,this.emit("stateupdated",e)}getState(){return(0,n._)({},this.state)}forceUpdate(e){var t,s;this.setState(e),this.player.src=(null==(s=e.currentTrackEntity)||null==(t=s.audioTrack)?void 0:t.url)||o}setVolume(e){const t=(0,n._)({},this.getState(),{mute:!1,volume:e});this.setState(t)}setMute(e){const t=(0,n._)({},this.getState(),{mute:e});this.setState(t)}setShuffle(e){const t=this.getState(),s=(0,n._)({},t,{shuffle:e});this.setState(s)}setRepeatMode(e){const t=this.getState(),s=(0,n._)({},t,{repeatMode:e});this.setState(s)}setPlaybackRate(e){const t=this.getState();this.setState((0,n._)({},t,{playbackRate:e}))}playHTML5Player(e,t){"number"==typeof t&&(this.player.currentTime=t),e&&this.player.src!==e&&(this.player.src=e),this.player.play().then((()=>{"playing"!==this.getState().status&&this.player.pause(),e&&this.player.src!==e&&this.player.pause()})).catch((()=>{this.stopCurrentTrackByError()}))}constructor(e){super(),this.state=e,this.player=document.createElement("audio"),this.player.volume=e.volume/100,this.player.src=o,this.player.playbackRate=e.playbackRate,this.player.addEventListener("ended",(()=>{var e;const{currentTrackEntity:t}=this.state;if(null==(e=t)?void 0:e.audioTrack){const e=(0,n._)({},this.state,{status:"ended"});this.setState(e),this.stopCurrentTrackAutomatically(),this.startNextTrackAutomatically()}})),this.player.addEventListener("error",(()=>{this.stopCurrentTrackByError()})),this.player.addEventListener("timeupdate",(()=>{var e;const t=(0,n._)({},this.state);if(null==(e=t.currentTrackEntity)?void 0:e.audioTrack){const{currentTime:e,duration:s}=this.player,{duration:r,progress:a,id:o}=t.currentTrackEntity.audioTrack,i=e/r;i>0&&(t.playedTimeAccumulator[o]=(e=>{const t=e.played;let s=0;for(let e=0;e<t.length;e++)s+=t.end(e)-t.start(e);return s})(this.player)),this.setState((0,n._)({},t,{currentTrackEntity:(0,n._)({},t.currentTrackEntity,{audioTrack:(0,n._)({},t.currentTrackEntity.audioTrack,{progress:i>1?1:i})})})),s===1/0&&(0===i&&0!==a||i>1)&&this.player.dispatchEvent(new Event("ended"))}}))}}},624990:(e,t,s)=>{"use strict";s.d(t,{PlayerStorage:()=>a,VoicePlayerStorage:()=>o});var n=s(395340),r=s(460554);class a extends n.Storage{getPlaylist(){const e=this.get("reforged_audio_player_playlist");if((0,r.isRestoredConvoAudiosPlaylist)(e))return new r.ConvoAudiosPlaylist(e)}getCurrentTrack(){const e=this.get("reforged_audio_player_track");if((0,r.isConvoAudioTrack)(e))return e}getVolume(){return this.get("reforged_audio_player_volume")}storeVolume(e){this.set("reforged_audio_player_volume",e)}getMute(){return this.get("reforged_audio_player_mute")}storeMute(e){this.set("reforged_audio_player_mute",e)}getShuffle(){return this.get("reforged_audio_player_shuffle")}storeShuffle(e){this.set("reforged_audio_player_shuffle",e)}getRepeatMode(){return this.get("reforged_audio_player_repeat_mode")}storeRepeatMode(e){this.set("reforged_audio_player_repeat_mode",e)}invalidatePlayerStateCache(){const e=this.get("reforged_audio_player_saved")||0;Date.now()-72e5>e&&(this.del("reforged_audio_player_playlist"),this.del("reforged_audio_player_saved"),this.del("reforged_audio_player_track"))}restorePlayerState(){this.invalidatePlayerStateCache();const e=this.getVolume()||100,t=this.getMute()||!1,s=this.getShuffle()||!1,n=this.getRepeatMode()||"none";return{status:"stopped",playedTimeAccumulator:{},currentTrackEntity:this.getCurrentTrack(),playlist:this.getPlaylist(),volume:e,mute:t,shuffle:s,repeatMode:n,playbackRate:1}}storePlayerState(e){const{currentTrackEntity:t,playlist:s,volume:n}=e;this.set("reforged_audio_player_saved",Date.now()),this.set("reforged_audio_player_volume",n),t?this.set("reforged_audio_player_track",t):this.del("reforged_audio_player_track"),s?s instanceof r.ConvoAudiosPlaylist&&this.set("reforged_audio_player_playlist",{meta:s.getPlaylistMeta(),list:s.getConvoAudiosList()}):this.del("reforged_audio_player_playlist")}}class o extends n.Storage{getVolume(){return this.get("reforged_voice_player_volume")}storeVolume(e){this.set("reforged_voice_player_volume",e)}getMute(){return this.get("reforged_voice_player_mute")}storeMute(e){this.set("reforged_voice_player_mute",e)}getPlaybackRate(){return this.get("reforged_voice_player_playback_rate")}storePlaybackRate(e){this.set("reforged_voice_player_playback_rate",e)}restorePlayerState(){return{status:"stopped",playedTimeAccumulator:{},volume:this.getVolume()||100,mute:this.getMute()||!1,shuffle:!1,repeatMode:"none",playbackRate:this.getPlaybackRate()||1}}}},13211:(e,t,s)=>{"use strict";s.d(t,{BroadcastChannel:()=>r});var n=s(302278);class r extends n.EventEmitter{emit(e){const t=this.connectionId,s=JSON.stringify((e=>({__act:e}))(e));window.localStorage.removeItem(t),window.localStorage.setItem(t,s)}emitLocally(e,t){super.emit(e,t)}constructor(){super(),this.connectionId="queue_connection_events_queue78668286",window.addEventListener("storage",(e=>{try{if(e.key===this.connectionId&&e.newValue){var t;const s=null==(t=JSON.parse(e.newValue))?void 0:t.__act;s&&super.emit(s)}}catch(e){}}))}}},982732:(e,t,s)=>{"use strict";s.d(t,{ExternalEvents:()=>n});class n{constructor(){this.listeners=[],this.send=(e,t)=>{for(const s of this.listeners)s(e,t)},this.subscribe=e=>(this.listeners.push(e),()=>{this.listeners=this.listeners.filter((t=>t!==e))})}}},277210:(e,t,s)=>{"use strict";s.d(t,{MEAppMediaMediator:()=>r});var n=s(13211);class r{constructor(){this.broadcastChannel=new n.BroadcastChannel,this.player=null,this.voicePlayer=null,this.videoMessagePlayer=null,this.currentMedia=null,this.prevMedia=null,this.destroy=()=>{this.currentMedia=null,this.prevMedia=null,this.player=null,this.voicePlayer=null,this.videoMessagePlayer=null,this.broadcastChannel.unsubscribe("audio_start",this.pauseCurrentMedia),this.broadcastChannel.unsubscribe("video_message_start",this.pauseCurrentMedia),this.broadcastChannel.unsubscribe("stories_video_start",this.pauseCurrentMedia)},this.pauseCurrentMedia=()=>{var e;(null==(e=this.currentMedia)?void 0:e.isPlaying())&&this.currentMedia.handleMediaMediatorPause()},this.handlePlayerOn=e=>{if(this.broadcastChannel.emit("audio_start"),this.player=e,this.currentMedia){if(this.currentMedia&&this.currentMedia!==this.player){this.currentMedia.isPlaying()?(this.currentMedia.handleMediaMediatorPause(),this.prevMedia=this.currentMedia,this.currentMedia=this.player):(this.prevMedia=null,this.currentMedia=this.player)}}else this.prevMedia=null,this.currentMedia=this.player},this.handleVoicePlayerOn=e=>{if(this.broadcastChannel.emit("audio_start"),this.voicePlayer=e,this.currentMedia){if(this.currentMedia&&this.currentMedia!==this.voicePlayer){this.currentMedia.isPlaying()?(this.currentMedia.handleMediaMediatorPause(),this.prevMedia=this.currentMedia,this.currentMedia=this.voicePlayer):(this.prevMedia=null,this.currentMedia=this.voicePlayer)}}else this.prevMedia=null,this.currentMedia=this.voicePlayer},this.handleVoicePlayerOff=e=>{this.voicePlayer=e,this.currentMedia&&this.currentMedia===this.voicePlayer&&(this.currentMedia=null,this.prevMedia&&(this.prevMedia.handleMediaMediatorResume(),this.currentMedia=this.prevMedia,this.prevMedia=null))},this.handleVideoMessagePlayerOn=e=>{if(this.broadcastChannel.emit("video_message_start"),this.videoMessagePlayer=e,this.currentMedia){if(this.currentMedia&&this.currentMedia!==this.videoMessagePlayer){this.currentMedia.isPlaying()?(this.currentMedia.handleMediaMediatorPause(),this.prevMedia=this.currentMedia,this.currentMedia=this.videoMessagePlayer):(this.prevMedia=null,this.currentMedia=this.videoMessagePlayer)}}else this.prevMedia=null,this.currentMedia=this.videoMessagePlayer},this.handleVideoMessagePlayerOff=e=>{this.videoMessagePlayer=e,this.currentMedia&&this.currentMedia===this.videoMessagePlayer&&(this.currentMedia=null,this.prevMedia&&(this.prevMedia.handleMediaMediatorResume(),this.currentMedia=this.prevMedia,this.prevMedia=null))},this.handleVoiceRecorderOn=()=>{if(this.broadcastChannel.emit("audio_start"),this.currentMedia||this.prevMedia!==this.player)if(this.currentMedia){if(this.currentMedia){this.currentMedia.isPlaying()?(this.currentMedia.handleMediaMediatorPause(),this.prevMedia=this.currentMedia,this.currentMedia=null):(this.prevMedia=null,this.currentMedia=null)}}else this.prevMedia=null,this.currentMedia=null},this.handleVoiceRecorderOff=()=>{this.prevMedia&&this.prevMedia===this.player?(this.prevMedia.handleMediaMediatorResume(),this.currentMedia=this.prevMedia,this.prevMedia=null):(this.currentMedia=null,this.prevMedia=null)},this.broadcastChannel.subscribe("audio_start",this.pauseCurrentMedia),this.broadcastChannel.subscribe("video_message_start",this.pauseCurrentMedia),this.broadcastChannel.subscribe("stories_video_start",this.pauseCurrentMedia)}}},915234:(e,t,s)=>{"use strict";s.d(t,{MEAppPlayer:()=>l,MEAppVideoMessagePlayer:()=>u,MEAppVoicePlayer:()=>d});var n=s(434788),r=s(199195),a=s(188305),o=s(624990),i=s(851369),c=s(95154);class l extends r.Player{play(e,t){return this.mediaMediator.handlePlayerOn(this),super.play(e,t)}setVolume(e){super.setVolume(e);const{volume:t,mute:s}=this.getState();this.playerStorage.storeVolume(t),this.playerStorage.storeMute(s)}setMute(e){super.setMute(e);const{volume:t,mute:s}=this.getState();this.playerStorage.storeVolume(t),this.playerStorage.storeMute(s)}setShuffle(e){super.setShuffle(e);const{shuffle:t}=this.getState();this.playerStorage.storeShuffle(t)}setRepeatMode(e){super.setRepeatMode(e);const{repeatMode:t}=this.getState();this.playerStorage.storeRepeatMode(t)}stopPlayer(){super.stopPlayer();const e=this.getState();this.playerStorage.storePlayerState((0,n._)({},e,{status:"stopped"}))}isPlaying(){const{status:e}=this.getState();return"playing"===e}handleMediaMediatorResume(){super.resume()}handleMediaMediatorPause(){super.pause()}constructor(e,t){super({status:"stopped",playedTimeAccumulator:{},volume:100,mute:!1,shuffle:!1,repeatMode:"none",playbackRate:1}),this.subscribe(i.PlayerEventTypes.START_NEW_TRACK,(e=>{this.playerStorage.storePlayerState((0,n._)({},e.state,{status:"stopped"}))})),this.subscribe(i.PlayerEventTypes.START_NEXT_TRACK_AUTOMATICALLY,(e=>{this.playerStorage.storePlayerState((0,n._)({},e.state,{status:"stopped"}))})),this.mediaMediator=e,this.playerStorage=new o.PlayerStorage(c.STORAGE_DB_NAME),this.playerStorage.identify(t);const s=this.playerStorage.restorePlayerState();this.forceUpdate(s)}}class d extends r.Player{setVolume(e){var t,s;super.setVolume(e);const{volume:n,mute:r}=this.getState();null==(t=this.playerStorage)||t.storeVolume(n),null==(s=this.playerStorage)||s.storeMute(r)}setMute(e){var t,s;super.setMute(e);const{volume:n,mute:r}=this.getState();null==(t=this.playerStorage)||t.storeVolume(n),null==(s=this.playerStorage)||s.storeMute(r)}setPlaybackRate(e){var t;super.setPlaybackRate(e);const{playbackRate:s}=this.getState();null==(t=this.playerStorage)||t.storePlaybackRate(s)}play(e,t){return this.mediaMediator.handleVoicePlayerOn(this),super.play(e,t)}isPlaying(){const{status:e}=this.getState();return"playing"===e}handleMediaMediatorResume(){super.resume()}handleMediaMediatorPause(){super.pause()}constructor(e,t){super({status:"stopped",playedTimeAccumulator:{},volume:100,mute:!1,shuffle:!1,repeatMode:"none",playbackRate:1}),this.pause=()=>{super.pause(),this.mediaMediator.handleVoicePlayerOff(this)},this.mediaMediator=e,this.subscribe(i.PlayerEventTypes.PLAYLIST_ENDED,(()=>this.mediaMediator.handleVoicePlayerOff(this))),this.playerStorage=new o.VoicePlayerStorage(c.STORAGE_DB_NAME),this.playerStorage.identify(t);const s=this.playerStorage.restorePlayerState();this.forceUpdate(s)}}class u extends a.VideoMessagePlayer{play(e,t){this.mediaMediator.handleVideoMessagePlayerOn(this),super.play(e,t)}resume(){this.mediaMediator.handleVideoMessagePlayerOn(this),super.resume()}stop(){this.mediaMediator.handleVideoMessagePlayerOff(this),super.stop()}destroy(){this.mediaMediator.destroy()}isPlaying(){const{status:e}=this.getState();return"playing"===e}handleMediaMediatorResume(){super.resume()}handleMediaMediatorPause(){super.pause()}constructor(e){super({status:"stopped",settings:{volume:1,playbackRate:1,muted:!1}}),this.pause=()=>{super.pause(),this.mediaMediator.handleVideoMessagePlayerOff(this)},this.mediaMediator=e}}},327320:(e,t,s)=>{"use strict";s.d(t,{MEAppRecorder:()=>r});var n=s(924222);class r extends n.Recorder{start(){return this.mediaMediator.handleVoiceRecorderOn(),super.start()}pause(){const e=super.pause();return this.mediaMediator.handleVoiceRecorderOff(),e}resume(){return this.mediaMediator.handleVoiceRecorderOn(),super.resume()}stop(){const e=super.stop();return this.mediaMediator.handleVoiceRecorderOff(),e}constructor(e={},t,s){super(e,s),this.mediaMediator=t}}},924222:(e,t,s)=>{"use strict";s.d(t,{Recorder:()=>a});var n=s(434788);const r={bufferLength:4096,encoderApplication:2049,encoderFrameSize:20,encoderSampleRate:48e3,maxFramesPerPage:40,mediaTrackConstraints:!0,monitorGain:0,numberOfChannels:1,recordingGain:1,resampleQuality:3,streamPages:!0,wavBitDepth:16,encoderPath:new URL(s(923562),s.b).href,reuseWorker:!0};class a{initWorklet(){return this.audioContext.audioWorklet?this.audioContext.audioWorklet.addModule(this.config.encoderPath):Promise.resolve()}initEncoder(){this.audioContext.audioWorklet&&(this.encoderNode=new AudioWorkletNode(this.audioContext,"encoder-worklet",{numberOfOutputs:0}),this.encoder=this.encoderNode.port)}storePage(e){this.recordedPages.push(e),this.totalLength+=e.length}streamPage(e){this.onDataAvailable(e)}clearStream(){this.stream&&this.stream.getTracks&&this.stream.getTracks().forEach((e=>e.stop()))}suspendAudioContext(){if("suspended"!==this.audioContext.state)try{this.audioContext.suspend()}catch(e){}}finish(){if(!this.config.streamPages){const e=new Uint8Array(this.totalLength);this.recordedPages.reduce(((t,s)=>(e.set(s,t),t+s.length)),0),this.onDataAvailable(e)}this.onStop()}initWorker(){const e=(this.config.streamPages?this.streamPage:this.storePage).bind(this);return this.recordedPages=[],this.totalLength=0,new Promise((t=>{var s,n,r;const a=({data:s})=>{switch(s.message){case"ready":t();break;case"page":e(s.page);break;case"done":var n;null==(n=this.encoder)||n.removeEventListener("message",a),this.finish()}};null==(s=this.encoder)||s.addEventListener("message",a),(null==(n=this.encoder)?void 0:n.start)&&this.encoder.start(),null==(r=this.encoder)||r.postMessage(Object.assign({command:"init",originalSampleRate:this.audioContext.sampleRate,wavSampleRate:this.audioContext.sampleRate},this.config))}))}initSourceNode(){return window.navigator.mediaDevices.getUserMedia({audio:this.config.mediaTrackConstraints}).then((e=>{this.stream=e,this.sourceNode=this.audioContext.createMediaStreamSource(e)}))}start(){return"inactive"===this.state?(this.state="loading",this.audioContext.resume().then((()=>this.initialize)).then((()=>Promise.all([this.initSourceNode(),this.initWorker()]))).then((()=>{var e,t,s;this.sourceNode&&this.encoderNode?(this.state="recording",null==(e=this.encoder)||e.postMessage({command:"getHeaderPages"}),null==(t=this.sourceNode)||t.connect(this.monitorGainNode),null==(s=this.sourceNode)||s.connect(this.recordingGainNode),this.monitorGainNode.connect(this.audioContext.destination),this.recordingGainNode.connect(this.encoderNode),this.onStart()):this.state="inactive"})).catch((e=>{throw this.suspendAudioContext(),this.state="inactive",e}))):Promise.resolve()}pause(){return"recording"===this.state?(this.state="paused",this.recordingGainNode.disconnect(),new Promise((e=>{var t,s,n;const r=({data:t})=>{var s;"flushed"===t.message&&(null==(s=this.encoder)||s.removeEventListener("message",r),this.onPause(),e())};null==(t=this.encoder)||t.addEventListener("message",r),null==(s=this.encoder)||s.start(),null==(n=this.encoder)||n.postMessage({command:"flush"})}))):(this.onPause(),Promise.resolve())}resume(){"paused"===this.state&&this.encoderNode&&(this.state="recording",this.recordingGainNode.connect(this.encoderNode),this.onResume())}stop(){return this.resume(),"recording"===this.state?(this.state="inactive",this.monitorGainNode.disconnect(),this.clearStream(),this.suspendAudioContext(),new Promise((e=>{var t,s,n;const r=({data:t})=>{var s;"done"===t.message&&(null==(s=this.encoder)||s.removeEventListener("message",r),e())};null==(t=this.encoder)||t.addEventListener("message",r),null==(s=this.encoder)||s.start(),null==(n=this.encoder)||n.postMessage({command:"done"})}))):(this.onStop(),Promise.resolve())}subscribeToAnalyzer(e){const t=this.sourceNode,s=t.context.createAnalyser();s.fftSize=64,t.connect(s);const n=s.frequencyBinCount,r=new Uint8Array(n);let a=!1;function o(){if(a)return;s.getByteFrequencyData(r);const t=r.reduce(((e,t)=>e+t),0)/n/255;e(t<.1?0:t),requestAnimationFrame(o)}return o(),[()=>{a=!0},()=>{a=!1,o()}]}constructor(e={},t){this.state="inactive",this.config=r,this.recordedPages=[],this.totalLength=0,this.onDataAvailable=function(e){},this.onStart=function(){},this.onPause=function(){},this.onResume=function(){},this.onStop=function(){},this.config=(0,n._)({},r,e);try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.suspendAudioContext.call(this)}catch(e){t.info(`[VoiceRecorder]: new AudioContext ERROR: ${e}`),this.audioContext={createGain(){}}}this.monitorGainNode=this.audioContext.createGain(),this.monitorGainNode&&this.audioContext&&this.monitorGainNode.gain.setTargetAtTime(this.config.monitorGain,this.audioContext.currentTime,.01),this.recordingGainNode=this.audioContext.createGain(),this.recordingGainNode&&this.audioContext&&this.recordingGainNode.gain.setTargetAtTime(this.config.recordingGain,this.audioContext.currentTime,.01),this.initialize=this.initWorklet().then((()=>this.initEncoder()))}}},395340:(e,t,s)=>{"use strict";s.d(t,{Storage:()=>a});var n=s(11010),r=s(891047);class a{mapKey(e){if(!this.viewerPeerId)throw new Error("Перед использованием Storage должен быть идентифицирован!");return`${this.dbName}-${this.viewerPeerId}-${e}`}constructor(e){this.idbStoreName="storage",this.identify=e=>{this.viewerPeerId=e},this.get=e=>{const t=this.mapKey(e);try{const e=localStorage.getItem(t);if(!e)return;return JSON.parse(e,i)}catch(e){return}},this.set=(e,t)=>{const s=this.mapKey(e);try{localStorage.setItem(s,JSON.stringify(t,o))}catch(e){}},this.del=e=>{const t=this.mapKey(e);try{localStorage.removeItem(t)}catch(e){}};var t=this;this.getIDB=(0,n._)((function*(e){const s=t.mapKey(e);return yield r.get(s,t.idbStorage)}));var s=this;this.setIDB=(0,n._)((function*(e,t){const n=s.mapKey(e);return yield r.set(n,t,s.idbStorage)}));var a=this;this.updateIDB=(0,n._)((function*(e,t){const s=a.mapKey(e);return r.update(s,t,a.idbStorage)}));var c=this;this.delIDB=(0,n._)((function*(e){const t=c.mapKey(e);return yield r.del(t,c.idbStorage)})),this.dbName=e,this.idbStorage=window.indexedDB&&r.createStore(e,this.idbStoreName)}}function o(e,t){return t instanceof Map?{dataType:"Map",entries:Array.from(t.entries())}:t instanceof Set?{dataType:"Set",values:Array.from(t.values())}:t}function i(e,t){if("object"==typeof t&&null!==t){if("Map"===t.dataType)return new Map(t.entries);if("Set"===t.dataType)return new Set(t.values)}return t}},188305:(e,t,s)=>{"use strict";s.d(t,{VideoMessagePlayer:()=>c});var n=s(434788),r=s(302278),a=s(851369),o=s(51174);const i={volume:1,playbackRate:1};class c extends r.EventEmitter{setVolume(e){this.setState((0,n._)({},this.state,{settings:(0,n._)({},this.state.settings,{muted:!1,volume:e})})),this.player.muted=!1,this.player.volume=e,localStorage.setItem("videomessage_settings",JSON.stringify(this.state.settings))}setMuted(e){const t=(0,n._)({},this.state,{settings:(0,n._)({},this.state.settings,{muted:e})});this.setState(t),this.player.muted=e}setPlaybackRate(e){this.setState((0,n._)({},this.state,{settings:(0,n._)({},this.state.settings,{playbackRate:e})})),this.player.playbackRate=e,localStorage.setItem("videomessage_settings",JSON.stringify(this.state.settings))}stop(){this.player.pause(),this.player.currentTime=0,this.player.src="",this.setState((0,n._)({},this.state,{status:"stopped",playlist:void 0,currentVideoMessageTrack:void 0}))}play(e,t){this.playHTML5Player(t,t.progress),this.setState((0,n._)({},this.state,{status:"playing",convoPeerId:e,currentVideoMessageTrack:t}))}move(e=!1){if(!this.state.currentVideoMessageTrack)return;const{playlist:t}=this.state;if(t){const s=e?t.getPrev(this.state.currentVideoMessageTrack):t.getNext(this.state.currentVideoMessageTrack),{convoPeerId:n}=t.getPlaylistMeta();if(s)return this.play(n,s),this.scrollToMessage(),s;this.stop()}else this.stop()}pause(){const{currentVideoMessageTrack:e}=this.state;e&&(this.player.pause(),this.setState((0,n._)({},this.state,{status:"paused"})))}resume(){const{currentVideoMessageTrack:e}=this.state;e&&(this.playHTML5Player(e),this.setState((0,n._)({},this.state,{status:"playing"})))}endTrack(){this.setState((0,n._)({},this.state,{status:"ended"}));const{playlist:e}=this.state;e?this.move():this.stop()}setProgress(e){const{currentVideoMessageTrack:t}=this.state;t&&this.setState((0,n._)({},this.state,{currentVideoMessageTrack:(0,n._)({},t,{progress:e})}))}scrollToMessage(){this.state.currentVideoMessageTrack&&this.emit(a.VideoMessagePlayerEventTypes.SCROLL_TO_MESSAGE,this.state.currentVideoMessageTrack.id)}stopCurrentTrackByError(e){var t;const{currentVideoMessageTrack:s}=this.state;(null==(t=s)?void 0:t.id)===e&&this.setState((0,n._)({},this.state,{status:"stopped",currentVideoMessageTrack:(0,n._)({},s,{progress:0})}))}setState(e){this.state=e,this.emit(a.VideoMessagePlayerEventTypes.STATE_UPDATED,e)}getState(){return this.state}getPlayer(){return this.player}forceUpdate(e){this.setState(e)}setPlaylist(e){this.setState((0,n._)({},this.state,{playlist:e}))}tick(){const{currentVideoMessageTrack:e}=this.state;if(e){const{currentTime:t,duration:s}=this.player,{duration:n=1,progress:r=0}=e,a=t/n;this.setProgress(a>1?1:a),s===1/0&&0===a&&0!==r&&this.player.dispatchEvent(new Event("ended"))}}playHTML5Player(e,t){const s=(0,o.getVideoSource)(e.files);"number"==typeof t&&(this.player.currentTime=t),s&&this.player.src!==s&&(this.player.src=s),this.player.volume=this.state.settings.volume,this.player.playbackRate=this.state.settings.playbackRate,this.player.muted=this.state.settings.muted,this.player.play().then((()=>{const{status:e}=this.state;"playing"!==e&&this.player.pause(),s&&this.player.src!==s&&this.player.pause()})).catch((()=>{this.stopCurrentTrackByError(e.id)}))}constructor(e){super(),this.player=document.createElement("video"),this.player.disablePictureInPicture=!0,this.player.playsInline=!0,this.player.src="",this.state=e;const t=localStorage.getItem("videomessage_settings");this.state.settings=t?JSON.parse(t):i,this.player.addEventListener("ended",(()=>{this.endTrack()})),this.player.addEventListener("timeupdate",(()=>{this.tick()})),this.player.addEventListener("error",(()=>{const{currentVideoMessageTrack:e}=this.state;e&&this.stopCurrentTrackByError(e.id)}))}}},51174:(e,t,s)=>{"use strict";s.d(t,{getVideoSource:()=>a,toVideoMessageTrack:()=>r});var n=s(434788);function r(e,t,s,r,a){return(0,n._)({},t,{id:`${s}_${t.id}`,rootMessageId:s,progress:e,messageSentAt:r,messageAuthorId:a})}function a(e){var t,s,n,r,a,o,i,c;return(null==(t=e)?void 0:t.mp4_2160)||(null==(s=e)?void 0:s.mp4_1440)||(null==(n=e)?void 0:n.mp4_1080)||(null==(r=e)?void 0:r.mp4_720)||(null==(a=e)?void 0:a.mp4_480)||(null==(o=e)?void 0:o.mp4_360)||(null==(i=e)?void 0:i.mp4_240)||(null==(c=e)?void 0:c.mp4_144)||""}},785132:(e,t,s)=>{"use strict";s.d(t,{searchConversations:()=>d,searchMessages:()=>h,searchPosts:()=>g,searchUsersGlobal:()=>p});var n=s(11010),r=s(434788),a=s(954811),o=s(96190),i=s(481186),c=s(95154),l=s(54965);function d(e,t,s,n){return u.apply(this,arguments)}function u(){return(u=(0,n._)((function*(e,t,s,n){const r=yield e("messages.searchConversations",{q:s,count:c.SEARCH_CONVOS_COUNT,extended:1,group_id:n}),{profiles:o,groups:i,items:l,contacts:d}=r;return t({profiles:o,groups:i,conversations:l,contacts:d}),l.reduce(((e,t)=>{const s=(0,a.fromApiConvo)(t);return s&&e.add(s.convo.peerId),e}),new Set)}))).apply(this,arguments)}function h(e,t,s,n){return m.apply(this,arguments)}function m(){return(m=(0,n._)((function*(e,t,s,n){const a=yield e("messages.search",(0,r._)({},n,{extended:1,count:c.SEARCH_MESSAGES_COUNT})),{items:o,count:l,conversations:d,contacts:u,profiles:h,groups:m}=a;s({profiles:h,groups:m,conversations:d,contacts:u});return{results:o.reduce(((e,s)=>{const n=(0,i.fromApiMessage)(s).message;return"Normal"===n.kind?e.push(n):t.error(`Сообщение неожиданного типа вернулось из message.search: ${n.kind}`),e}),[]),count:l,apiItemsCount:o.length}}))).apply(this,arguments)}function p(e,t,s){return f.apply(this,arguments)}function f(){return(f=(0,n._)((function*(e,t,s){const n=yield e("users.search",s),{items:r,count:a}=n;t({profiles:r});return{results:r.map((e=>o.resolveRealId("User",e.id))),count:a}}))).apply(this,arguments)}function g(e,t,s,n){return v.apply(this,arguments)}function v(){return(v=(0,n._)((function*(e,t,s,n){const r=yield e("wall.search",{owners_only:1,query:n.query,offset:n.offset,owner_id:n.channelId,extended:1,count:c.SEARCH_POSTS_COUNT}),{items:a,count:o,profiles:i,groups:d}=r;s({profiles:i,groups:d});return{results:a.reduce(((e,t)=>{const s=(0,l.fromApiSearchPost)(t);return s?(e.push(s),e):e}),[]),count:o,apiItemsCount:a.length}}))).apply(this,arguments)}},663126:(e,t,s)=>{"use strict";s.d(t,{useApiFetch:()=>c});var n=s(434788),r=s(696023),a=s(667294),o=s(927411),i=s(53416);function c(){const{api:e}=(0,r.useBrowserEnv)(),t=(0,a.useRef)(new Set);return(0,a.useEffect)((()=>()=>{t.current.forEach((s=>{e.dangerouslyAbort(s),t.current.delete(s)}))}),[e]),(0,a.useCallback)(((s,r,a)=>{const c=o.IApi.resolveTrackId(s,(0,i.nanoid)(5));return t.current.add(c),e.fetch(s,r,(0,n._)({},a,{trackId:c}))}),[e])}},955625:(e,t,s)=>{"use strict";s.d(t,{useConvoOrganiser:()=>l});var n=s(185327),r=s(498928),a=s(999504),o=s(667294),i=s(89131),c=s(696023);function l(e,t,s,l){const[d,u]=(0,o.useState)(s),h=(0,o.useMemo)((()=>{let s=[];switch(d.kind){case"filters":{if(!(d.filter in e.filters))throw new Error("Выбрана несуществущая папка");const a=e.filters[d.filter];return s=Array.from(a.peerIds,(e=>n.safeGet(t,e))).sort(r.sorter),{organiser:d,convos:s,hasMore:a.hasMore}}case"folders":{const o=e.folders.find((e=>e.id===d.id));return o?(s=Array.from(o[d.filter].peerIds,(e=>n.safeGet(t,e))).sort(a.sorter),{organiser:d,convos:s,hasMore:o[d.filter].hasMore}):(u({kind:"filters",filter:l}),{organiser:{kind:"filters",filter:l},hasMore:e.filters.all.hasMore,convos:Array.from(e.filters.all.peerIds,(e=>n.safeGet(t,e))).sort(r.sorter)})}default:(0,i.exhaustivenessCheck)(d)}}),[d,e.filters,e.folders,t,l]),m=(0,c.useMemoWithCustomCompare)((()=>h.convos),h.convos,i.isShallowEqual);return{selectedOrganiser:h.organiser,convos:m,hasMore:h.hasMore,setSelectedOrganiser:u}}},435683:(e,t,s)=>{"use strict";s.d(t,{useFormatPhoneNumber:()=>r});var n=s(667294);function r(){const[e,t]=(0,n.useState)(!1),r=(0,n.useRef)(null);(0,n.useEffect)((()=>{s.e(4387).then(s.bind(s,304387)).then((({getAsYouType:e})=>{r.current=e("RU"),t(!0)}))}),[]);return{isReady:e,format:(0,n.useCallback)((e=>{if(!r.current)return e;if(0===e.length)return"";let t=e;return"9"===t[0]&&(t="+7"+t),"8"===t[0]&&(t="+7"+e.slice(1)),"+"!==t[0]&&(t="+"+t),r.current.reset(t.replace(/[^\d+]/g,"")),r.current.number().trim()}),[])}}},897297:(e,t,s)=>{"use strict";s.d(t,{useTabListNavigation:()=>a});var n=s(667294);const r=0;function a({hasMore:e=!1}){const[t,s]=(0,n.useState)(r),[a,o]=(0,n.useState)(!1),i=(0,n.useRef)(0),c=(0,n.useCallback)((e=>i.current=e),[]),l=(0,n.useRef)(),d=(0,n.useCallback)((e=>l.current=e),[]),u=(0,n.useCallback)(((e=r)=>{o(!1),s(e)}),[]),h=(0,n.useCallback)(((n,r)=>{if(0!==i.current)switch(n){case"Enter":var a,c;r(),null==(a=(c=l).current)||a.call(c,t);break;case"ArrowDown":r(),o(e&&t+1===i.current),s((e=>e+1<i.current?e+1:e));break;case"ArrowUp":r(),s((e=>e>0?e-1:0)),o(!1)}}),[t,e]);return{setTabsCount:c,setSelectHandler:d,indexToSelect:t,onKeyDown:h,resetIndexToSelect:u,forceScrollToLoader:a}}},79522:(e,t,s)=>{"use strict";s.d(t,{usePhoneJoin:()=>l});var n=s(11010),r=s(667294),a=s(174182),o=s(96190),i=s(696023),c=s(276351);function l({onClose:e,onSuccess:t,onError:s,peerId:l}){const{api:d,lang:u}=(0,i.useBrowserEnv)(),{importContact:h}=(0,c.useImportContact)(),[m,p]=(0,r.useState)(!1),[f,g]=(0,r.useState)(""),v=(0,r.useCallback)((()=>{e(),p(!1),g("")}),[e]),_=(0,r.useCallback)((()=>g("")),[]),C=(0,r.useCallback)((0,n._)((function*(e){p(!0);try{const s=yield h({phone:e,name:"",withExisting:!0});if(s.hasFailed)return void g(u.use("me_phone_invite_error_wrong_number"));const n=o.resolveRealId("Contact",s.contact.id);l&&o.isChatPeerId(l)&&(yield d.fetch("messages.addChatUser",{peer_id:n,chat_id:o.toRealId(l)})),t(n)}catch(e){var n;null==(n=s)||n(e)}finally{p(!1)}})),[d,h,u,s,t,l]);return{modal:r.createElement(a.PhoneInviteModal,{onClose:v,onSubmit:C,onErrorReset:_,error:f,isLoading:m,isInvite:void 0!==l,focusOnMount:!0})}}},760802:(e,t,s)=>{"use strict";s.d(t,{usePicker:()=>i,usePickerSearch:()=>c});var n=s(667294),r=s(89131),a=s(897297),o=s(546428);const i=({selection:e,strategy:t})=>{const[s,a]=(0,n.useState)(e);return"singular"===t&&e.size>1&&r.isDev&&console.error("В режиме выбора одной единицы данных должно быть не более одного элемента по умолчанию"),(0,n.useEffect)((()=>{a(e)}),[e]),{toggleSelection(e){let n;switch(t){case"singular":n=new Map(s.has(e.id)?[[e.id,e.value]]:[]);break;case"multiple":n=new Map(s);break;default:(0,r.exhaustivenessCheck)(t)}n.has(e.id)?n.delete(e.id):n.set(e.id,e.value),a(n)},selection:s}};function c({items:e,onSelect:t,getItemId:s,onQueryChange:r,initialQuery:i,hasMore:c}){const{setTabsCount:l,setSelectHandler:d,resetIndexToSelect:u,onKeyDown:h,indexToSelect:m,forceScrollToLoader:p}=(0,a.useTabListNavigation)({hasMore:c}),f=(0,n.useCallback)((n=>{u(n);const r=e[n];void 0!==r&&t({id:s(r),value:r})}),[u,e,t,s]);(0,n.useEffect)((()=>{d(f)}),[d,f]),(0,n.useEffect)((()=>{l(e.length)}),[e.length,l]);const[g,v]=(0,n.useState)(i),_=(0,n.useCallback)((e=>{u(),v(e),r(e)}),[u,v,r]),C=(0,n.useMemo)((()=>(0,o.onElementKeyDownFactory)(((e,t)=>{if("Escape"===e)t(),_(i);h(e,t)}))),[_,h,i]);return{query:g,onQueryUpdate:_,onKeyDown:C,indexToSelect:m,forceScrollToLoader:p,resetIndexToSelect:()=>u(-1)}}},686260:(e,t,s)=>{"use strict";s.d(t,{useConvoSearch:()=>v,useConvoSearchData:()=>y,useMessagesSearchData:()=>I,usePostsSearchData:()=>E,useSearchHandlers:()=>_,useUsersGlobalSearchData:()=>M});var n=s(11010),r=s(434788),a=s(820224),o=s(667294),i=s(696023),c=s(96190),l=s(821551),d=s(785132),u=s(897297),h=s(546428),m=s(991792),p=s(663126),f=s(95154),g=s(709646);function v({onSelect:e,searchIndex:t,defaultResults:s}){const{setTabsCount:n,setSelectHandler:i,resetIndexToSelect:c,onKeyDown:l,indexToSelect:d,forceScrollToLoader:h}=(0,u.useTabListNavigation)({}),m=_(),{query:p,setNavigationParams:f}=m,g=(0,a._)(m,["query","setNavigationParams"]);(0,o.useEffect)((()=>{f({resetIndexToSelect:c,onKeyDown:l})}),[f,c,l]);const{results:v,isLoading:C,isDefault:k}=y({searchIndex:t,defaultResults:s,query:p});var I;const E=(0,o.useMemo)((()=>null!=(I=S(v))?I:[]),[v]),b=(0,o.useCallback)((t=>{const s=E[t];void 0!==s&&e(s)}),[E,e]);return(0,o.useEffect)((()=>{i(b)}),[b,i]),(0,o.useEffect)((()=>{n(E.length)}),[E,n]),(0,r._)({query:p},g,{results:v,isLoading:C,isDefault:k,indexToSelect:d,forceScrollToLoader:h})}function _(){const e=(0,o.useRef)(null),t=(0,o.useCallback)((t=>e.current=t),[]),[s,n]=(0,o.useState)(""),[r,a]=(0,o.useState)(!1),i=(0,o.useCallback)((t=>{var s;n(t),null==(s=e.current)||s.resetIndexToSelect()}),[]),c=(0,o.useCallback)((e=>i(e.target.value)),[i]),l=(0,o.useMemo)((()=>(0,h.onElementKeyDownFactory)(((t,s)=>{var n;if("Escape"===t)s(),i("");null==(n=e.current)||n.onKeyDown(t,s)}))),[i]),d=(0,o.useCallback)((()=>{a(!0)}),[]),u=(0,o.useCallback)((()=>{a(!1)}),[]),m=(0,o.useCallback)((()=>{i("")}),[i]),p=(0,o.useRef)(),[f,g]=(0,o.useState)(!1);return(0,o.useLayoutEffect)((()=>{r&&g(!1)}),[r]),(0,o.useLayoutEffect)((()=>{g(!s&&!!p.current),p.current=s}),[s]),{onChange:c,onKeyDown:l,onFocus:d,onBlur:u,reset:m,isFocused:r,becameEmpty:f,setNavigationParams:t,query:s,setQuery:i}}const C=new Set;function y({defaultResults:e=C,searchIndex:t,query:s}){const[a,u]=(0,o.useState)({isLoading:!1,results:e}),h=(0,o.useRef)(!0),{debounced:g,debouncedUpdatesCount:v}=(0,i.useDebounced)(s,f.SEARCH_DEBOUNCE_MS),_=(0,p.useApiFetch)(),y=(0,i.useOwner)(),k=(0,i.useInsertIntoCache)(),I=0===s.length,E=(0,i.usePeers)();(0,o.useEffect)((()=>{I&&(h.current=!0,u({isLoading:!1,results:e}))}),[I,e]),(0,o.useEffect)((()=>{if(I)return;h.current=!1;const e=t?l.search(t,s):new Set;u({isLoading:!0,results:e})}),[s,I]);const b=(0,o.useRef)(s);b.current=s;const w=(0,o.useCallback)((0,n._)((function*(e){if(0!==e.length){u((e=>(0,r._)({},e,{loading:!0})));try{const t=yield(0,d.searchConversations)(_,k,e,(0,m.getOwnerGroupId)(y.id));if(b.current!==e)return;u((e=>{const s=new Set([...e.results.values()]);return t.forEach((e=>{if(c.isContactPeerId(e)){var t;const s=E.get(e);if("Contact"===(null==(t=s)?void 0:t.kind)&&s.userId)return}s.has(e)||s.add(e)})),{isLoading:!1,results:s}}))}catch(e){u((e=>(0,r._)({},e,{loading:!1})))}}})),[_,k,y.id,E]);(0,o.useEffect)((()=>{w(g)}),[v,g]);const{isLoading:M,results:S}=a;let R;return R=s&&M&&0===S.size?"loading":s&&!M&&0===S.size?"empty":S,{results:R,isLoading:M,isDefault:h.current}}const k=[];function I({query:e,date:t,peerId:s}){const a=0===e.length&&!t,{logger:c}=(0,i.useBrowserEnv)(),l=(0,i.useOwner)(),u=(0,i.useInsertIntoCache)(),h=(0,p.useApiFetch)(),[f,g]=(0,o.useState)({isLoading:!1,hasMore:!0,results:k}),v=(0,o.useRef)(0),_=(0,o.useRef)(e);_.current=e;const C=(0,o.useCallback)((0,n._)((function*(e){if(!a){g((e=>(0,r._)({},e,{isLoading:!0})));try{const n=yield(0,d.searchMessages)(h,c,u,{q:e,peer_id:s,date:t,offset:v.current,group_id:(0,m.getOwnerGroupId)(l.id)});if(_.current!==e)return;const{results:r,count:a,apiItemsCount:o}=n;v.current+=o,g((e=>({isLoading:!1,hasMore:a>v.current&&o>0,results:[...e.results,...r]})))}catch(e){g((e=>(0,r._)({},e,{isLoading:!1,hasMore:!1})))}}})),[a,s,t,h,u,c,l.id]),{isLoading:y,hasMore:I,results:E}=f,b=(0,o.useCallback)((()=>{I&&!y&&C(e)}),[I,y,C,e]);(0,o.useLayoutEffect)((()=>{v.current=0,a?g({isLoading:!1,hasMore:!1,results:k}):(g({isLoading:!0,hasMore:!0,results:[]}),C(e))}),[a,e,s,t]);return{results:0===E.length&&!y&&!I&&!a?"empty":E,isLoading:y,hasMore:I,loadMore:b}}function E({query:e,channelId:t}){const s=0===e.length,{logger:a}=(0,i.useBrowserEnv)(),c=(0,i.useInsertIntoCache)(),l=(0,p.useApiFetch)(),[u,h]=(0,o.useState)({isLoading:!1,hasMore:!0,results:[]}),m=(0,o.useRef)(0),g=(0,o.useRef)(e);g.current=e;const v=(0,o.useCallback)((0,n._)((function*(e){if(!s){h((e=>(0,r._)({},e,{isLoading:!0})));try{if(!t)return;const s=yield(0,d.searchPosts)(l,a,c,{query:e,channelId:t,offset:m.current});if(g.current!==e)return;const{results:n,apiItemsCount:r}=s;m.current+=r,h((e=>({isLoading:!1,hasMore:f.SEARCH_POSTS_COUNT===r,results:[...e.results,...n]})))}catch(e){h((e=>(0,r._)({},e,{isLoading:!1,hasMore:!1})))}}})),[s,l,c,a,t]),{isLoading:_,hasMore:C,results:y}=u,k=(0,o.useCallback)((()=>{C&&!_&&v(e)}),[C,_,v,e]);(0,o.useLayoutEffect)((()=>{m.current=0,s?h({isLoading:!1,hasMore:!1,results:[]}):(h({isLoading:!0,hasMore:!0,results:[]}),v(e))}),[s,e,t]);return{results:0===y.length&&!_&&!C&&!s?"empty":y,isLoading:_,hasMore:C,loadMore:k}}const b=20,w=[];function M({query:e}){const t=0===e.length,s=(0,p.useApiFetch)(),a=(0,i.useFeatureFlags)(),{profileType:c}=(0,i.useViewer)(),l=!a.vkm_add_non_friends||g.isEdu(c),u=(0,i.useInsertIntoCache)(),[h,m]=(0,o.useState)({isLoading:!1,hasMore:!0,results:w}),f=(0,o.useRef)(0),v=(0,o.useRef)(e);v.current=e;const _=(0,o.useCallback)((0,n._)((function*(e){if(!t){m((e=>(0,r._)({},e,{isLoading:!0})));try{const t=yield(0,d.searchUsersGlobal)(s,u,{q:e,offset:f.current,count:b});if(v.current!==e)return;const{results:n,count:r}=t;f.current+=b,m((e=>({isLoading:!1,hasMore:r>f.current&&0!==n.length,results:[...e.results,...n]})))}catch(e){m((e=>(0,r._)({},e,{isLoading:!1,hasMore:!1})))}}})),[t,s,u]),{isLoading:C,hasMore:y,results:k}=h,I=(0,o.useCallback)((()=>{!y||C||l||_(e)}),[y,C,_,e,l]);(0,o.useLayoutEffect)((()=>{f.current=0,t||l?m({isLoading:!1,hasMore:!1,results:w}):(m({isLoading:!0,hasMore:!0,results:w}),_(e))}),[t,e,l]);return{results:0===k.length&&!C&&!y&&!t?"empty":k,isLoading:C,hasMore:y,loadMore:I}}const S=e=>"empty"===e||"loading"===e?null:Array.from(e.values())},433348:(e,t,s)=>{"use strict";s.d(t,{SnackbarProvider:()=>u,useSnackbar:()=>h});var n=s(434788),r=s(820224),a=s(667294),o=s(814640),i=s(129879),c=s(974004),l=s(429697),d=s(247293);const u=(0,a.memo)((e=>{const[t,s]=(0,a.useState)(d.snackbarStore.getState());return(0,a.useEffect)((()=>{const e=d.snackbarStore.subscribe(s);return()=>{e(),d.snackbarStore.reset()}}),[]),a.createElement(o.SnackbarContainer,(0,n._)({},e),a.createElement(c.default,{component:"ul",className:"SnackbarContainer__list"},t.map((e=>a.createElement(m,{key:e.id,timeout:400,classNames:"SnackbarContainer__item-"},a.createElement(i.Snackbar,(0,n._)({},e)))))))}));function h(){return(0,a.useMemo)((()=>(0,d.createSnackbar)()),[])}const m=e=>{var{children:t}=e,s=(0,r._)(e,["children"]);const o=(0,a.useRef)(null);return a.createElement(l.default,(0,n._)({},s,{nodeRef:o}),a.createElement("li",{className:"SnackbarContainer__item",ref:o},t))}},895043:(e,t,s)=>{"use strict";s.d(t,{useStatsOnMount:()=>a});var n=s(696023),r=s(667294);function a(e){const{stats:t}=(0,n.useBrowserEnv)();(0,r.useEffect)((()=>{t.logEvent(e)}),[])}},413066:(e,t,s)=>{"use strict";s.d(t,{AttachCard:()=>l,getExpectedAttachPhotoWidth:()=>d});var n=s(434788),r=(s(760398),s(667294)),a=s(597298),o=s(696023),i=s(197934),c=s(959107);const l=({href:e,attach:t,picture:s,title:l,subtitle:d,alt:u,isInBubble:h,isOut:m,picturePlaceholder:p})=>{const{calls:f,router:g}=(0,o.useBrowserEnv)(),v=r.createElement(c.AttachmentCell,{isInBubble:h,isOut:m,alt:u,image:s||p,title:l,subtitle:d}),_=t?{kind:"AttachProxyRoute",attach:t,fallbackUrl:e||void 0}:null;if(_&&g.toUrl(_)){let t;if(e&&i.isCallJoinLink(e)&&f&&"ConvoRoute"===g.currentRoute.kind){const[,s]=e.split("/join/");s&&(t=e=>{e.preventDefault(),e.stopPropagation(),"ConvoRoute"===g.currentRoute.kind&&g.push((0,n._)({},g.currentRoute,{callJoinHash:s}))})}return t?r.createElement("div",{className:"AttachCard AttachCard--interactive",onClick:t},v):r.createElement(a.Link,{to:_,className:"AttachCard"},v)}return e?r.createElement(a.ExternalLink,{href:e,className:"AttachCard"},v):r.createElement("span",{className:"AttachCard"},v)};function d(){return 40*("undefined"!=typeof window?window.devicePixelRatio:1)}},936890:(e,t,s)=>{"use strict";s.d(t,{Avatar:()=>d});s(380283);var n=s(667294),r=s(294184),a=s.n(r),o=s(696023),i=s(89131),c=s(83298),l=s(811632);const d=n.memo((function({peer:e,size:t,activityIndicator:s,withOnline:r=!1,withBirthday:i=!1,activeCall:c,className:d}){const h=function(e,t){var s;if(!(null==(s=e)?void 0:s.isOnline))return"Offline";if(t)switch(e.platform){case"vkme":case"mobile":return"Mobile";case"other":return"Online";default:e.platform;return"Online"}return"Offline"}((0,o.useLastSeen)(e.id),r),m=!!c,p=i&&function(e){var t;if("User"!==e.kind||!e.bdate)return!1;const s=new Date,n=String(s.getDate()),r=String(s.getMonth()+1),{day:a,month:o}=(null==(t=RegExp("(?<day>\\d+)\\.(?<month>\\d+)").exec(e.bdate))?void 0:t.groups)||{};return a===n&&o===r}(e),f=(0,n.useMemo)((()=>({width:t,height:t})),[t]),g=function(e,t,s){return`mePeerFrame${e}${t}${s?"c":""}`}(h,t,m||p),v=`url(#${g}Mask${e.id})`,_=a()("MEAvatar",`MEAvatar--size-${t}`,{"MEAvatar--withActivity":!!s,"MEAvatar--emptyCall":"empty"===c},d);return n.createElement("figure",{style:f,className:_},n.createElement("div",{className:"MEAvatar__imgWrapper",style:{clipPath:v}},n.createElement(l.PeerAvatar,{peer:e,size:t}),s&&n.createElement("div",{className:"MEAvatar__activityIndicator"},s)),n.createElement(u,{frameType:h}),p&&n.createElement("div",{className:"MEAvatar__upperRightIcon MEAvatar__birthday"},n.createElement("svg",{className:"MEAvatar__upperRightIconSvg"},n.createElement("use",{href:"#meCake10"}))),m&&n.createElement("div",{className:"MEAvatar__upperRightIcon MEAvatar__call"},n.createElement("svg",{className:"MEAvatar__upperRightIconSvg"},n.createElement("use",{href:"#mePhone10"}))),n.createElement("svg",{className:"MEAvatar__svg"},n.createElement("clipPath",{id:g+"Mask"+e.id},n.createElement("use",{href:"#"+g})),n.createElement("use",{href:"#"+g,className:"MEAvatar__shadow",clipPath:v})))}));const u=({frameType:e})=>{switch(e){case"Mobile":return n.createElement("div",{className:"MEAvatar__mobile"},n.createElement(c.Icon12OnlineMobile,null));case"Online":return n.createElement("div",{className:"MEAvatar__online"});case"Offline":return null;default:(0,i.exhaustivenessCheck)(e)}}},377291:(e,t,s)=>{"use strict";s.d(t,{AvatarFavorites:()=>l});var n=s(667294),r=(s(320428),s(294184)),a=s.n(r),o=s(696023),i=s(359251),c=s(999411);const l=({size:e,className:t})=>{const{lang:s}=(0,o.useBrowserEnv)(),r=(0,n.useMemo)((()=>({width:e,height:e})),[e]),i=a()("AvatarFavorites",t);return n.createElement("div",{style:r,className:i,"aria-label":s.use("me_favorites")},d[e])},d={24:n.createElement("svg",{fill:"currentColor",height:"12",width:"12",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},n.createElement("path",{d:"M5.55 1.29h.9c.58 0 1.05 0 1.42.03.38.03.71.1 1.01.25.49.24.88.64 1.13 1.12.15.3.21.63.25 1.01.03.38.03.84.03 1.42v3.7c0 .44 0 .8-.03 1.07-.02.27-.08.55-.25.77-.24.3-.61.48-1 .48-.28 0-.53-.12-.76-.27-.23-.15-.51-.36-.85-.63l-.82-.64a1.8 1.8 0 00-.47-.32.43.43 0 00-.22 0 1.8 1.8 0 00-.47.32l-.82.64c-.34.27-.62.48-.85.63-.23.15-.48.28-.76.27-.39 0-.76-.18-1-.48-.17-.22-.23-.5-.25-.77-.03-.28-.03-.63-.03-1.06v-3.7c0-.59 0-1.05.03-1.43.04-.38.1-.71.25-1.01.25-.48.64-.88 1.13-1.12.3-.16.63-.22 1-.25.38-.03.85-.03 1.43-.03zm-1.35.88c-.33.03-.53.08-.7.16-.32.16-.58.43-.74.75-.08.16-.13.36-.16.69-.03.34-.03.77-.03 1.37v3.67c0 .46 0 .77.02 1 .02.24.06.3.07.32.08.1.2.16.34.16.01 0 .09-.01.29-.14.2-.12.44-.32.8-.6l.8-.62.06-.04c.25-.2.46-.37.71-.43.22-.06.46-.06.68 0 .25.06.46.23.71.43l.06.04.8.62c.36.28.6.48.8.6.2.13.28.14.3.14.12 0 .25-.06.33-.16 0-.02.05-.08.07-.32.02-.23.02-.54.02-1V5.14c0-.6 0-1.03-.03-1.37a1.81 1.81 0 00-.16-.7 1.71 1.71 0 00-.75-.74 1.81 1.81 0 00-.69-.16c-.33-.03-.76-.03-1.37-.03h-.86c-.6 0-1.04 0-1.37.03z"})),32:n.createElement("svg",{fill:"currentColor",height:"16",width:"16",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},n.createElement("path",{d:"M7.4 1.71h1.2c.78 0 1.4 0 1.9.05.5.04.94.12 1.34.33.65.33 1.17.85 1.5 1.5.2.4.3.83.33 1.34.04.5.04 1.12.04 1.9v4.94c0 .58 0 1.05-.03 1.41-.03.37-.1.74-.34 1.03-.32.4-.8.65-1.33.65-.37 0-.7-.17-1.01-.36-.31-.2-.68-.5-1.14-.84l-1.09-.85a2.4 2.4 0 00-.62-.43.57.57 0 00-.3 0 2.4 2.4 0 00-.62.43l-1.1.85c-.45.35-.82.64-1.13.84-.3.2-.64.36-1.01.36-.52 0-1.01-.24-1.33-.65-.24-.3-.3-.66-.34-1.03-.03-.36-.03-.83-.03-1.4V6.82c0-.78 0-1.4.04-1.9s.13-.94.33-1.34c.33-.65.85-1.17 1.5-1.5.4-.2.83-.3 1.35-.33.5-.05 1.11-.05 1.9-.05zM5.6 2.9c-.44.04-.71.1-.92.22-.43.22-.78.57-1 1-.11.2-.18.48-.21.92a24.9 24.9 0 00-.04 1.83v4.88c0 .61 0 1.03.03 1.34.03.32.08.4.1.42.1.14.26.22.44.22.02 0 .12-.01.38-.19.26-.16.6-.42 1.08-.8l1.07-.83.07-.05c.33-.26.62-.48.95-.57.3-.08.6-.08.9 0 .33.09.62.31.95.57l.07.05 1.07.84c.49.37.82.63 1.08.8.26.17.36.18.38.18.18 0 .34-.08.45-.22.01-.02.06-.1.1-.42.02-.3.02-.73.02-1.34V6.86c0-.81 0-1.39-.04-1.83-.03-.44-.1-.71-.2-.92a2.29 2.29 0 00-1-1c-.22-.11-.49-.18-.93-.22a24.9 24.9 0 00-1.83-.03H7.43c-.81 0-1.38 0-1.83.03z"})),40:n.createElement("svg",{fill:"currentColor",height:"20",width:"20",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},n.createElement("path",{d:"M9.25 2.14h1.5c.97 0 1.74 0 2.37.05a4.4 4.4 0 011.68.42c.8.41 1.46 1.07 1.88 1.87.25.5.36 1.05.41 1.69.05.62.05 1.4.05 2.37v6.18c0 .71 0 1.3-.04 1.76-.04.45-.13.92-.42 1.28-.4.51-1.01.8-1.66.81-.47 0-.89-.2-1.27-.45-.39-.25-.85-.6-1.42-1.05L10.96 16a3 3 0 00-.77-.54.71.71 0 00-.38 0 3 3 0 00-.77.54l-1.37 1.06c-.57.44-1.03.8-1.42 1.05-.38.24-.8.46-1.27.45-.65 0-1.26-.3-1.66-.8a2.36 2.36 0 01-.42-1.29c-.04-.46-.04-1.05-.04-1.76V8.54c0-.97 0-1.75.05-2.37a4.4 4.4 0 01.41-1.69A4.29 4.29 0 015.2 2.61a4.4 4.4 0 011.68-.42c.63-.05 1.4-.05 2.37-.05zM7 3.62c-.55.04-.89.13-1.15.26-.54.28-.98.71-1.25 1.25-.14.27-.22.6-.27 1.15-.04.56-.04 1.28-.04 2.3v6.1c0 .76 0 1.29.03 1.67.04.4.1.5.12.52.13.17.34.27.55.28.03 0 .16-.02.5-.23.32-.21.73-.53 1.33-1l1.34-1.04a41 41 0 00.09-.07c.4-.32.77-.6 1.19-.72.37-.1.75-.1 1.12 0 .42.12.78.4 1.2.72l.08.07 1.34 1.04c.6.47 1.01.79 1.34 1 .33.21.46.23.49.23.21 0 .42-.1.55-.27.02-.03.08-.13.12-.53.03-.38.03-.9.03-1.67v-6.1c0-1.02 0-1.74-.04-2.3a3.02 3.02 0 00-.27-1.15 2.86 2.86 0 00-1.25-1.25c-.26-.13-.6-.22-1.15-.26-.56-.05-1.27-.05-2.29-.05H9.3c-1.02 0-1.73 0-2.3.05z"})),44:n.createElement("svg",{fill:"currentColor",height:"22",width:"22",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},n.createElement("path",{d:"M10.18 2.36h1.64c1.07 0 1.92 0 2.61.05.7.06 1.3.18 1.85.46.89.45 1.61 1.17 2.06 2.06.28.55.4 1.15.46 1.85.06.7.06 1.54.06 2.61v6.8c0 .79 0 1.44-.05 1.94-.04.5-.14 1-.46 1.4-.44.57-1.12.9-1.83.9a2.6 2.6 0 01-1.4-.5c-.42-.27-.93-.67-1.56-1.15l-1.5-1.17a3.3 3.3 0 00-.85-.59.78.78 0 00-.42 0 3.3 3.3 0 00-.85.59l-1.5 1.17c-.63.48-1.14.88-1.56 1.15-.42.27-.89.5-1.4.5-.71 0-1.39-.33-1.83-.9a2.6 2.6 0 01-.46-1.4c-.05-.5-.05-1.15-.05-1.94v-6.8c0-1.07 0-1.92.06-2.6.06-.7.18-1.3.46-1.86a4.71 4.71 0 012.06-2.06c.55-.28 1.15-.4 1.85-.46.69-.05 1.54-.05 2.61-.05zM7.7 3.98c-.6.05-.98.14-1.27.3-.6.3-1.07.77-1.37 1.36-.15.3-.25.67-.3 1.27-.05.62-.05 1.4-.05 2.52v6.72c0 .84 0 1.41.04 1.84.04.43.11.55.13.57.15.19.38.3.61.3.04 0 .17-.01.54-.25.36-.23.81-.58 1.47-1.1l1.47-1.14.1-.08c.45-.35.85-.66 1.31-.79.4-.1.83-.1 1.24 0 .46.13.86.44 1.3.8l.1.07 1.48 1.14c.66.52 1.11.87 1.47 1.1.37.24.5.25.54.25.23 0 .46-.11.6-.3.03-.02.1-.14.14-.57.03-.43.04-1 .04-1.84V9.43c0-1.11 0-1.9-.06-2.52-.04-.6-.14-.97-.29-1.27-.3-.59-.78-1.07-1.37-1.37-.3-.15-.66-.24-1.27-.29-.61-.05-1.4-.05-2.51-.05H10.2c-1.1 0-1.9 0-2.51.05z"})),46:n.createElement("svg",{fill:"currentColor",height:"24",width:"24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},n.createElement("path",{d:"M11.1 2.57h1.8c1.16 0 2.1 0 2.84.06.77.07 1.42.2 2.02.5.97.5 1.76 1.28 2.25 2.25.3.6.44 1.25.5 2.02.06.75.06 1.68.06 2.85v7.4c0 .87 0 1.58-.05 2.13-.05.54-.16 1.1-.5 1.53-.49.61-1.22.97-2 .98-.56 0-1.06-.25-1.52-.55-.47-.3-1.02-.73-1.7-1.26l-1.64-1.27a3.6 3.6 0 00-.94-.64.86.86 0 00-.44 0 3.6 3.6 0 00-.94.64L9.2 20.48c-.68.53-1.23.97-1.7 1.26-.46.3-.96.55-1.52.55-.78 0-1.51-.37-2-.98-.34-.44-.45-1-.5-1.53-.05-.55-.05-1.26-.05-2.12v-7.41c0-1.17 0-2.1.06-2.85.06-.77.2-1.42.5-2.02a5.14 5.14 0 012.25-2.25c.6-.3 1.25-.43 2.02-.5.75-.06 1.68-.06 2.85-.06zM8.4 4.34c-.66.06-1.07.16-1.39.32-.64.33-1.16.85-1.5 1.5-.16.32-.26.72-.31 1.38-.06.67-.06 1.53-.06 2.75v7.32c0 .92 0 1.55.05 2.01.04.48.12.6.14.63.16.2.4.32.66.33.04 0 .19-.02.59-.28.39-.25.88-.63 1.6-1.2l1.61-1.24.1-.09c.5-.38.93-.72 1.44-.86.44-.12.9-.12 1.34 0 .5.14.94.48 1.43.86l.11.09 1.6 1.24c.73.57 1.22.95 1.61 1.2.4.26.55.28.59.28.26 0 .5-.13.66-.33.02-.03.1-.15.14-.63.05-.46.05-1.09.05-2v-7.33c0-1.22 0-2.08-.06-2.75a3.62 3.62 0 00-.32-1.38 3.43 3.43 0 00-1.5-1.5 3.62 3.62 0 00-1.38-.32c-.67-.05-1.53-.05-2.74-.05h-1.72c-1.21 0-2.07 0-2.74.05z"})),48:n.createElement(i.Icon24BookmarkOutline,null),56:n.createElement(c.Icon56BookmarkOutline,{width:36,height:36}),80:n.createElement(c.Icon56BookmarkOutline,null)}},402423:(e,t,s)=>{"use strict";s.d(t,{AvatarSelector:()=>N});var n=s(11010),r=s(667294),a=s(294184),o=s.n(a),i=s(197934),c=s(96190),l=s(790351),d=s(696023),u=(s(810874),s(402516)),h=s(249600),m=s(376499),p=s(77199),f=s(277659),g=s(538839),v=s(413066),_=s(126528),C=s(599660),y=s(163332),k=s(811632),I=s(367763),E=s(410519),b=s(266864),w=s(597298),M=s(86894),S=s(95154);const R=r.createElement(u.Icon28CameraAddOutline,{"data-testid":"avatar-selector-default-image"}),A=200,P=7e3,F=.25,U=3,N=({size:e=72,peerId:t,isLoading:s,onSelection:a,onUpload:P,onRemove:F,isDisabled:U=!1,isEditing:N=!1,noImage:x})=>{const[O,L]=(0,r.useState)(!1),q=(0,r.useRef)(null),{lang:B,uploader:D,imageAreaSelector:z}=(0,d.useBrowserEnv)(),H=(0,E.useSubModal)(),{viewer:G}=(0,d.useViewer)(),{isTouchOnly:V}=(0,I.useDeviceData)(),W=!V||N,K=(0,d.useFeatureFlags)(),j=(0,d.usePeers)(),Z=(0,r.useMemo)((()=>t?c.safeGet(j,t):null),[j,t]),[$,Q]=(0,r.useState)(null),[X,J]=(0,r.useState)(null),Y=(0,d.usePrevious)($),ee=(0,d.usePrevious)(X),te=!(!$||X),se=s||te,ne=(0,r.useMemo)((()=>X?null:Z?"User"!==Z.kind?null:Z.photoId?Z.photoId:null:null),[X,Z]),re=(0,r.useMemo)((()=>{if(X)return!0;if(!Z)return!1;switch(Z.kind){case"Chat":return c.hasPhoto(Z)&&!Z.hasDefaultPhoto;case"User":return c.hasPhoto(Z)&&!Z.hasDefaultPhoto&&Z.photoId;default:return c.hasPhoto(Z)}}),[X,Z]),ae=()=>{q.current&&(q.current.value="")},oe=(0,n._)((function*(e){var t;const s=(null==(t=e.target.files)?void 0:t.item(0))||null;if(!s)return;const n=yield function(e){return T.apply(this,arguments)}(s);if(!n)return H.open(),void ae();if(z&&K.vkm_avatar_area_selector)try{const e=yield(0,g.fileToStaticImageUrl)(s),t=yield(0,g.getImageSizeByFile)(s),n=yield z.open({cropArea:{height:A,width:A},imageSrc:e,imageSize:t,mode:"circle"});if(n){const e=new File([n],s.name,{type:n.type});Q(e)}}catch(e){H.open(),ae()}else Q(s)})),ie=(0,r.useCallback)((e=>{try{D.uploadFiles([e],{},{viewerId:G.id,targetPeerId:G.id},{onUploadFinish:e=>{const{photos:t}=l.Uploader.buildAttachments(Array.from(e.values()));if(!t)throw new Error("Неожиданный ответ системы загрузки файлов, загруженные аттачи не вернулись");J(t[0])}})}catch(e){Q(null)}}),[D,G.id]),ce=()=>{var e;L(!1),ae(),null==(e=q.current)||e.click()};(0,r.useEffect)((()=>{J(null),$&&ie($)}),[$,ie]),(0,r.useEffect)((()=>{null!==$&&$!==Y&&a($)}),[$,Y,a]),(0,r.useEffect)((()=>{var e;null!==X&&X!==ee&&(null==(e=P)||e(X))}),[X,ee,P]);return r.createElement(r.Fragment,null,r.createElement(y.Dropdown,{hideOnClick:!0,open:O,onOpen:()=>L(!0),onClose:()=>L(!1),content:r.createElement(C.ActionsMenu,null,!se&&ne&&r.createElement(w.Link,{to:{kind:"PhotoModalRoute",ownerId:G.id,id:ne},className:"AvatarSelector__dropDownLink"},r.createElement(C.ActionsMenuAction,{leftIcon:r.createElement(h.Icon20PictureOutline,null),type:"secondary",title:B.use("me_open_photo"),disabled:U})),r.createElement(C.ActionsMenuAction,{leftIcon:r.createElement(m.Icon20WriteOutline,null),type:"secondary",disabled:te||U,title:B.use(re?"me_update_photo":"me_upload_photo"),onClick:ce}),t&&K.vkm_create_avatar_from_sticker&&r.createElement(w.Link,{className:"AvatarSelector__dropDownLink",to:{kind:"MiniAppModalRoute",miniAppId:i.resolveMiniAppId(S.STICKER_IMAGE_EDITOR_MINI_APP_ID),hash:`peer=${t}`}},r.createElement(C.ActionsMenuAction,{leftIcon:r.createElement(p.Icon20Stars,null),disabled:se||U,type:"secondary",title:B.use("me_create_from_sticker"),onClick:()=>L(!1)})),re&&r.createElement(C.ActionsMenuAction,{leftIcon:r.createElement(f.Icon20DeleteOutline,null),type:"danger",disabled:se||U,title:B.use("me_remove_photo"),"data-testid":"avatar-selector-remove",onClick:()=>{var e;Q(null),J(null),null==(e=F)||e()}})),forceUpdateContent:!0,align:"left",position:"bottom"},r.createElement("div",{className:o()("AvatarSelector",`AvatarSelector--size-${e}`,{AvatarSelector__loading:se,"AvatarSelector--disabled":U}),"data-testid":"avatar-selector"},se&&r.createElement(_.OptimizedSpinner,{className:"AvatarSelector__loader",size:"small"}),r.createElement("div",{className:"AvatarSelector__image"},(()=>{if(!X&&!$)return x||(null!==Z?r.createElement(k.PeerAvatar,{peer:Z,size:e}):R);let t=null;if(X){const s=i.preview(X,(0,v.getExpectedAttachPhotoWidth)(),e,!0);s&&(t=s.url)}else $&&(t=(0,g.blobToImageUrl)({blob:$}));return t?r.createElement("img",{alt:"",src:t,className:"AvatarSelector__preview","data-testid":"avatar-selector-preview"}):x||R})()),W&&r.createElement("button",{key:`${se}`,className:o()("AvatarSelector__button",{AvatarSelector__buttonEditing:N}),onClick:ce,disabled:se,"aria-label":B.use(re?"me_update_photo":"me_upload_photo")},r.createElement(u.Icon28CameraAddOutline,null)),r.createElement("input",{ref:q,"data-testid":"avatar-selector-input",type:"file",className:"AvatarSelector__input",onChange:oe,accept:l.IMAGE_TYPES.join()}))),H.isActive&&r.createElement(b.ModalInterface,{onClose:H.close,closeLabel:B.use("me_close"),onBack:H.close,contextClass:"MEConfig",title:B.use("me_avatar_selector_error_title"),buttons:r.createElement(M.Button,{onClick:H.close},B.use("me_close"))},r.createElement("div",{className:"AvatarSelector__errorText"},B.use("me_avatar_selector_error_text"))))};function T(){return(T=(0,n._)((function*(e){try{return function({width:e,height:t}){const s=e/t,n=e<=P&&t<=P,r=F<s&&s<U;return e>=A&&t>=A&&n&&r}(yield(0,l.preloadImage)(e))}catch(e){return console.error(e),!1}}))).apply(this,arguments)}},755810:(e,t,s)=>{"use strict";s.d(t,{BasicAvatar:()=>o,useAvatarPhoto:()=>i});var n=s(667294),r=s(659397),a=s(696023);s(419308);const o=({url:e,alt:t,text:s,size:a,color:o,className:i,onError:c})=>{const[l,d]=(0,n.useState)(!1),u="contact"===o?"BasicAvatar__noImg--color-contact":`BasicAvatar__noImg--color-${Math.abs((null!=o?o:0)%6)}`,h=(0,r.classNames)("BasicAvatar",`BasicAvatar--size-${a}`,i),m=(0,n.useMemo)((()=>[...s].slice(0,2).join("")),[s]);return n.createElement("div",{className:h},e&&!l?n.createElement("img",{className:"BasicAvatar__img",alt:t,src:e,onError:()=>{var e;d(!0),null==(e=c)||e()}}):n.createElement("div",{className:(0,r.classNames)("BasicAvatar__noImg",{[u]:void 0!==o})},m))};function i(e,t){var s;const n=(0,a.usePixelDensity)();if(!e)return;n&&(t*=2);return null==(s=[{size:50,url:e.photo50},{size:100,url:e.photo100||e.photo50},{size:200,url:e.photo200||e.photo100||e.photo50}].find((e=>t<=e.size&&Boolean(e.url))))?void 0:s.url}},814977:(e,t,s)=>{"use strict";s.d(t,{CasperIcon:()=>l});var n=s(900917),r=s(696023),a=(s(677749),s(943997)),o=s(294184),i=s.n(o),c=s(667294);const l=({className:e})=>{const{lang:t}=(0,r.useBrowserEnv)();return c.createElement("div",{className:i()("CasperIcon__container",e)},c.createElement(a.Tooltip,{content:c.createElement("span",{className:"CasperIcon__tooltip"},t.use("me_casper_chat_info")),position:"top",align:"center"},c.createElement("span",{className:"CasperIcon__icon"},c.createElement(n.Icon16Ghost,null))))}},826226:(e,t,s)=>{"use strict";s.d(t,{ContactList:()=>M});s(200930);var n=s(667294),r=s(936890),a=s(696023),o=s(331870),i=s(561743),c=s(126528),l=s(96190),d=s(821551),u=s(709646),h=s(619688),m=s(274061),p=s(444831),f=s(532048),g=s(282384),v=s(67091),_=s(686260),C=s(864739),y=s(410519),k=s(79522),I=s(364705),E=s(433348),b=s(86894),w=s(546428);const M=({items:e,contacts:t,hasMore:s,onSelect:r})=>{const l=(0,a.useDispatch)(),{lang:g}=(0,a.useBrowserEnv)(),{navigate:v}=(0,I.useRouter)(),w=(0,E.useSnackbar)(),M=(0,a.useFeatureFlags)(),R=(0,n.useRef)(null),A=(0,n.useRef)(null),[P,F]=(0,n.useState)(!1),[U,N]=(0,n.useState)("loading"),[T,x]=(0,n.useState)([]),O=(0,n.useMemo)((()=>new Map([...t].filter((([,e])=>0===e.userId)))),[t]),{query:L,onChange:q,onKeyDown:B,onFocus:D,onBlur:z,reset:H}=(0,_.useSearchHandlers)(),{viewer:{isVerified:G},profileType:V}=(0,a.useViewer)(),W=u.isEdu(V),K=(0,n.useCallback)((()=>F(!0)),[]),j=(0,n.useCallback)((()=>F(!1)),[]),Z=(0,n.useCallback)((({index:e,style:t})=>n.createElement("li",{key:e,style:t,className:"ContactList__itemWrapper"},n.createElement("button",{className:"ContactList__importButton",onClick:K},n.createElement("span",{className:"ContactList__importButtonIcon"},n.createElement(o.Icon20UserAddOutline,null)),g.use("me_contacts_import")))),[g,K]),$=(0,y.useModal)(),Q=(0,n.useCallback)((e=>{$.close(),v({kind:"ConvoRoute",peerId:e,entrypoint:"contacts_list"})}),[v,$]),X=(0,n.useCallback)((()=>{w({before:n.createElement(i.Icon20GlobeCrossOutline,{fill:"var(--vkui--color_text_negative)"}),message:g.use("me_phone_invite_contacts_unknown_error")})}),[w,g]),{modal:J}=(0,k.usePhoneJoin)({onClose:$.close,onSuccess:Q,onError:X}),Y=(0,n.useCallback)((({index:e,style:t})=>n.createElement("li",{key:e,style:t,className:"ContactList__itemWrapper"},n.createElement(C.InviteButton,{onClick:$.open,className:"ContactList__phoneJoin"},g.use("me_phone_invite_contacts_action")))),[$.open,g]),ee=!W||G,te=(0,n.useMemo)((()=>{const e=ee?[Z]:[];return M.vkm_write_non_friends_by_phone&&ee&&e.push(Y),e}),[M.vkm_write_non_friends_by_phone,Z,ee,Y]),se=(0,n.useMemo)((()=>d.add(d.create(),[...e.values(),...t.values()],(e=>({id:"Contact"===e.kind&&e.userId?e.userId:e.id,strings:d.peerWords(e)})))),[t,e]);(0,n.useEffect)((()=>{if(s)return void l({type:"LoadContactList",offset:0});const t=[...e.keys(),...O.keys()];x(t),N(0===t.length?"empty":"results")}),[s,l,e,O]),(0,n.useEffect)((()=>{var e;null==(e=A.current)||e.focus()}),[]),(0,n.useEffect)((()=>{if("loading"===U)return;if(L){const e=[...d.search(se,L).values()];return x(e),void N(e.length?"results":"empty")}const t=[...e.keys(),...O.keys()];x(t),N(0===t.length?"empty":"results")}),[O,L,e,se,U]);const ne=(0,n.useCallback)((e=>{var t,s;return(null==(t=(s=te)[e.index])?void 0:t.call(s,e))||null}),[te]);return n.createElement("div",{className:"ContactList"},"loading"!==U&&t.size>0&&n.createElement("div",{className:"ContactList__search"},n.createElement(b.Search,{placeholder:g.use("me_convo_list_search_placeholder"),getRef:A,value:L,onChange:q,onKeyDown:B,onFocus:D,onBlur:z,onReset:H})),"empty"!==U&&n.createElement("div",{className:"ContactList__contacts"},"loading"===U?n.createElement(c.OptimizedSpinner,{className:"ContactList__loader"}):n.createElement(h.default,null,(e=>n.createElement(f.ScrollbarProvider,{style:e,overflowX:"hidden"},(({scrollableRef:t,contentRef:s})=>n.createElement(m.FixedSizeList,{ref:R,className:"ContactList__virtual",height:e.height||0,width:e.width||0,overscanCount:10,itemCount:te.length+T.length,itemSize:56,innerElementType:"ul",outerRef:t,innerRef:s,itemData:{onSelect:r,renderActionButton:ne,actionButtons:te,contacts:O,results:T}},S)))))),"empty"===U&&n.createElement("div",{className:"ContactList__contacts"},te.length>0&&n.createElement("ul",null,te.map(((e,t)=>ne({index:t,style:{},data:{}})))),n.createElement("div",{className:"ContactList__noResults"},g.use(L?"me_search_empty_contacts":"me_contacts_empty"))),P&&n.createElement(p.ImportContactModal,{onClose:j}),$.isActive&&J)},S=n.memo((({index:e,style:t,data:{contacts:s,results:r,onSelect:o,actionButtons:i,renderActionButton:c}})=>{const l=(0,a.usePeers)();if(e<i.length)return c({index:e,style:t,data:{}});const d=r[e-i.length];if(!d)return null;const u=l.get(d)||s.get(d);return!u||"User"!==u.kind&&"Contact"!==u.kind?null:n.createElement(R,{style:t,peer:u,onSelect:o})})),R=({style:e,peer:t,onSelect:s})=>{const o=(0,a.useLastSeen)(t.id);return n.createElement("li",{className:"ContactList__itemWrapper",key:t.id,style:e},n.createElement("div",{className:"ContactList__item",onClick:()=>s(t.id),onKeyDown:(0,w.onElementKeyDownFactory)(((e,n)=>{"Enter"===e&&(n(),s(t.id))})),tabIndex:0,role:"tab"},n.createElement("div",{className:"ContactList__avatar"},n.createElement(r.Avatar,{peer:t,size:40,withBirthday:!0})),n.createElement("div",null,n.createElement("div",{className:"ContactList__name"},l.name(t)),o?n.createElement(g.OnlineStatus,{user:t,className:"ContactList__info"}):t.phone?n.createElement(v.FormattedPhoneNumber,{phone:t.phone,className:"ContactList__info"}):null)))}},337400:(e,t,s)=>{"use strict";s.d(t,{ConvoPicker:()=>y});var n=s(11010),r=s(667294),a=s(696023),o=s(954811),i=s(96190),c=s(185327),l=s(821551),d=s(519478),u=s(4738),h=s(827258),m=(s(988426),s(294184)),p=s.n(m),f=s(991792),g=s(955625),v=s(89131),_=s(95154);const C=[],y=({filter:e="all",selectedPeerIds:t=C,initialQuery:s="",onQueryChange:m,onSelectionChange:y,strategy:k="singular",searchRenderer:I=d.PeerChipsSearchInput,listRenderer:E=u.PeerPickerList,listFilter:b,className:w,withFavorites:M=!1})=>{const{api:S}=(0,a.useBrowserEnv)(),R=(0,a.useDispatch)(),A=(0,a.useInsertIntoCache)(),P=(0,a.useConvosSearchIndex)(),F=(0,a.useOwner)(),U=(0,a.useConvos)(),N=(0,a.useOrganisers)(),{selectedOrganiser:T,convos:x,setSelectedOrganiser:O,hasMore:L}=(0,g.useConvoOrganiser)(N,U,{kind:"filters",filter:e},"all"),q=(0,r.useMemo)((()=>(x||[]).map((e=>e.peerId))),[x]),[B,D]=(0,r.useState)(q),[z,H]=(0,r.useState)(!1),[G,V]=(0,r.useState)(!1),[W,K]=(0,r.useState)(null),j=(0,r.useRef)(null),[Z,$]=(0,r.useState)(s),Q=!!Z;(0,r.useEffect)((()=>{var e;null==(e=m)||e(Z)}),[m,Z]);const X=(0,r.useCallback)((e=>Array.from(l.search(P,e).values())),[P]);(0,r.useEffect)((()=>{O({kind:"filters",filter:e})}),[O,e]);const J=(0,r.useCallback)((e=>{const t=new Map;return e.forEach((e=>{t.set(e.toString(),{kind:"peer",peerId:e})})),t}),[]),[Y,ee]=(0,r.useState)(J(t)),te=e=>{const t=Array.from(e.values()),s=[];for(let e=0;e<t.length;e+=1){var n;const r=t[e];"peer"===(null==(n=r)?void 0:n.kind)&&s.push(r.peerId)}return s};(0,r.useEffect)((()=>{var e;const s=te(Y);s.length===(null==(e=t)?void 0:e.length)&&s.every((e=>t.includes(e)))||ee(J(t))}),[t,J]);const se=(0,r.useMemo)((()=>(0,v.debounce)((0,n._)((function*(e){try{H(!0),V(!1);const t=yield S.fetch("messages.searchConversations",{q:e,count:_.SEARCH_CONVOS_COUNT,extended:1,group_id:(0,f.getOwnerGroupId)(F.id)});if(j.current!==e)return;const s=t.count,n=t.items,r=t.profiles||[],a=t.groups||[],i=t.contacts||[];A({profiles:r,groups:a,conversations:n,contacts:i});const c=[];n.forEach((e=>{var t;const s=(0,o.fromApiConvo)(e);(null==(t=s)?void 0:t.convo.peerId)&&c.push(s.convo.peerId)})),D((e=>{const t=e.slice();return c.forEach((e=>{t.includes(e)||t.push(e)})),t})),K(s),H(!1)}catch(e){V(!0),H(!1)}})),300,!1)),[H,D,K,S,A,F.id]);(0,r.useEffect)((()=>()=>{se.cancel()}),[]),(0,r.useEffect)((()=>{Q||(D(q),H(L))}),[Q,q,L,D,H]);(0,r.useEffect)((()=>{y(te(Y))}),[Y]);const ne=(0,r.useMemo)((()=>{let t=B;M&&!Q&&(t=t.filter((e=>!i.isFavorites(e,F.id))),t.unshift(F.id)),(b||"chats"===e)&&(t=t.filter((t=>{const s=c.safeGet(U,t);return!(b&&!b(s))&&!("chats"===e&&!i.isChatPeerId(t))})));return t.map((e=>({kind:"peer",peerId:e})))}),[B,M,Q,b,e,F.id,U]),re=(0,r.useMemo)((()=>Q?null===W?null:ne.length:L?null:ne.length),[Q,L,ne,W]),ae=(0,n._)((function*({query:e,offset:t,count:s}){if(V(!1),j.current=e,!Q&&e&&K(null),e)se(e);else{const e=t+s;ne.length<=e&&R({type:"MoreConvosNeeded",organiser:T})}}));return r.createElement(h.Picker,{items:ne,total:re,isLoading:z,hasFailed:G,onSelectionChange:e=>{ee(e)},getItemId:function(e){switch(e.kind){case"peer":return e.peerId.toString();case"template":return e.id;default:return(0,v.exhaustivenessCheck)(e)}},search:ae,prefetch:({query:e})=>{if(!e)return;const t=X(e);D(t),0===t.length&&H(!0)},initialQuery:s,selection:Y,listRenderer:E,searchRenderer:I,strategy:k,onQueryChange:$,className:p()("vkmConvoPicker",w)})}},661059:(e,t,s)=>{"use strict";s.d(t,{ConvoTitle:()=>g});s(774996);var n=s(667294),r=s(397662),a=s(354819),o=s(96715),i=s(277937),c=s(998901),l=s(96190),d=s(709646),u=s(294184),h=s.n(u),m=s(696023),p=s(814977),f=s(943997);const g=n.memo((function({peer:e,isMuted:t,isCasper:s,isShortened:u=!1,isMultiline:g=!1,showEmployeeMark:v=!1,className:_,isForbidedWritingForAll:C}){const{lang:y}=(0,m.useBrowserEnv)(),k=(0,m.useOwner)(),I=(0,m.useViewer)(),E=d.isEdu(I.profileType),b=!l.isFavorites(e.id,k.id)&&"User"===e.kind&&l.isEmployee(e),w=u?l.firstName(e):l.name(e),M=l.isFavorites(e.id,k.id)?y.use("me_favorites"):w,S=h()("ConvoTitle",_,{"ConvoTitle--singleLine":!g,"ConvoTitle--multiLine":g}),R=n.createElement(n.Fragment,null,v&&b?n.createElement(f.Tooltip,{align:"left",content:y.use("me_employees_vk_employee"),delay:1e3,position:"bottom"},n.createElement("span",{className:"ConvoTitle__icon ConvoTitle__employeeIcon"},n.createElement(r.Icon16LogoVk,null))):null,"Chat"!==e.kind&&"Contact"!==e.kind&&e.isVerified?n.createElement("span",{className:"ConvoTitle__icon ConvoTitle__verifiedIcon"},E&&"User"===e.kind?n.createElement(a.Icon16Education,null):n.createElement(o.Icon16Verified,null)):null,s&&n.createElement(p.CasperIcon,{className:"ConvoTitle__icon"}),C&&n.createElement("span",{className:"ConvoTitle__icon ConvoTitle__forbidedWritingIcon"},n.createElement(i.Icon16MessageCross,null)),t&&n.createElement("span",{className:"ConvoTitle__icon ConvoTitle__mutedIcon"},n.createElement(c.Icon16Muted,{"aria-hidden":!1,"aria-label":y.use("me_convo_title_muted")})));return n.createElement("div",{className:S},g?n.createElement("header",{className:"ConvoTitle__title","aria-label":y.use("me_convo_title_name")},M,R):n.createElement(n.Fragment,null,n.createElement("header",{className:"ConvoTitle__title","aria-label":y.use("me_convo_title_name")},M),R))}))},143573:(e,t,s)=>{"use strict";s.d(t,{CopyText:()=>r});s(215334);var n=s(667294);const r=({text:e,onCopyDone:t,children:s,ariaLabel:r})=>{const a=(0,n.useRef)(null),o=(0,n.useCallback)((s=>{function n(){if(a.current){const e=document.activeElement;a.current.focus(),a.current.select(),document.execCommand("copy"),e instanceof HTMLElement&&e.focus(),t&&t()}}s.preventDefault(),s.stopPropagation(),navigator.clipboard.writeText?navigator.clipboard.writeText(e).then((()=>{t&&t()})).catch(n):n()}),[t,e]);return n.createElement("div",{className:"CopyText",onClick:o,tabIndex:0,role:"button","aria-label":r},n.createElement("input",{tabIndex:-1,"aria-hidden":!0,type:"text",readOnly:!0,value:e||"",ref:a,className:"CopyText__input"}),s)}},337270:(e,t,s)=>{"use strict";s.d(t,{Emoji:()=>l});s(709639);var n=s(667294),r=s(331092),a=s(294184),o=s.n(a),i=s(127848),c=s(15285);const l=({emoji:e})=>{const[t,s]=(0,n.useState)(!0),a=(0,n.useRef)(null);return(0,n.useLayoutEffect)((()=>{if(!a.current)return;const t=(0,i.getEmojiSupportFromCache)(e),n="unknown"!==t?"supported"===t:(0,i.checkEmojiSupportViaCss)(a.current);s(n)}),[e]),t?n.createElement("img",{src:c.emptyImage,alt:e,className:o()("Emoji","@"+(0,r.unicodeToByteHex)(e)),onError:()=>s(!1),ref:a}):n.createElement(n.Fragment,null,e)}},920582:(e,t,s)=>{"use strict";s.d(t,{FieldGroup:()=>c,FieldGroupItem:()=>l});var n=s(434788),r=s(820224),a=(s(167509),s(667294)),o=s(86894),i=s(421199);const c=({title:e,children:t})=>{const s=(0,i.useUniqId)();return a.createElement(o.Group,{"aria-labelledby":s,className:"FieldGroup",mode:"card",padding:"m",header:e?a.createElement(o.Header,{mode:"secondary"},e):null},t)},l=e=>{var{children:t,hasHover:s=!1,hasActive:i=!1,multiline:c=!0}=e,l=(0,r._)(e,["children","hasHover","hasActive","multiline"]);return a.createElement(o.SimpleCell,(0,n._)({},l,{hasHover:s,hasActive:i,multiline:c}),t)}},936902:(e,t,s)=>{"use strict";s.d(t,{FolderAddButton:()=>i});var n=s(407729),r=s(667294),a=(s(554410),s(920582)),o=s(86894);const i=({children:e,icon:t=r.createElement(n.Icon24Add,{fill:"var(--vkui--color_icon_accent)"}),onClick:s})=>r.createElement(a.FieldGroupItem,{hasActive:!0,hasHover:!0,before:t&&r.createElement(o.Avatar,{size:40,withBorder:!1,fallbackIcon:t,"aria-hidden":"true"}),onClick:s},r.createElement("span",{className:"FolderAddButton__text"},e))},228053:(e,t,s)=>{"use strict";s.d(t,{FolderAvatar:()=>l,getFolderIcon:()=>d});var n=s(667294),r=s(661620),a=s(294184),o=s.n(a),i=(s(518617),s(337270)),c=s(468336);const l=({name:e,size:t=40,variant:s="light",counter:a,defaultIcon:i=n.createElement(r.Icon20FolderOutline,null),style:c})=>{var l;return n.createElement("span",{className:o()("FolderAvatar",`FolderAvatar--size-${t}`,`FolderAvatar--variant-${s}`),style:c},a&&n.createElement("span",{className:"FolderAvatar__counter"},a),n.createElement("span",{className:"FolderAvatar__icon"},null!=(l=d(e))?l:i))};function d(e){const t=(0,c.getFirstEmojiFromString)(e);return t?n.createElement(i.Emoji,{emoji:t}):null}},679638:(e,t,s)=>{"use strict";s.d(t,{FolderConvoListRow:()=>h});var n=s(667294),r=s(185327),a=s(96190),o=s(550946),i=s(696023),c=s(661059),l=s(282384),d=s(377291),u=s(936890);const h=({convo:e,showCheckbox:t,checkbox:s,before:h,after:m,onClick:p})=>{const f=(0,i.usePeers)(),g=(0,i.useOwner)(),{lang:v}=(0,i.useBrowserEnv)(),_=a.safeGet(f,e.peerId),C=a.isFavorites(_.id,g.id),y="ChatConvo"===e.kind&&e.activeCall?e.activeCall.participants.count>0?"filled":"empty":void 0;return n.createElement(o.FolderListRow,{showCheckbox:t,checkbox:s,before:h,after:m,onClick:p,title:n.createElement(c.ConvoTitle,{peer:_,isMuted:r.isMuted(e),isCasper:r.isCasper(e)}),subtitle:n.createElement(n.Fragment,null,("User"===_.kind||"Contact"===_.kind)&&!C&&n.createElement(l.OnlineStatus,{className:"ConvoHeader__online",user:_}),"ChatConvo"===e.kind&&"in"===e.state&&v.use("me_group_members_count",{num:e.membersCount,formatted:"short"})),avatar:C?n.createElement(d.AvatarFavorites,{size:40}):n.createElement(u.Avatar,{peer:_,size:40,withOnline:!0,activeCall:y,withBirthday:!0})})}},15475:(e,t,s)=>{"use strict";s.d(t,{FolderForm:()=>y});var n=s(434788),r=s(820224),a=s(667294),o=s(999504),i=s(185327),c=(s(420526),s(679638)),l=s(696023),d=s(936902),u=s(126528),h=s(86894),m=s(315954),p=s(943997),f=s(294184),g=s.n(f),v=s(532048),_=s(988994),C=s(468336);const y=({name:e,folderId:t,peerIds:s,folders:n,convosCache:r,autoNameFocus:f=!0,onNameChange:y,onAddClick:I,onValidChange:E,onDeleteItem:b})=>{const w=(0,l.useDispatch)(),{lang:M}=(0,l.useBrowserEnv)(),S=(0,_.useLayoutData)(),R=n.find((e=>e.id===t)),A=(0,a.useRef)(null),[P,F]=(0,a.useState)(!1),U=(0,a.useCallback)((e=>{const t=(0,C.getLengthWithEmoji)(e);y(e),F(t>o.FOLDER_NAME_LIMIT)}),[y]),N=(0,a.useCallback)((e=>{const t=e.target.value;U(t)}),[U]),T=(0,a.useMemo)((()=>s.map((e=>i.safeGet(r,e)))),[r,s]),x=e.trim().length>0&&!P&&T.length>0;return(0,a.useEffect)((()=>{var e;null==(e=E)||e(x)}),[x,E]),(0,a.useEffect)((()=>{U(e),A.current&&f&&A.current.focus()}),[]),a.createElement("div",{className:"FolderForm"},a.createElement(h.FormLayout,null,a.createElement(h.FormItem,{top:a.createElement("div",{className:"FolderForm__nameTitle"},M.use("me_folders_form_name_label")),className:"FolderForm__row",status:P?"error":"default",bottom:P?M.use("me_folders_form_name_error_limit"):M.use("me_folders_form_name_limit")},a.createElement(k,{type:"text",ref:A,placeholder:M.use("me_folders_form_name_placeholder"),value:e,onChange:N})),a.createElement(h.FormItem,{top:M.use("me_folders_form_convos_label"),className:"FolderForm__row"},a.createElement("div",{className:"FolderForm__convosWrapper"},a.createElement(v.ScrollbarProvider,{overflowX:"hidden",className:g()({"FolderForm__convosWrapper--twoColumn":"two-column"===S.mode})},a.createElement("ul",{className:"FolderForm__convosList"},a.createElement("li",null,a.createElement(d.FolderAddButton,{onClick:I},M.use("me_folders_form_convos_action_change"))),T.map((e=>a.createElement("li",{key:e.peerId},a.createElement(c.FolderConvoListRow,{convo:e,after:b&&a.createElement(p.Tooltip,{content:M.use("me_folders_form_convo_remove_tooltip")},a.createElement("button",{type:"button","aria-label":M.use("me_folders_form_convo_remove_tooltip"),className:"FolderForm__deleteBtn",onClick:()=>b(e.peerId)},a.createElement(m.Icon24Cancel,null)))})))),R&&R.all.hasMore&&a.createElement("li",{className:"FolderForm__loader"},a.createElement(u.OptimizedSpinner,{onIntersection:()=>w({type:"MoreConvosNeeded",organiser:{kind:"folders",id:R.id,filter:"all"}})}))))))))},k=(0,a.forwardRef)(((e,t)=>{var{before:s,after:o,status:i="default",onFocus:c,onBlur:l}=e,d=(0,r._)(e,["before","after","status","onFocus","onBlur"]);const[u,h]=(0,a.useState)(!1),m=(0,a.useCallback)((e=>{var t;null==(t=c)||t(e),h(!0)}),[c]),p=(0,a.useCallback)((e=>{var t;null==(t=l)||t(e),h(!1)}),[l]);return a.createElement("label",{className:g()("FolderForm__input",`FolderForm__input--${i}`,{"FolderForm__input--focus":u})},s&&a.createElement("span",{className:"FolderForm__input-before"},s),a.createElement("input",(0,n._)({ref:t,onFocus:m,onBlur:p},d,{className:"FolderForm__inputControl"})),o&&a.createElement("span",null,o))}))},550946:(e,t,s)=>{"use strict";s.d(t,{FolderListRow:()=>c});var n=s(667294),r=s(294184),a=s.n(r),o=(s(589648),s(690839)),i=s(299715);const c=({title:e,subtitle:t,avatar:s,onClick:r,before:c,after:l,showCheckbox:d,checkbox:u=!1})=>{const h=r?"button":"div";return n.createElement(h,{className:a()("FolderListRow",{"FolderListRow--clickable":Boolean(r)}),onClick:r},c&&n.createElement("span",{className:"FolderListRow__before"},c),d&&n.createElement("span",{className:a()("FolderListRow__checkbox",{"FolderListRow__checkbox--active":u})},u?n.createElement(o.Icon24CheckCircleOn,null):n.createElement(i.Icon24CheckCircleOff,null)),s&&n.createElement("span",{className:"FolderListRow__avatar"},s),n.createElement("span",{className:"FolderListRow__content"},n.createElement("span",{className:"FolderListRow__title"},e),t&&n.createElement("span",{className:"FolderListRow__sub-title"},t)),l&&n.createElement("span",{className:"FolderListRow__after"},l))}},657536:(e,t,s)=>{"use strict";s.d(t,{FoldersRecommended:()=>l});var n=s(667294),r=s(696023),a=s(86894),o=s(953783),i=s(920582),c=s(87299);const l=({isLoading:e,isCreating:t,folders:s,recommendedFolders:l,onCreate:d})=>{const u=(0,r.useDispatch)(),{lang:h}=(0,r.useBrowserEnv)(),[m,p]=(0,n.useState)(),f=(0,n.useCallback)((e=>{p(e.type),u({type:"UserCreatedFolder",name:e.name,folderType:e.type,peerIds:[]})}),[u]);(0,n.useEffect)((()=>{u({type:"LoadRecommendedFolders"})}),[u]),(0,n.useEffect)((()=>{const e=m?s.find((e=>e.type===m)):void 0;e&&m&&!t&&(d(e.id),p(void 0))}),[m,t,d,s]);const g=(0,n.useMemo)((()=>l.filter((e=>!e.isHidden&&!s.find((t=>t.type===e.type))))),[s,l]);return g.length||e?n.createElement(i.FieldGroup,{title:h.use("me_recommendations")},e?n.createElement(c.FoldersViewSettingsSkeleton,{mode:"horizontal",blinking:!0,itemsOnly:!0}):g.map((e=>n.createElement(i.FieldGroupItem,{key:e.type,before:n.createElement(a.Avatar,{withBorder:!1,size:40,fallbackIcon:n.createElement(o.Icon24FolderOutline,null)}),after:n.createElement(a.Button,{size:"s",mode:"secondary",appearance:"accent",disabled:t,loading:e.type===m,onClick:()=>f(e)},h.use("me_add"))},e.name)))):null}},157501:(e,t,s)=>{"use strict";s.d(t,{FoldersSettings:()=>R});var n=s(434788),r=s(233699),a=s(953783),o=s(483704),i=s(86894),c=s(999504),l=s(185327),d=s(667294),u=s(266864),h=(s(809206),s(410519)),m=s(696023),p=s(228053),f=s(337400),g=s(15475),v=s(740779),_=s(294184),C=s.n(_),y=s(936902),k=s(689494),I=s(519478),E=s(248758),b=s(920582),w=s(988994),M=s(40803),S=s(657536);const R=({folders:e,recommendedFolders:t,locks:s,convos:n,foldersView:r})=>{var a,o,c;const{lang:l}=(0,m.useBrowserEnv)(),p=(0,w.useLayoutData)(),f=(0,m.useFeatureFlags)(),v=(0,h.useModalGroup)(),_=(0,h.useModal)(v.id),C=(0,h.useModal)(v.id),y=(0,h.useModal)(v.id),k=(0,h.useModal)(v.id),I=(0,m.useDispatch)(),M=s.newFolder,R=(0,m.usePrevious)(M),[F,N]=(0,d.useState)(new Set),[T,x]=(0,d.useState)(new Set),[O,L]=(0,d.useState)(""),[q,B]=(0,d.useState)(!1),[D,z]=(0,d.useState)(null),H=(0,d.useCallback)((e=>{z(e),N(new Set),x(new Set),L(""),B(!1)}),[]),G=(0,d.useMemo)((()=>e.find((e=>e.id===D))),[e,D]),V=(0,d.useCallback)((()=>{I({type:"UserCreatedFolder",name:O,folderType:"default",peerIds:Array.from(F)})}),[F,I,O]),W=(0,d.useCallback)((()=>{var e;(null==(e=G)?void 0:e.id)&&I({type:"UserUpdatedFolder",folderId:G.id,name:O,addPeerIds:F,removePeerIds:T}),C.close(),H(null)}),[F,C,I,O,T,null==(a=G)?void 0:a.id,H]);(0,d.useEffect)((()=>{!M&&R&&(_.isActive&&_.close(),H(null))}),[M,_,R,H]),(0,d.useLayoutEffect)((()=>{var e,t;L(null!=(t=null==(e=G)?void 0:e.name)?t:"")}),[G]);const K=(0,d.useCallback)((e=>{H(e),C.open()}),[C,H]),j=(0,d.useCallback)((()=>{null!==D&&(I({type:"UserDeletedFolder",folderId:D}),k.close(),C.close(),H(null))}),[I,H,D,k,C]),Z=(0,d.useCallback)((e=>{F.delete(e)?N(new Set([...F])):x(new Set([...T,e]))}),[F,T]),$=(0,d.useCallback)((()=>{_.close(),H(null)}),[_.close,H]),Q=(0,d.useCallback)((()=>{C.close(),H(null)}),[C.close,H]),X=(0,d.useCallback)((e=>{var t;const s=e.filter((e=>{var t;return!(null==(t=G)?void 0:t.all.peerIds.has(e))}));var n;const r=Array.from(null!=(n=null==(t=G)?void 0:t.all.peerIds)?n:[]).filter((t=>!e.includes(t)));F.forEach((t=>{e.includes(t)||F.delete(t)})),T.forEach((t=>{e.includes(t)&&T.delete(t)})),N(new Set([...F,...s])),x(new Set([...T,...r])),y.close()}),[F,y.close,T,null==(o=G)?void 0:o.all.peerIds]),J=(0,d.useMemo)((()=>{var e,t;return[...null!=(t=null==(e=G)?void 0:e.all.peerIds)?t:new Set,...F].filter((e=>!T.has(e)))}),[F,T,null==(c=G)?void 0:c.all.peerIds]);return d.createElement(d.Fragment,null,"one-column"!==p.mode&&"auto"===r&&d.createElement(b.FieldGroup,{title:l.use("me_folders_view_settings_title")},d.createElement(E.FoldersViewSettings,null)),d.createElement(b.FieldGroup,{title:l.use("me_folders_title")},e.length?d.createElement(P,{isCompact:!0,folders:e,isReorderEnabled:!s.reorderFolders,onFolderClick:K,onAddClick:_.open}):d.createElement(A,{onAddClick:_.open})),f.vkm_recommended_folders?d.createElement(S.FoldersRecommended,{folders:e,recommendedFolders:t,isCreating:M,isLoading:s.loadRecommendedFolders,onCreate:K}):null,_.isActive&&d.createElement(u.ModalInterface,{title:l.use("me_folder_create"),onClose:$,closeLabel:l.use("me_close"),backLabel:l.use("me_back"),contextClass:"MEConfig",withCustomLayout:!0,buttons:d.createElement(i.Button,{mode:"primary",onClick:V,disabled:q,loading:M},l.use("me_complete"))},d.createElement("div",{className:"FoldersSettings__form"},d.createElement(g.FolderForm,{name:O,peerIds:J,onNameChange:L,onAddClick:y.open,convosCache:n,folders:e,autoNameFocus:"two-column"===p.mode,onDeleteItem:Z,onValidChange:e=>B(!e)}))),C.isActive&&G&&d.createElement(u.ModalInterface,{title:l.use("me_folder_update"),onClose:Q,closeLabel:l.use("me_close"),backLabel:l.use("me_back"),contextClass:"MEConfig",withCustomLayout:!0,buttons:[d.createElement(i.Button,{key:"delete",mode:"tertiary",hasHover:!1,onClick:k.open,className:"FoldersSettings__deleteBtn"},l.use("me_folder_delete_action")),d.createElement(i.Button,{key:"save",mode:"primary",onClick:W,disabled:q,loading:s.updateFolder.has(G.id)},l.use("me_complete"))]},d.createElement("div",{className:"FoldersSettings__form"},d.createElement(g.FolderForm,{folderId:G.id,name:O,peerIds:J,onNameChange:L,onAddClick:y.open,convosCache:n,folders:e,autoNameFocus:"two-column"===p.mode,onDeleteItem:Z,onValidChange:e=>B(!e)}))),y.isActive&&d.createElement(U,{initialPeerIds:J,showChips:null===D,onClose:y.close,onBack:y.close,onSubmit:X}),k.isActive&&G&&d.createElement(u.ModalInterface,{title:l.use("me_folder_delete_confirmation_modal_title"),onClose:k.close,closeLabel:l.use("me_close"),contextClass:"MEConfig",buttons:[d.createElement(i.Button,{key:"cancel",onClick:k.close,mode:"tertiary"},l.use("me_cancel")),d.createElement(i.Button,{key:"delete",onClick:j,mode:"primary"},l.use("me_folder_action_delete"))]},d.createElement("div",{className:"FoldersSettings__delete"},l.use("me_folder_delete_confirmation_modal_text",{values:{name:G.name}}))))},A=({onAddClick:e})=>{const{lang:t}=(0,m.useBrowserEnv)();return d.createElement("div",{className:"FoldersSettings__empty"},d.createElement(r.Icon56FolderPlusBadgeOutline,{className:"FoldersSettings__emptyIcon","aria-label":t.use("me_folder_list_modal_empty_icon_tooltip")}),d.createElement("p",{className:"FoldersSettings__emptyText"},t.use("me_folder_list_modal_empty")),d.createElement("div",{className:"FoldersSettings__emptyActions"},d.createElement(i.Button,{mode:"primary",onClick:e},t.use("me_folder_list_modal_empty_action_add"))))},P=({folders:e,isReorderEnabled:t,isCompact:s,onFolderClick:n,onAddClick:r})=>{const{lang:a}=(0,m.useBrowserEnv)(),o=(0,m.useDispatch)(),i=(0,d.useMemo)((()=>e.map((e=>e.id))),[e]);return d.createElement("div",{className:C()("FoldersSettings__list",{"FoldersSettings__list--compact":s})},d.createElement(y.FolderAddButton,{onClick:r},a.use("me_folder_list_modal_action_add")),d.createElement(v.SortableList,{items:i,onChange:e=>{o({type:"UserReorderedFolders",order:e.map((e=>c.resolveId(e)))})},disabled:!t},e.map((e=>d.createElement(F,{key:e.id,folder:e,onClick:n})))))},F=({folder:e,onClick:t})=>{const{active:s,isDragging:r,attrs:c,styles:l,setNodeRef:u,onMove:h,onStart:m,onEnd:f}=(0,v.useSortable)({id:e.id,lockAxis:"y"}),g=(0,d.useCallback)((()=>{t(e.id)}),[e.id,t]);var _;return d.createElement("div",(0,n._)({ref:u,style:l},c),d.createElement(b.FieldGroupItem,{hasActive:!0,hasHover:!0,className:C()("FoldersSettings__folder",{"FoldersSettings__folder--dragging":s,"FoldersSettings__folder--noHover":!s&&r}),onClick:g,before:d.createElement(i.Avatar,{withBorder:!1,size:40,fallbackIcon:null!=(_=(0,p.getFolderIcon)(e.name))?_:d.createElement(a.Icon24FolderOutline,null)}),after:d.createElement(i.Touch,{Component:"span",onStart:m,onEnd:f,onMove:h},d.createElement(o.Icon24DotsVertical,{fill:"var(--vkui--color_icon_secondary)"}))},d.createElement(M.TextWithEmoji,{text:e.name})))},U=({initialPeerIds:e,showChips:t,onClose:s,onBack:n,onSubmit:r})=>{const[a,o]=(0,d.useState)(e),{lang:c}=(0,m.useBrowserEnv)();return d.createElement(u.ModalInterface,{title:c.use("me_folder_convo_select_title"),onClose:s,closeLabel:c.use("me_close"),onBack:n,backLabel:c.use("me_back"),withCustomLayout:!0,contextClass:"MEConfig",buttons:[d.createElement(i.Button,{key:"confirm",onClick:()=>r(a),disabled:0===a.length},c.use("me_folder_convo_select_confirm"))]},d.createElement("div",{className:"FoldersSettings__convoPicker"},d.createElement(f.ConvoPicker,{searchRenderer:t?I.PeerChipsSearchInput:k.PickerSearchInput,selectedPeerIds:a,onSelectionChange:e=>o(e),strategy:"multiple",listFilter:l.canAddToFolder})))}},248758:(e,t,s)=>{"use strict";s.d(t,{FoldersViewSettings:()=>c});s(891695);var n=s(667294),r=s(294184),a=s.n(r),o=s(696023),i=s(87299);const c=()=>{const{settings:e}=(0,o.useViewer)(),t=(0,o.useDispatch)(),{lang:s}=(0,o.useBrowserEnv)(),r=e=>{t({type:"UserChangedSetting",setting:"verticalFoldersView",value:"vertical"===e})};return n.createElement("div",{className:"FoldersViewSettings__variants",role:"radiogroup","aria-label":s.use("me_folders_view_settings_title")},n.createElement("button",{className:a()("FoldersViewSettings__variant",{"FoldersViewSettings__variant--active":!e.verticalFoldersView}),onClick:()=>r("horizontal"),role:"radio","aria-checked":!e.verticalFoldersView,"aria-label":s.use("me_folders_view_settings_horizontal")},n.createElement("div",{className:"FoldersViewSettings__variantSkeleton"},n.createElement(i.FoldersViewSettingsSkeleton,{mode:"horizontal"})),n.createElement("div",{className:"FoldersViewSettings__variantTitle"},s.use("me_folders_view_settings_horizontal"))),n.createElement("button",{className:a()("FoldersViewSettings__variant",{"FoldersViewSettings__variant--active":e.verticalFoldersView}),onClick:()=>r("vertical"),role:"radio","aria-checked":e.verticalFoldersView,"aria-label":s.use("me_folders_view_settings_vertical")},n.createElement("div",{className:"FoldersViewSettings__variantSkeleton"},n.createElement(i.FoldersViewSettingsSkeleton,{mode:"vertical"})),n.createElement("div",{className:"FoldersViewSettings__variantTitle"},s.use("me_folders_view_settings_vertical"))))}},87299:(e,t,s)=>{"use strict";s.d(t,{FoldersViewSettingsSkeleton:()=>a});s(150637);var n=s(667294),r=s(86894);const a=({mode:e,itemsOnly:t=!1,blinking:s=!1})=>{const a=(0,r.useAppearance)(),i=[...Array("vertical"===e?2:1)],c=[...Array("vertical"===e?2:3)],l="vertical"===e?86:146,d="vertical"===e?56:82;return n.createElement("div",{className:(0,r.classNames)("FoldersViewSettingsSkeleton",`FoldersViewSettingsSkeleton--${a}`,`FoldersViewSettingsSkeleton--${e}`,{"FoldersViewSettingsSkeleton--blinking":s})},t?null:n.createElement("div",{className:"FoldersViewSettingsSkeleton__folders"},c.map(((t,s)=>n.createElement(o,{key:s,width:32,height:"vertical"===e?32:8,bg:"vkui--color_background_accent"})))),n.createElement("div",{className:"FoldersViewSettingsSkeleton__items"},i.map(((e,t)=>n.createElement("div",{className:"FoldersViewSettingsSkeleton__item",key:t},n.createElement("div",{className:"FoldersViewSettingsSkeleton__itemAvatar"},n.createElement(o,{width:40,height:40})),n.createElement("div",{className:"FoldersViewSettingsSkeleton__itemContent"},n.createElement(o,{width:l,height:8}),n.createElement(o,{width:d,height:8})))))))},o=({width:e,height:t,bg:s})=>n.createElement("div",{className:"FoldersViewSettingsSkeleton__row",style:{width:`${e}px`,height:`${t}px`,background:s?`var(--${s})`:void 0,borderRadius:`${t}px`}})},67091:(e,t,s)=>{"use strict";s.d(t,{FormattedPhoneNumber:()=>a});var n=s(667294),r=s(15285);const a=({phone:e,className:t})=>{const[s,a]=(0,n.useState)(e);return(0,n.useEffect)((()=>{(0,r.formatPhoneNumber)(e).then((e=>a(e.international))).catch((()=>a(e)))}),[e]),n.createElement("div",{className:t},null!=s?s:e)}},53763:(e,t,s)=>{"use strict";s.d(t,{IconNote:()=>r});var n=s(667294);s(784256);const r=({icon:e,actions:t,children:s})=>n.createElement("div",{className:"IconNote"},e&&n.createElement("div",{className:"IconNote__icon"},e),n.createElement("div",{className:"IconNote__content"},s),t&&n.createElement("div",{className:"IconNote__actions"},t))},444831:(e,t,s)=>{"use strict";s.d(t,{ImportContactModal:()=>i});var n=s(667294),r=s(410519),a=s(379656),o=s(210770);s(928910);const i=({onClose:e})=>{const t=(0,r.useModalGroup)(),s=(0,r.useModal)(t.id),i=(0,r.useModal)(t.id),[c,l]=(0,n.useState)(null),[d,u]=(0,n.useState)({name:"",surname:"",phone:""});return(0,n.useLayoutEffect)((()=>(s.open(),()=>{t.closeGroup()})),[]),n.createElement(n.Fragment,null,s.isActive&&n.createElement(a.InputContactModal,{initialData:d,openInviteModal:i.open,onClose:e,setContactPhone:l,onFromChange:u}),i.isActive&&c&&n.createElement(o.InviteContactModal,{contactPhone:c,onClose:e,onBack:i.close}))}},379656:(e,t,s)=>{"use strict";s.d(t,{InputContactModal:()=>_});var n=s(11010),r=s(434788),a=s(667294),o=s(86894),i=s(294184),c=s.n(i),l=s(89131),d=s(96190),u=s(696023),h=s(364705),m=s(988994),p=s(276351),f=s(266864),g=(s(522283),s(435683));const v=e=>({status:"default",value:null!=e?e:""}),_=({initialData:e,onFromChange:t,onClose:s,openInviteModal:i,setContactPhone:c})=>{const{lang:m}=(0,u.useBrowserEnv)(),{navigate:_}=(0,h.useRouter)(),{isLoading:y,importContact:k}=(0,p.useImportContact)(),[I,E]=(0,a.useState)(e?(e=>({phone:v(e.phone),name:v(e.name),surname:v(e.surname)}))(e):{phone:v(),name:v(),surname:v()}),b=(0,u.useDispatch)(),w=(0,a.useMemo)((()=>!(I.phone.value&&I.name.value.trim())),[I.name.value,I.phone.value]),{isReady:M,format:S}=(0,g.useFormatPhoneNumber)(),R=(0,a.useCallback)(((e,t)=>{E((s=>{const n=(0,r._)({},s);return n[e]=t,n}))}),[]),A=(0,a.useCallback)((0,n._)((function*(e){const t=e.target.name;var s;if(s=t,["phone","name","surname"].some((e=>s===e))&&M)if("phone"===t){const s=S(e.target.value);R(t,{status:"default",value:s})}else R(t,{status:"default",value:e.target.value.trim()})})),[S,M,R]),P=(0,a.useCallback)((0,n._)((function*(){const e=I.phone.value,t=I.name.value,n=I.surname.value;if(!(0,l.isValidPhoneNumber)(e))return R("phone",{status:"error",value:e});if(0===t.length)return R("name",{status:"error",value:t});const r=yield k({phone:e,name:t,surname:n});var a;r.hasFailed?(c(e),i()):(b({type:"ImportContact",profile:r.profile,contact:r.contact}),_({kind:"ConvoRoute",peerId:(null==(a=r.profile)?void 0:a.id)?d.resolveRealId("User",r.profile.id):d.resolveRealId("Contact",r.contact.id),entrypoint:"contacts_list"}),s())})),[b,I.name.value,I.phone.value,I.surname.value,k,_,s,i,c,R]),F=y||!M;return(0,a.useEffect)((()=>{var e;const s={name:I.name.value,surname:I.surname.value,phone:I.phone.value};null==(e=t)||e(s)}),[I,t]),a.createElement(f.ModalInterface,{title:m.use("me_contacts_import_modal_title"),closeLabel:m.use("me_close"),onClose:s,buttons:a.createElement(o.Button,{disabled:w,loading:F,mode:"primary",onClick:P},m.use("me_contacts_import_add_button")),contextClass:"MEConfig",withCustomLayout:!0},a.createElement(C,{formItems:I,onFormItemChange:A,onSubmit:P}))},C=({formItems:e,onFormItemChange:t,onSubmit:s})=>{const{mode:n}=(0,m.useLayoutData)(),r="one-column"===n,{lang:i}=(0,u.useBrowserEnv)(),l=(0,a.useRef)(null);return(0,a.useEffect)((()=>{l.current&&l.current.focus()}),[]),a.createElement(o.FormLayout,{className:c()("ImportContactModal",{"ImportContactModal--fullScreen":r}),onSubmit:e=>{e.preventDefault(),s()}},a.createElement(o.FormItem,{top:a.createElement(a.Fragment,null,i.use("me_contacts_import_modal_phone_input")," ",a.createElement("span",{className:"InputContactModal__requiredSymbol"},"*")),status:e.phone.status},a.createElement(o.Input,{getRef:l,type:"tel",maxLength:250,autoComplete:"tel",name:"phone",value:e.phone.value,onChange:t,placeholder:i.use("me_contacts_import_tel_placeholder"),required:!0})),a.createElement(o.FormLayoutGroup,{mode:"horizontal"},a.createElement(o.FormItem,{top:a.createElement(a.Fragment,null,i.use("me_contacts_import_modal_name_input")," ",a.createElement("span",{className:"InputContactModal__requiredSymbol"},"*")),status:e.name.status},a.createElement(o.Input,{maxLength:250,type:"text",name:"name",autoComplete:"given-name",value:e.name.value,onChange:t,required:!0})),a.createElement(o.FormItem,{top:i.use("me_contacts_import_modal_surname_input")},a.createElement(o.Input,{maxLength:250,type:"text",name:"surname",autoComplete:"family-name",value:e.surname.value,onChange:t}))))}},210770:(e,t,s)=>{"use strict";s.d(t,{InviteContactModal:()=>m});var n=s(667294),r=s(86894),a=s(294184),o=s.n(a),i=s(95154),c=s(696023),l=s(988994),d=s(266864),u=s(143573),h=(s(950652),s(388918));const m=({contactPhone:e,onClose:t,onBack:s})=>{const{lang:a}=(0,c.useBrowserEnv)(),{mode:m}=(0,l.useLayoutData)(),[p,f]=(0,n.useState)(!1),g=(0,n.useRef)(null);(0,n.useEffect)((()=>()=>{g.current&&clearTimeout(g.current)}),[]);const v="one-column"===m;return n.createElement(d.ModalInterface,{title:a.use("me_contacts_invite_modal_title"),closeLabel:a.use("me_close"),onClose:t,contextClass:"MEConfig",backLabel:a.use("me_back"),onBack:s,withCustomLayout:!0},n.createElement("div",{className:o()("InviteContactModal",{"InviteContactModal--fullScreen":v})},n.createElement("div",{className:"InviteContactModal__textWrapper"},n.createElement("p",{className:"InviteContactModal__text"},n.createElement(h.FormattedLangKey,{langkey:"me_contacts_invite_modal_user_not_found",values:{phone:n.createElement("span",{className:"InviteContactModal__phone"},e)}})),n.createElement("p",{className:"InviteContactModal__text"},a.use("me_contacts_invite_modal_app_promo"))),n.createElement(r.Input,{className:"InviteContactModal__linkBox",value:i.VKME_APP_INSTALL_LINK,readOnly:!0,autoFocus:!0,type:"text"}),n.createElement("div",{className:"InviteContactModal__linkCopyWrapper"},n.createElement(u.CopyText,{onCopyDone:()=>{f(!0),g.current&&clearTimeout(g.current),g.current=setTimeout((()=>f(!1)),2e3)},text:i.VKME_APP_INSTALL_LINK},n.createElement(r.Button,{mode:"secondary",size:"m"},a.use("me_contacts_invite_modal_link_copy"))),n.createElement("span",{className:o()("InviteContactModal__linkCopyNotice",{"InviteContactModal__linkCopyNotice--blink":p})},a.use("me_contacts_invite_modal_link_copied")))))}},276351:(e,t,s)=>{"use strict";s.d(t,{useImportContact:()=>i});var n=s(11010),r=s(696023),a=s(95154),o=s(667294);const i=()=>{const{api:e}=(0,r.useBrowserEnv)(),[t,s]=(0,o.useState)(!1);return{isLoading:t,importContact:(0,o.useCallback)((0,n._)((function*({phone:t,name:n,surname:r,withExisting:o}){var i,c;s(!0);const l=r?n+" "+r:n,d=yield e.fetch("account.importMessagesContacts",{contacts:JSON.stringify([{phones:[t],name:l}]),with_existing:Boolean(o),extended:1,device_id:a.CLIENT_ID.toString()});return 0===d.items.synced.length&&0===d.items.existing.length||!(null==(i=d.contacts)?void 0:i[0])?{hasFailed:!0}:(s(!1),{items:d.items,profile:null==(c=d.profiles)?void 0:c[0],contact:d.contacts[0],hasFailed:!1})})),[e])}}},864739:(e,t,s)=>{"use strict";s.d(t,{InviteButton:()=>o});var n=s(667294),r=s(917303),a=s(659397);s(705875);const o=({children:e,className:t,onClick:s,icon:o=n.createElement(r.Icon24PhoneAddOutline,null)})=>n.createElement("button",{className:(0,a.classNames)("InviteButton",t),type:"button",onClick:s},n.createElement("span",{className:"InviteButton__icon","aria-hidden":!0},o),n.createElement("span",{className:"InviteButton__label"},e))},266864:(e,t,s)=>{"use strict";s.d(t,{ModalInterface:()=>d});s(360862);var n=s(667294),r=s(671324),a=s(874971),o=s(964929),i=s(798855),c=s(234325),l=s(506315);const d=({onClose:e,closeLabel:t,onBack:s,backLabel:d,title:u,contextClass:h,panelClass:m,hasClearBackdrop:p,isHidden:f,portalTarget:g,buttons:v,withCustomLayout:_,children:C,footerHint:y})=>n.createElement(r.ModalView,{onEscape:e,contextClass:h,portalTarget:g,isHidden:f},n.createElement(a.ModalBackdrop,{onClick:e,isClear:p},n.createElement(o.ModalPanel,{className:m},n.createElement(i.ModalHeader,{closeLabel:t,onClose:e,backLabel:d,onBack:s,title:u}),n.createElement(c.ModalBody,{withCustomLayout:_},C),v&&n.createElement(l.ModalFooter,{buttons:v,hint:y}))))},988277:(e,t,s)=>{"use strict";s.d(t,{NoResults:()=>i});s(58245);var n=s(667294),r=s(194805),a=s(294184),o=s.n(a);const i=n.memo((function({children:e,icon:t=n.createElement(r.Icon56MessagesOutline,null),className:s}){return n.createElement("div",{className:o()("NoResults",s)},n.createElement("span",{className:"NoResults__icon"},t),n.createElement("div",{className:"NoResults__text"},e))}))},282384:(e,t,s)=>{"use strict";s.d(t,{OnlineStatus:()=>a});var n=s(667294),r=s(696023);const a=n.memo((function({className:e,user:t}){const{lang:s}=(0,r.useBrowserEnv)(),a=(0,r.useLastSeen)(t.id),o=(0,r.useNow)(6e5);if("Contact"===t.kind){if(t.lastSeen&&["today","recently"].includes(t.lastSeen)){const r={today:s.use("global_online_was_today",{sex:"male"}),recently:s.use("global_online_was_recently",{sex:"male"})}[t.lastSeen];return n.createElement("span",{className:e,role:"status"},r)}return null}const i=n.createElement("div",{className:e}," ");if(!a)return i;if(a.isOnline)return n.createElement("span",{className:e,role:"status"},s.use("global_online",{sex:t.sex}));if("number"==typeof a.at)return n.createElement("span",{className:e,role:"status"},s.formatDate(a.at,{now:o,variant:"time-ago"}));let c;switch(a.at){case"recently":c="global_online_was_recently";break;case"last_week":c="global_online_was_week";break;case"last_month":c="global_online_this_month";break;case"long_ago":case"not_show":c="global_online_long_ago";break;default:a.at;return i}return n.createElement("span",{role:"status",className:e},s.use(c,{sex:t.sex}))}))},803220:(e,t,s)=>{"use strict";s.d(t,{OptionsListItem:()=>i,OptionsListItemWrapper:()=>l});s(181362);var n=s(667294),r=s(294184),a=s.n(r),o=s(658508);const i=({icon:e,title:t,description:s,aside:r,isPadded:i=!0,isInteractive:c,hasChevron:d,hasIconBackground:u,onClick:h,className:m})=>n.createElement(l,{onClick:h,isInteractive:c,className:m,isPadded:i},n.createElement("div",{className:a()("OptionsListItem__icon",{"OptionsListItem__icon--withBG":u}),"aria-hidden":!0},e),n.createElement("div",{className:"OptionsListItem__main"},n.createElement("div",{className:"OptionsListItem__title"},t),s&&n.createElement("div",{className:"OptionsListItem__description"},s)),d&&n.createElement("div",{className:"OptionsListItem__aside OptionsListItem__aside--chevron"},n.createElement(o.Icon28ChevronRightOutline,null)),r&&n.createElement("div",{className:"OptionsListItem__aside"},r));function c(e){e.preventDefault()}const l=({children:e,className:t,isInteractive:s,isPadded:r=!0,onClick:o})=>{const i=a()("OptionsListItem",t,{"OptionsListItem--interactive":null!=s?s:o,"OptionsListItem--padded":r});return n.createElement("li",{className:i,onClick:o,tabIndex:o?0:void 0,onMouseDown:o?c:void 0},e)}},811632:(e,t,s)=>{"use strict";s.d(t,{PeerAvatar:()=>c});var n=s(667294),r=s(96190),a=s(755810),o=s(696023),i=s(377291);const c=n.memo((function({peer:e,size:t,className:s,withFavorite:c}){const l=(0,a.useAvatarPhoto)(e,t),d=(0,o.useOwner)(),u=r.isFavorites(e.id,d.id);return c&&u?n.createElement(i.AvatarFavorites,{size:t}):n.createElement(a.BasicAvatar,{size:t,url:l,alt:r.name(e),text:r.initials(e),color:r.isContactPeerId(e.id)?"contact":e.id,className:s})}))},863994:(e,t,s)=>{"use strict";s.d(t,{PeerChip:()=>d});var n=s(667294),r=s(96190),a=s(790932),o=(s(279478),s(294184)),i=s.n(o),c=s(696023),l=s(811632);const d=({peerId:e,onRemove:t,className:s})=>{const{lang:o}=(0,c.useBrowserEnv)(),d=(0,c.usePeers)(),u=r.safeGet(d,e);return n.createElement("div",{className:i()("PeerChip",s)},n.createElement("div",{className:"PeerChip__content"},n.createElement(l.PeerAvatar,{peer:u,size:20}),n.createElement("div",{className:"PeerChip__name"},r.firstName(u))),t&&n.createElement("button",{"aria-label":o.use("me_remove"),className:"PeerChip__remove",onClick:t},n.createElement(a.Icon16Cancel,null)))}},519478:(e,t,s)=>{"use strict";s.d(t,{PeerChipsSearchInput:()=>u});var n=s(667294),r=s(532048),a=(s(42505),s(696023)),o=s(863994),i=s(966430),c=s(367763),l=s(65970),d=s(546428);const u=({onQueryChange:e,onRemove:t,selection:s,placeholder:u,onSearchInputKeyDown:h})=>{const{lang:m}=(0,a.useBrowserEnv)(),p=(0,n.useRef)(null),[f,g]=(0,n.useState)(""),v=(0,a.usePrevious)(s),{isTouchOnly:_}=(0,c.useDeviceData)(),[C,y]=(0,n.useState)(!1);(0,n.useEffect)((()=>{var e,t;(null!=(t=null==(e=v)?void 0:e.size)?t:0)<s.size&&!C&&g("")}),[v,s.size,C]);(0,n.useEffect)((()=>{e(f)}),[f]),(0,n.useEffect)((()=>{const e=p.current;e&&(v&&v.size>=s.size||e.scrollIntoView({block:"nearest"}))}),[v,s]),(0,n.useEffect)((()=>{p.current&&(_||p.current.focus())}),[s,_]);const k=(0,n.useMemo)((()=>Array.from(s.values())),[s]),I=(0,n.useMemo)((()=>{const e=[];for(let s=0;s<k.length;s+=1){var t;const n=k[s];"peer"===(null==(t=n)?void 0:t.kind)&&e.push(n.peerId)}return e}),[k]),E=(0,n.useMemo)((()=>(0,d.onElementKeyDownFactory)(((e,t)=>{switch(e){case"Mod":y(!0);break;case"Escape":t(),g("")}}))),[]);return n.createElement("div",{className:"PeerChipsSearchInput","data-testid":"PeerChipsSearchInput"},n.createElement(r.ScrollbarProvider,{style:{maxHeight:134},overflowX:"hidden"},n.createElement("div",{className:"PeerChipsSearchInput__content",onMouseDown:e=>{const t=p.current;t&&document.activeElement===t&&e.stopPropagation()},onClick:e=>{e.currentTarget===e.target&&p.current&&p.current.focus()}},0===I.length&&n.createElement("div",{className:"PeerChipsSearchInput__icon"},n.createElement(i.Icon20Search,null)),I.length>0&&I.map((e=>n.createElement(o.PeerChip,{key:e,peerId:e,className:"PeerChipsSearchInput__item",onRemove:()=>(e=>{var s;const n=k.find((t=>"peer"===t.kind&&t.peerId===e));n&&(null==(s=t)||s(n))})(e)}))),n.createElement("div",{className:"PeerChipsSearchInput__inputContainer"},n.createElement("input",{"data-testid":"PeerChipsSearchInput__input",className:"PeerChipsSearchInput__input",ref:p,onChange:e=>{g(e.currentTarget.value)},value:f,placeholder:(()=>{if(!(I.length>0))return u||m.use("me_picker_peer_search_placeholder")})(),onKeyDown:e=>{E(e),h(e)},onKeyUp:e=>{"Mod"===(0,l.getKeyCombo)(e)&&y(!1)}})))))}},4738:(e,t,s)=>{"use strict";s.d(t,{PeerPickerList:()=>p});var n=s(434788),r=s(820224),a=s(667294),o=s(537090),i=(s(932823),s(684709)),c=s(414831),l=s(126528),d=s(53763),u=s(988277),h=s(696023),m=s(89131);const p=e=>{var{controlType:t,controlSide:s,descriptive:p=!0,loaderNode:f,errorNode:g,emptyNode:v,itemRenderer:_,itemHeight:C=56}=e,y=(0,r._)(e,["controlType","controlSide","descriptive","loaderNode","errorNode","emptyNode","itemRenderer","itemHeight"]);const{lang:k}=(0,h.useBrowserEnv)(),I=(0,a.useCallback)((e=>{switch(e.item.kind){case"peer":return a.createElement(c.PeerPickerListItem,{isGlobal:e.item.isGlobal,controlType:t,controlSide:s,descriptive:p,selected:e.selected,disabled:e.disabled,peerId:e.item.peerId,onSelection:()=>e.onSelection({id:e.id,value:e.item})});case"template":return e.item.node;default:return(0,m.exhaustivenessCheck)(e.item)}}),[p,t,s]),E=e=>a.createElement("div",{className:"PeerPickerList__content"},e);return a.createElement(i.PickerList,(0,n._)({},y,{itemRenderer:_||I,itemHeight:C,loaderNode:E(f||a.createElement(l.OptimizedSpinner,null)),errorNode:E(g||a.createElement(d.IconNote,{icon:a.createElement(o.Icon56ErrorOutline,null)},a.createElement("div",{className:"PeerPickerList__error"},k.use("me_picker_peer_list_error")))),emptyNode:E(v||a.createElement(u.NoResults,null,k.use("me_picker_peer_list_empty")))}))}},414831:(e,t,s)=>{"use strict";s.d(t,{PeerPickerListItem:()=>h});var n=s(667294),r=s(96190),a=s(185327),o=s(760540),i=s(696023),c=(s(737968),s(811632)),l=s(248390),d=s(661059),u=s(953614);const h=({selected:e=!1,disabled:t=!1,peerId:s,onSelection:h,controlType:m="check",controlSide:p="left",descriptive:f=!0,isGlobal:g=!1})=>{const v=(0,i.usePeers)(),_=(0,i.useConvos)(),C=r.safeGet(v,s),y=(0,i.useOwner)(),k="Chat"===C.kind?a.safeGet(_,C.id):null,I=r.isFavorites(C.id,y.id);return n.createElement(o.PickerItem,{selected:e,disabled:t,onSelection:h,controlType:m,controlSide:p,className:"PeerPickerListItem__item"},n.createElement("div",{className:"PeerPickerListItem","data-testid":"PeerPickerListItem"},n.createElement("div",{className:"PeerPickerListItem__avatar"},n.createElement(c.PeerAvatar,{peer:C,size:40,withFavorite:!0})),n.createElement("div",{className:"PeerPickerListItem__content"},n.createElement("div",{className:"PeerPickerListItem__name"},"User"===C.kind?n.createElement(l.PeerTitle,{peer:C,isFavorites:I}):n.createElement(d.ConvoTitle,{peer:C,isMuted:!1,isCasper:null!==k&&a.isCasper(k)})),!I&&f&&n.createElement(u.PeerSubhead,{className:"PeerPickerListItem__info",peer:C,convo:k,showScreenName:g}))))}},953614:(e,t,s)=>{"use strict";s.d(t,{PeerSubhead:()=>l});var n=s(667294),r=s(696023),a=s(282384),o=s(86894),i=s(89131),c=s(67091);const l=({peer:e,convo:t,showScreenName:s,className:l})=>{const{lang:d}=(0,r.useBrowserEnv)();return n.createElement(o.Subhead,{className:l,Component:"span",weight:"3"},(()=>{if(s&&("User"===e.kind||"Group"===e.kind)&&e.screenName)return n.createElement(n.Fragment,null,"@",e.screenName);switch(e.kind){case"User":return n.createElement(a.OnlineStatus,{user:e});case"Chat":var r;if("ChatConvo"!==(null==(r=t)?void 0:r.kind))return"";switch(t.state){case"in":return d.use("me_group_members_count",{num:t.membersCount,formatted:"short"});case"left":return d.use("me_convo_profile_left_chat_label");case"kicked":return d.use("me_convo_profile_kicked_chat_label");case"out":return"";default:t.state;return""}case"Group":return d.use("me_group_members_count",{num:e.memberCount,formatted:"short"});case"Contact":return n.createElement(c.FormattedPhoneNumber,{phone:e.phone});default:(0,i.exhaustivenessCheck)(e)}})())}},248390:(e,t,s)=>{"use strict";s.d(t,{PeerTitle:()=>m});s(501954);var n=s(667294),r=s(354819),a=s(96715),o=s(20403),i=s(546134),c=s(96190),l=s(294184),d=s.n(l),u=s(696023),h=s(709646);const m=n.memo((function({peer:e,isShortened:t=!1,isAdmin:s=!1,isCreator:l=!1,isFavorites:m=!1,isRestrictedToWrite:p=!1,className:f}){const{vkm_convo_member_temporary_ban:g}=(0,u.useFeatureFlags)(),{lang:v}=(0,u.useBrowserEnv)(),_=(0,u.useViewer)(),C=h.isEdu(_.profileType);let y;switch(!0){case m:y=v.use("me_favorites");break;case t:y=c.firstName(e);break;default:y=c.name(e)}return n.createElement("div",{className:d()("PeerTitle",{"PeerTitle--vkAdmin":c.isVkAdministration(e.id)},f)},n.createElement("div",{className:"PeerTitle__title"},y),"Chat"!==e.kind&&"Contact"!==e.kind&&e.isVerified?n.createElement("span",{className:"PeerTitle__icon PeerTitle__verifiedIcon"},C&&"User"===e.kind?n.createElement(r.Icon16Education,{width:12,height:12}):n.createElement(a.Icon16Verified,null)):null,(s||l)&&n.createElement("span",{className:d()("PeerTitle__icon",s&&"PeerTitle__adminIcon",l&&"PeerTitle__creatorIcon")},n.createElement(o.Icon12Favorite,{"aria-hidden":!1,"aria-label":v.use("me_admin")})),g&&p&&n.createElement("span",{className:"PeerTitle__icon PeerTitle__cantWriteIcon"},n.createElement(i.Icon12MessageCross,null)))}))},395110:(e,t,s)=>{"use strict";s.d(t,{PhoneInvite:()=>c});var n=s(667294),r=s(935562),a=s(86894),o=s(696023),i=(s(994718),s(435683));const c=({onSubmit:e,onErrorReset:t,isLoading:s=!1,isInvite:c=!1,error:l,focusOnMount:d})=>{const[u,h]=(0,n.useState)(""),{lang:m}=(0,o.useBrowserEnv)(),{isReady:p,format:f}=(0,i.useFormatPhoneNumber)(),g=(0,n.useRef)(null),v=(0,n.useCallback)((e=>{var s;null==(s=t)||s();const n=f(e.target.value);h(n)}),[f,t]);return(0,n.useEffect)((()=>{d&&g.current&&g.current.focus()}),[]),n.createElement(a.FormLayout,{className:"PhoneInvite",onSubmit:t=>{t.preventDefault(),s||e(u)}},n.createElement(r.Icon56PhoneOutline,{className:"PhoneInvite__icon",color:"var(--vkui--color_icon_accent)"}),n.createElement("h3",{className:"PhoneInvite__title"},m.use(c?"me_phone_invite_title":"me_phone_write_title")),n.createElement("div",{className:"PhoneInvite__subtitle"},m.use(c?"me_phone_invite_subtitle":"me_phone_write_subtitle")),n.createElement(a.FormItem,{status:l?"error":"default",bottom:l,className:"PhoneInvite__row"},n.createElement(a.Input,{className:"PhoneInvite__input",type:"tel",name:"phone",autoComplete:"tel",value:u,onChange:v,placeholder:"+7 (000) 000-00-00",getRef:g})),n.createElement("div",{className:"PhoneInvite__action"},n.createElement(a.Button,{type:"submit",size:"l",stretched:!0,mode:"primary",loading:s||!p,disabled:!u},m.use(c?"me_phone_invite_action":"me_phone_write_action"))))}},174182:(e,t,s)=>{"use strict";s.d(t,{PhoneInviteModal:()=>m});var n=s(434788),r=s(820224),a=s(667294),o=s(671324),i=s(874971),c=s(964929),l=s(234325),d=s(395110),u=(s(324402),s(696023)),h=s(579431);const m=e=>{var{onClose:t}=e,s=(0,r._)(e,["onClose"]);const{lang:m}=(0,u.useBrowserEnv)();return a.createElement(o.ModalView,{contextClass:"MEConfig",onEscape:t},a.createElement(i.ModalBackdrop,{onClick:t},a.createElement(c.ModalPanel,{className:"PhoneInviteModal__panel"},a.createElement(l.ModalBody,{withCustomLayout:!0},a.createElement("div",{className:"PhoneInviteModal"},a.createElement("button",{className:"PhoneInviteModal__close",type:"button","aria-label":m.use("me_close"),onClick:t},a.createElement("span",{className:"PhoneInviteModal__closeInner"},a.createElement(h.Icon20Cancel,null))),a.createElement(d.PhoneInvite,(0,n._)({},s)))))))}},827258:(e,t,s)=>{"use strict";s.d(t,{Picker:()=>l});var n=s(667294),r=s(294184),a=s.n(r),o=(s(883061),s(760802)),i=s(696023);const c=new Map,l=({strategy:e="singular",onSelectionChange:t,searchRenderer:s,listRenderer:r,selection:l=c,items:d,total:u,search:h,prefetch:m,isLoading:p=!1,isPristine:f=!1,hasFailed:g=!1,checkDisabledItem:v,initialQuery:_,getItemId:C,className:y,onQueryChange:k,onLoadMore:I})=>{const{toggleSelection:E,selection:b}=(0,o.usePicker)({strategy:e,selection:l}),{query:w,onKeyDown:M,onQueryUpdate:S,indexToSelect:R,forceScrollToLoader:A,resetIndexToSelect:P}=(0,o.usePickerSearch)({items:d,onSelect:E,getItemId:C,onQueryChange:k,initialQuery:_,hasMore:null===u||u>d.length});(0,n.useEffect)((()=>{var e;null==(e=m)||e({query:w}),h({query:w,offset:0,count:50})}),[w]),(0,n.useEffect)((()=>{t(b)}),[b]);const F=(0,n.useCallback)((e=>{E(e),P()}),[E,P]),U=(0,n.useMemo)((()=>d.map(((e,t)=>{const s=C(e);return{id:s,item:e,selected:b.has(s),disabled:!!v&&v(e),focusedWithNavigation:t===R}}))),[C,v,d,b,R]),N=I||(({offset:e,count:t})=>{h({offset:e,count:t,query:w})});(0,i.useDidUpdate)((()=>{var e;null==(e=T.current)||e.scrollToItem(R)}),[R]),(0,n.useLayoutEffect)((()=>{var e;A&&(null==(e=T.current)||e.scrollToItem(R+1))}),[A,R]);const T=(0,n.useRef)(null);return n.createElement("div",{className:a()("Picker",y)},n.createElement(s,{items:d,onQueryChange:S,selection:b,onRemove:e=>{E({id:C(e),value:e})},onSearchInputKeyDown:M}),n.createElement(r,{items:U,total:u,onItemSelection:F,loadMore:N,loading:p,pristine:f,failed:g,listRef:T}))}},760540:(e,t,s)=>{"use strict";s.d(t,{PickerItem:()=>h});var n=s(434788),r=s(820224),a=s(667294),o=s(354943),i=s(856335),c=s(29157),l=s(294184),d=s.n(l),u=(s(669721),s(89131));const h=e=>{var{controlType:t="check",controlSide:s="left",selected:l,disabled:h,onSelection:m,children:p,className:f}=e,g=(0,r._)(e,["controlType","controlSide","selected","disabled","onSelection","children","className"]);const v=(0,a.useCallback)((()=>{h||m()}),[h,m]),_=(0,a.useMemo)((()=>{switch(t){case"arrow":return a.createElement(o.Icon24ChevronCompactRight,{className:"PickerItem__arrow"});case"check":return l?a.createElement(i.Icon20CheckCircleOn,null):a.createElement(c.Icon20CheckCircleOff,null);default:(0,u.exhaustivenessCheck)(t)}}),[t,l]),C=(0,a.useCallback)((e=>{"Enter"===e.key&&v()}),[v]);return a.createElement("div",(0,n._)({},g,{className:d()("PickerItem",`PickerItem--${s}`,{"PickerItem--disabled":h},{"PickerItem--selected":l},f),tabIndex:-1,role:"checkbox","aria-checked":l,onClick:v,onKeyDown:C}),a.createElement("button",{type:"button",className:"PickerItem__button",tabIndex:-1},_),a.createElement("div",{className:"PickerItem__content"},p))}},684709:(e,t,s)=>{"use strict";s.d(t,{PickerList:()=>u});var n=s(11010),r=s(434788),a=s(667294),o=s(532048),i=(s(466135),s(274061)),c=s(365691),l=s(294184),d=s.n(l);const u=({items:e,total:t,loading:s,failed:l,pristine:u,onItemSelection:h,itemRenderer:m,itemHeight:p,loaderNode:f,emptyNode:g,errorNode:v,loadMore:_,header:C,footer:y,listRef:k})=>{var I;const[E,b]=(0,a.useState)(null),w=(0,a.useRef)(null),M=(0,a.useRef)(null),S=(0,a.useRef)(null),[,R]=(0,a.useState)({}),A=null===t||t>e.length,P=(0,a.useCallback)((({index:e,style:t,data:{loaderNode:s,loading:n,items:o}})=>{const i=o[e];return i?a.createElement("div",{style:t,key:i.id,className:d()("PickerList__item",{"PickerList__item--selected":i.focusedWithNavigation})},a.createElement(m,(0,r._)({},i))):e===o.length&&n&&s?a.createElement("div",{style:t,className:"PickerList__item"},s):null}),[m]);(0,a.useEffect)((()=>{if(!E)return;M.current=E.offsetHeight;const e=new ResizeObserver((e=>{if(0===e.length)return;if(e.forEach((e=>{const t=e.contentRect;M.current&&(S.current=M.current),M.current=t.height})),!(S.current&&M.current&&w.current&&k.current))return;const t=S.current-M.current;k.current.scrollTo(w.current.scrollTop+t),R({})}));return e.observe(E),()=>e.disconnect()}),[E,w,k,R]);const F=(0,a.useCallback)((t=>!!e[t]),[e]),U=(0,a.useCallback)((0,n._)((function*(e,t){_({offset:e,count:t-e})})),[_]);if(0===(null==(I=e)?void 0:I.length))return a.createElement(a.Fragment,null,C,s?f:u?null:l?v:g||null,y);const N={loaderNode:f,loading:s,items:e.map((e=>(0,r._)({},e,{onSelection:h})))};return a.createElement("div",{ref:e=>b(e),className:"PickerList"},C,a.createElement("div",{className:"PickerList__container"},a.createElement(c.default,{isItemLoaded:F,loadMoreItems:U,itemCount:A?t||e.length+20:e.length},(({onItemsRendered:n,ref:r})=>a.createElement(o.ScrollbarProvider,{style:{width:"100%",height:"100%"},overflowX:"hidden"},(({scrollableRef:o,contentRef:c})=>(w.current=o.current,a.createElement(i.FixedSizeList,{ref:e=>{k.current=e,r(e)},direction:"ltr",onItemsRendered:n,height:M.current||0,width:"100%",overscanCount:25,itemSize:p,itemData:N,outerRef:o,className:"PickerList__list",innerRef:c,itemCount:null!==t?s?e.length+1:t:e.length+1},P))))))),y)}},689494:(e,t,s)=>{"use strict";s.d(t,{PickerSearchInput:()=>c});var n=s(667294),r=s(696023),a=s(546428),o=s(367763),i=s(86894);const c=({onQueryChange:e,placeholder:t,selection:s,onSearchInputKeyDown:c})=>{const{lang:l}=(0,r.useBrowserEnv)(),d=(0,n.useRef)(null),[u,h]=(0,n.useState)(""),{isTouchOnly:m}=(0,o.useDeviceData)();(0,n.useEffect)((()=>{e(u)}),[u]),(0,n.useEffect)((()=>{d.current&&(m||d.current.focus())}),[m,s]);const p=(0,n.useMemo)((()=>(0,a.onElementKeyDownFactory)(((e,t)=>{if("Escape"===e)t(),h("")}))),[]);return n.createElement(i.Search,{getRef:d,className:"PickerSearchInput__input",placeholder:t||l.use("me_picker_peer_search_placeholder"),onChange:e=>{h(e.currentTarget.value)},value:u,onKeyDown:e=>{p(e),c(e)}})}},574018:(e,t,s)=>{"use strict";s.d(t,{ProfileInfoModal:()=>C});var n=s(11010),r=s(354943),a=s(86894),o=s(696023),i=s(294184),c=s.n(i),l=s(667294),d=(s(929894),s(89131)),u=s(96190),h=s(597990),m=s(882670),p=s(906978),f=s(402423),g=s(95154),v=s(927411),_=s(597298);const C=({onBack:e,isVKIDHidden:t=!1})=>{var s;const{viewer:i,profileInfo:{phoneNumber:C,id:y,avatarPhoto:k,screenName:I="",firstName:E,lastName:b}}=(0,o.useViewer)(),w=(0,o.useFeatureFlags)(),{api:M,lang:S,uploader:R}=(0,o.useBrowserEnv)(),[A,P]=(0,l.useState)(),[F,U]=(0,l.useState)(!1),[N,T]=(0,l.useState)(I),[x,O]=(0,l.useState)(!1),[L,q]=(0,l.useState)(!1),[B,D]=(0,l.useState)(!1),[z,H]=(0,l.useState)(!1),[G,V]=(0,l.useState)(!1),[W,K]=(0,l.useState)(!1),[j,Z]=(0,l.useState)(),$=(0,l.useMemo)((()=>i.photoId&&Number(i.photoId)),[i.photoId]),Q=(0,l.useMemo)((()=>{var e;return null==(e=C)?void 0:e.replace(/\*/g,"·")}),[C]),X=(0,o.useDispatch)(),J=(0,l.useCallback)((0,n._)((function*(){D(!0);try{const[e,t]=yield M.fetchMany([{method:"account.getProfileInfo",params:{}},{method:"users.get",params:{user_ids:u.toRealId(y).toString(),extended:1}}]),s=(0,h.fromApiViewerProfileInfo)(e),n=t[0],{user:r}=n?(0,m.fromApiUser)(n):{};X({type:"UserProfileInfo_Update",profileInfo:s,user:r})}catch(e){}finally{D(!1)}})),[y,X,M]),Y=(0,n._)((function*(){q(!0);try{yield M.fetch("photos.delete",{photo_id:Number($),owner_id:y}),yield J()}catch(e){}finally{q(!1)}})),ee=(0,n._)((function*(){H(!0);try{return yield M.fetch("account.saveProfileInfo",{screen_name:N}),!0}catch(t){var e;if(t instanceof v.IApi.RequestError)t.code===p.API_ERROR_AUTH_VALIDATION&&"string"==typeof(null==(e=t.apiError)?void 0:e.redirect_uri)&&window.open(t.apiError.redirect_uri);return!1}finally{H(!1)}})),te=(0,n._)((function*(e){V(!0);try{return yield new Promise(((t,s)=>{R.uploadFiles([e],{asOwnerPhoto:!0},{viewerId:y},{onUploadFinish:t,onError:s})})),!0}catch(e){return!1}finally{V(!1)}}));(0,l.useEffect)((()=>{Z(k?{kind:"current"}:void 0)}),[k]),(0,l.useEffect)((()=>{T(I||"")}),[I]);const se=!("current"===(null==(s=j)?void 0:s.kind)&&N===I||A||x||L||B||z||G),ne=(0,l.useRef)(N);ne.current=N;const re=(0,l.useMemo)((()=>(0,d.debounce)((e=>{M.fetch("utils.checkScreenName",{screen_name:e}).then((t=>{ne.current===e&&(0===t.status?(U(!1),P(t.reason)):1===t.status&&(U(!0),P(void 0)))})).catch(d.noop).finally((()=>{ne.current===e&&O(!1)}))}),500,!1)),[M]);(0,l.useEffect)((()=>{const e=()=>{document.hidden||J()};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)}),[X,y,J]);const ae=(0,n._)((function*(){var t;if(!se)return;K(!0);const s="preview"===(null==(t=j)?void 0:t.kind)&&j.photo,n=N!==I,[r,a]=yield Promise.all([n&&ee(),s&&te(j.photo)]);r||a?(yield J(),K(!1),e()):K(!1)})),oe=(0,n._)((function*(e){Z({kind:"preview",photo:e})})),ie=(0,l.useMemo)((()=>A?"error":F?"valid":"default"),[A,F]),ce=(0,l.useMemo)((()=>{switch(ie){case"error":return A;case"valid":return S.use("me_profile_info_shortname_avaliable");default:return""}}),[A,S,ie]);return l.createElement(l.Fragment,null,l.createElement(a.FormLayout,{className:"MEApp__settings ProfileInfo__container",onSubmitCapture:ae},t?null:l.createElement("div",{className:c()("ProfileInfo__VKID",!w.vkm_profile_info_screen_name&&"ProfileInfo__VKID--noScreenName")},l.createElement("div",{className:"ProfileInfo__VKIDAvatar"},l.createElement(f.AvatarSelector,{isLoading:L,key:k,size:64,onSelection:oe,onRemove:()=>{var e,t;"current"===(null==(e=j)?void 0:e.kind)&&$?Y():"preview"===(null==(t=j)?void 0:t.kind)&&Z(k?{kind:"current"}:void 0)},peerId:i.id,isDisabled:L})),l.createElement(_.ExternalLink,{href:`${g.ID_VK_COM_BASE}/account/#/personal`,className:"ProfileInfo__VKIDDetailsCard"},l.createElement("p",{className:"ProfileInfo__name"},E," ",b),l.createElement("p",{className:"ProfileInfo__phoneNumber"},Q),l.createElement("p",{className:"ProfileInfo__VKIDSettings"},S.use("me_vkid_settings")),l.createElement(r.Icon24ChevronCompactRight,{className:"ProfileInfo__chevron"}))),w.vkm_profile_info_screen_name&&l.createElement(l.Fragment,null,l.createElement(a.FormItem,{className:"ProfileInfo__noVKUIFormItemPadding ProfileInfo__shortNameBox",top:l.createElement("div",{className:"ProfileInfo__screenNameInputTop"},l.createElement("span",null,S.use("me_profile_info_shortname")),l.createElement("span",null,N.length," / ",25)),status:ie,bottom:ce},l.createElement(a.Input,{after:x&&l.createElement(a.Spinner,{size:"small"}),value:N,maxLength:25,onChange:e=>{const{value:t}=e.target;U(!1),P(void 0),O(!1),T(t),t!==I&&(O(!0),re(t))}})),l.createElement("div",{className:"ProfileInfo__screenNameDescription"},l.createElement("p",null,S.use("me_profile_info_shortname_description")," ",I||F?l.createElement(l.Fragment,null,S.use("me_profile_info_your_shortname")," ",F?l.createElement("span",{className:"ProfileInfo__avaliableScreenName"},"@",N):l.createElement("span",{onClick:()=>navigator.clipboard.writeText(`@${I}`),className:"ProfileInfo__screenName"},"@",I)):null),l.createElement("p",{className:"ProfileInfo__screenNameValidationInfo"},S.use("me_profile_info_shortname_validation_rules")," ",l.createElement("span",{className:"ProfileInfo__a-z0-9"},"a-z"),","," ",S.use("me_profile_info_shortname_validation_rules_digits")," ",l.createElement("span",{className:"ProfileInfo__a-z0-9"},"0-9")," ",S.use("me_profile_info_shortname_validation_rules_point"),"."," ",S.use("me_profile_info_shortname_validation_rules_min_length"))))),l.createElement("footer",{className:"ChatSettings__footer"},l.createElement(a.Button,{disabled:!se,loading:W,onClick:ae},S.use("me_save"))))}},740779:(e,t,s)=>{"use strict";s.d(t,{SortableList:()=>a,useSortable:()=>i});var n=s(667294);const r=n.createContext(null),a=({children:e,items:t,disabled:s,onChange:a})=>{const[o,i]=(0,n.useState)(null),[c,l]=(0,n.useState)(null),d=(0,n.useMemo)((()=>o?t.indexOf(o):-1),[o,t]),u=(0,n.useMemo)((()=>({items:t,active:o,activeIndex:d,hover:c,disabled:!0===s,setActive:i,setHover:l,onChange:a})),[t,o,d,c,s,a]);return n.createElement(r.Provider,{value:u},e)};function o(e,t,s){return e>=t&&e<=s}function i({id:e,lockAxis:t}){const s=(0,n.useContext)(r);if(!s)throw new Error("Сортируемые элементы должны быть обёрнуты в SortableList");const{active:a,disabled:o,activeIndex:i,hover:l,items:d,setActive:u,setHover:h,onChange:m}=s,p=(0,n.useMemo)((()=>d.indexOf(e)),[e,d]),f=(0,n.useRef)(null),[g,v]=(0,n.useState)({transform:"translate(0, 0)"}),_=(0,n.useMemo)((()=>({"data-item-id":e})),[e]),C=(0,n.useCallback)((()=>{o||(u(e),v({pointerEvents:"none",touchAction:"none"}),document.body.style.overscrollBehavior="contain")}),[o,e,u]),y=(0,n.useCallback)((()=>{if(l){const s=[...d],n=s.indexOf(l.id);let r=n;var t;if(r=1===(i<n?1:-1)?"top"===l.side?n-1:n:"top"===l.side?n:n-1,void 0!==e)s.splice(i,1),s.splice(r,0,e),null==(t=m)||t(s)}v({transform:"translate(0, 0)"}),u(null),h(null),document.body.style.overscrollBehavior="auto"}),[i,l,e,d,m,u,h]),k=(0,n.useCallback)((({shiftX:e,shiftY:s,originalEvent:n})=>{let r,o,i="";switch(t){case"x":i=`translateX(${e}px)`;break;case"y":i=`translateY(${s}px)`;break;default:i=`translate(${e}px, ${s}px)`}v({transform:i,pointerEvents:"none",touchAction:"none",position:"relative",zIndex:99999});const{touches:c}=n;c&&c[0]?(({clientX:r,clientY:o}=c[0]),n.preventDefault(),n.stopPropagation()):(r=n.clientX,o=n.clientY);const d=document.elementFromPoint(r,o);if(d){var u,m;const e=d.closest("[data-item-id]"),t=(null==(u=e)?void 0:u.dataset.itemId)?parseInt(null==(m=e)?void 0:m.dataset.itemId):null;if(e&&null!==a&&a!==t){var p,f;const s=e.getBoundingClientRect(),n=s.top+s.height/2<o?"bottom":"top";(null==(p=l)?void 0:p.id)===t&&(null==(f=l)?void 0:f.side)===n||h({id:t,side:n})}}}),[a,l,t,h]);return(0,n.useEffect)((()=>{if(null!==a){if(a!==e&&l&&f.current){const t=d.indexOf(e),s=d.indexOf(l.id),n=c(t,i,s,l.side,f.current.offsetHeight);v({transform:`translateY(${n}px)`,transition:"transform 150ms"})}}else v({transform:"translateY(0px)",transition:""})}),[a,i,l,e,d]),{index:p,setNodeRef:f,active:e===a,isDragging:null!==a,styles:g,attrs:_,disabled:o,onStart:C,onEnd:y,onMove:k}}const c=(e,t,s,n,r)=>{if(null===t||null===s||null===r||t===e)return 0;if(!(t>s?o(e,s,t):o(e,t,s)))return 0;if(1===(t<s?1:-1)){if("top"===n&&e<s)return-1*r;if("bottom"===n)return-1*r}else{if("bottom"===n&&e>s)return r;if("top"===n)return r}return 0}},324247:(e,t,s)=>{"use strict";s.d(t,{SettingsContent:()=>x,VKCOMSettingsContent:()=>Z});var n=s(11010),r=(s(321248),s(667294)),a=s(294184),o=s.n(a),i=s(532048),c=s(387613),l=s(690113),d=s(152335),u=s(519979),h=s(141343),m=s(571150),p=s(86894),f=s(696023),g=s(988994),v=s(597298),_=s(920582),C=s(402423),y=s(574018),k=s(410519),I=s(266864),E=s(157501),b=s(599660),w=s(89131),M=s(96190),S=s(709646),R=s(95154),A=s(597990),P=s(882670),F=s(163332),U=s(15285),N=s(264518),T=s(421199);const x=({route:e,convos:t,locks:s,folders:n,recommendedFolders:a,onLogout:l,foldersView:d})=>{const{mode:u}=(0,g.useLayoutData)(),{lang:h}=(0,f.useBrowserEnv)(),{section:m="main"}=e,_=(0,r.useMemo)((()=>{switch(m){case"account":return h.use("me_account");case"main":return h.use("me_settings_menu_main");case"folders":return h.use("me_settings_menu_folders");case"notifications":return h.use("me_settings_menu_notifications");case"theme":return h.use("me_settings_menu_theme");case"experimental":return h.use("me_settings_menu_experimental");case"about":return h.use("me_settings_menu_about");case"edu":return h.use("me_settings_menu_edu_role");default:(0,w.exhaustivenessCheck)(m)}}),[m,h]);return r.createElement(i.ScrollbarProvider,{overflowX:"hidden",className:o()("SettingsContent",{"SettingsContent--mobile":"one-column"===u})},"one-column"===u&&r.createElement(p.PanelHeader,{fixed:!1,separator:!1,before:r.createElement(p.Button,{mode:"tertiary",size:"l",before:r.createElement(c.Icon24Back,{fill:"var(--vkui--color_text_secondary)"}),Component:v.Link,to:{kind:"SettingsRoute"}})},r.createElement(p.Title,{level:"3"},_)),r.createElement("div",{className:"SettingsContent__body"},(()=>{switch(m){case"account":return r.createElement(D,{onLogout:l});case"main":return r.createElement(O,null);case"folders":return r.createElement(q,{folders:n,recommendedFolders:a,convos:t,locks:s,foldersView:d});case"notifications":return r.createElement(L,null);case"theme":return r.createElement(B,{themeControl:!0});case"experimental":return r.createElement(H,null);case"edu":return r.createElement(z,null);case"about":return null;default:(0,w.exhaustivenessCheck)(m)}})()))},O=()=>{const{lang:e}=(0,f.useBrowserEnv)(),{settings:t,accounts:s}=(0,f.useViewer)(),n=(0,f.useDispatch)(),a=2===s.length&&s.some((e=>S.isEdu(e.profileType))),o=(0,T.useUniqId)(),i=(0,T.useUniqId)();return r.createElement(r.Fragment,null,r.createElement(_.FieldGroup,{title:e.use("me_settings_input_mode")},r.createElement(_.FieldGroupItem,{after:r.createElement(G,{isCtrSubmitSelected:t.ctrSubmit,onChange:e=>n({type:"UserChangedSetting",setting:"ctrSubmit",value:e})})},e.use("me_settings_message_submit")),r.createElement(p.Spacing,{size:0},r.createElement(p.Separator,{wide:!0})),r.createElement(_.FieldGroupItem,{after:r.createElement(V,{isRightClickActionsEnabled:t.rightClickActionsEnabled,onChange:e=>n({type:"UserChangedSetting",setting:"rightClickActionsEnabled",value:e})})},e.use("me_settings_message_actions_control"))),r.createElement(_.FieldGroup,{title:e.use("me_settings_voice_messages")},r.createElement(_.FieldGroupItem,{id:o,after:r.createElement(p.Switch,{checked:t.transcriptAutoShow,"aria-labelledby":o,onChange:e=>n({type:"UserChangedSetting",setting:"transcriptAutoShow",value:Boolean(e.target.checked)})})},e.use("me_settings_auto_transcript"))),r.createElement(_.FieldGroup,{title:e.use("me_settings_archive")},r.createElement(_.FieldGroupItem,{subtitle:e.use("me_settings_auto_unarchive_note"),after:r.createElement(p.Switch,{checked:t.autoUnarchive,onChange:e=>n({type:"UserChangedSetting",setting:"autoUnarchive",value:Boolean(e.target.checked)})})},e.use("me_settings_auto_unarchive"))),a&&r.createElement(_.FieldGroup,{title:e.use("me_settings_other")},r.createElement(_.FieldGroupItem,{id:i,subtitle:e.use("me_settings_account_switch_button_hint"),after:r.createElement(p.Switch,{"aria-labelledby":i,checked:t.eduAccountSwitchBanner,onChange:e=>n({type:"UserChangedSetting",setting:"eduAccountSwitchBanner",value:Boolean(e.target.checked)})})},e.use("me_settings_account_switch_button"))))},L=({countOnlyNotMutedControl:e})=>{const{lang:t,browserNotifications:s}=(0,f.useBrowserEnv)(),{settings:n}=(0,f.useViewer)(),a=(0,f.useDispatch)(),o=(0,f.useFeatureFlags)(),i=(0,T.useUniqId)(),c=(0,T.useUniqId)(),l=(0,T.useUniqId)(),d=(0,T.useUniqId)();return r.createElement(r.Fragment,null,r.createElement(_.FieldGroup,{title:t.use("me_settings_application")},r.createElement(_.FieldGroupItem,{id:i,after:r.createElement(p.Switch,{checked:n.soundNotifications,"aria-labelledby":i,onChange:e=>a({type:"UserChangedSetting",setting:"soundNotifications",value:Boolean(e.target.checked)})})},t.use("me_settings_sound_notifications")),e&&r.createElement(r.Fragment,null,r.createElement(p.Spacing,{size:0},r.createElement(p.Separator,{wide:!0})),r.createElement(_.FieldGroupItem,{id:c,after:r.createElement(p.Switch,{checked:!n.countOnlyNotMuted,"aria-labelledby":c,onChange:e=>a({type:"UserChangedSetting",setting:"countOnlyNotMuted",value:!Boolean(e.target.checked)})})},t.use("me_settings_count_not_muted"))),s&&r.createElement(r.Fragment,null,r.createElement(p.Spacing,{size:0},r.createElement(p.Separator,{wide:!0})),r.createElement(_.FieldGroupItem,{id:l,subtitle:t.use("me_settings_browser_notifications_messages_calls_note"),after:r.createElement(W,{browserNotifications:s,ariaLabelledby:l})},t.use("me_settings_browser_notifications_messages_calls"))),o.vkm_reactions&&r.createElement(r.Fragment,null,r.createElement(p.Spacing,{size:0},r.createElement(p.Separator,{wide:!0})),r.createElement(_.FieldGroupItem,{id:d,subtitle:t.use("me_settings_reaction_notifications_note"),after:r.createElement(p.Switch,{checked:n.push.messageReaction.isEnabled,"aria-labelledby":d,onChange:e=>a({type:"UserChangedPushSetting",setting:"messageReaction",value:{isEnabled:Boolean(e.target.checked),withMessageText:!0}})})},t.use("me_settings_reaction_notifications")))))},q=({folders:e,recommendedFolders:t,convos:s,locks:n,foldersView:a})=>r.createElement(E.FoldersSettings,{convos:s,locks:n,folders:e,recommendedFolders:t,foldersView:a}),B=({themeControl:e})=>{const{lang:t,vkIntegration:s}=(0,f.useBrowserEnv)(),{settings:n}=(0,f.useViewer)(),a=(0,f.useDispatch)(),o=(0,f.useFeatureFlags)(),i=s&&!!o.vkm_bubble_theme_default_value,c=(0,T.useUniqId)();return r.createElement(r.Fragment,null,(e||i)&&r.createElement(_.FieldGroup,{title:t.use("me_settings_theme_title")},e&&r.createElement(_.FieldGroupItem,{after:r.createElement(j,{theme:n.theme,onChange:e=>a({type:"SettingThemeUpdated",value:e})})},t.use("me_settings_theme")),i&&r.createElement(_.FieldGroupItem,{after:r.createElement(p.Switch,{checked:"enabled"===n.bubblesTheme||1===o.vkm_bubble_theme_default_value&&"default"===n.bubblesTheme,onChange:e=>a({type:"UserChangedBubblesTheme",value:e.target.checked?"enabled":"disabled"})})},t.use("me_settings_bubbles_theme"))),o.vkm_reactions&&r.createElement(_.FieldGroup,{title:t.use("me_settings_message_reactions_title")},r.createElement(_.FieldGroupItem,{id:c,after:r.createElement(p.Switch,{checked:n.messageReactionAnimation,"aria-labelledby":c,onChange:e=>a({type:"UserChangedSetting",setting:"messageReactionAnimation",value:Boolean(e.target.checked)})})},t.use("me_settings_message_reactions_animation"))))},D=({onLogout:e})=>{const t=(0,k.useModal)(),[s,a]=(0,r.useState)(!1),[o,i]=(0,r.useState)(!1),c=(0,f.useFeatureFlags)(),{lang:d,uploader:u,api:h}=(0,f.useBrowserEnv)(),m=(0,f.useDispatch)(),{viewer:g,profileInfo:{phoneNumber:E,id:b,firstName:w,lastName:S,screenName:F,avatarPhoto:U}}=(0,f.useViewer)(),[N,T]=(0,r.useState)(),x=(0,r.useMemo)((()=>{var e;return null==(e=E)?void 0:e.replace(/\*/g,"•")}),[E]),O=(0,r.useMemo)((()=>g.photoId&&Number(g.photoId)),[g.photoId]),L=(0,r.useCallback)((0,n._)((function*(){try{const[e,t]=yield h.fetchMany([{method:"account.getProfileInfo",params:{}},{method:"users.get",params:{user_ids:M.toRealId(b).toString(),extended:1}}]),s=(0,A.fromApiViewerProfileInfo)(e),n=t[0],{user:r}=n?(0,P.fromApiUser)(n):{};m({type:"UserProfileInfo_Update",profileInfo:s,user:r})}catch(e){}})),[b,m,h]),q=(0,n._)((function*(){i(!0);try{yield h.fetch("photos.delete",{photo_id:Number(O),owner_id:b}),yield L()}catch(e){}finally{i(!1)}})),B=(0,n._)((function*(){var e;if("preview"===(null==(e=N)?void 0:e.kind)&&N.photo){a(!0);try{yield new Promise(((e,t)=>{u.uploadFiles([N.photo],{asOwnerPhoto:!0},{viewerId:b},{onUploadFinish:e,onError:t})})),yield L()}catch(e){}finally{a(!1)}}})),D=(0,n._)((function*(e){T({kind:"preview",photo:e})}));return(0,r.useEffect)((()=>{T(U?{kind:"current"}:void 0)}),[U]),r.createElement(r.Fragment,null,r.createElement("div",{className:"SettingsContent__avatar"},r.createElement(C.AvatarSelector,{isLoading:s||o,key:U,size:80,onSelection:D,onRemove:()=>{var e,t;"current"===(null==(e=N)?void 0:e.kind)&&O?q():"preview"===(null==(t=N)?void 0:t.kind)&&T(U?{kind:"current"}:void 0)},onUpload:B,peerId:b,isDisabled:s||o})),r.createElement(_.FieldGroup,null,r.createElement(_.FieldGroupItem,{subtitle:x,after:r.createElement(p.Button,{Component:v.ExternalLink,href:`${R.ID_VK_COM_BASE}/account/#/personal`,target:"_blank",mode:"tertiary"},d.use("me_change_in_vkid"))},w," ",S),c.vkm_profile_info_screen_name?r.createElement(r.Fragment,null,r.createElement(p.Spacing,{size:0},r.createElement(p.Separator,{wide:!0})),r.createElement(_.FieldGroupItem,{subtitle:r.createElement("span",{className:"SettingsContent__accent"},"@",F),after:r.createElement(p.Button,{mode:"tertiary",onClick:t.open},d.use("me_edit"))},d.use("me_profile_info_shortname"))):null),r.createElement(_.FieldGroup,null,r.createElement(_.FieldGroupItem,{hasActive:!0,hasHover:!0,before:r.createElement(l.Icon24DoorArrowRightOutline,null),onClick:e},d.use("me_account_logout"))),t.isActive&&r.createElement(I.ModalInterface,{onClose:t.close,closeLabel:d.use("me_close"),backLabel:d.use("me_back"),title:d.use("me_account_editing"),withCustomLayout:!0},r.createElement(y.ProfileInfoModal,{isVKIDHidden:!0,onBack:t.close})))},z=()=>{const{lang:e,api:t}=(0,f.useBrowserEnv)(),{viewer:s,profileType:a,settings:o}=(0,f.useViewer)(),{vkm_edu_profile_organizations:i}=(0,f.useFeatureFlags)(),c=S.isEdu(a),[l,u]=(0,r.useState)(null),h=(0,r.useCallback)((0,n._)((function*(){if(i)try{const e=yield t.fetch("messages.getEduUserOrganizations",{edu_user_id:s.id}),n=[];e.organizations.forEach((e=>{const t=(0,N.fromApiOrganization)(e);t&&n.push(t)})),u(n)}catch(e){}})),[i,t,s.id,u]);return(0,r.useEffect)((()=>{c&&h()}),[c,h]),r.createElement(r.Fragment,null,o.teacherVerification&&r.createElement(_.FieldGroup,null,r.createElement(_.FieldGroupItem,{after:r.createElement(v.ExternalLink,{href:R.SFERUM_VERIFICATION_LINK,className:"SettingsContent__link"},e.use("me_settings_teacher_verification_link"))},e.use("me_settings_edu_role"))),i&&l&&l.length>0&&r.createElement(_.FieldGroup,{title:e.use("me_settings_edu_organizations")},l.map((e=>r.createElement(_.FieldGroupItem,{key:e.name,subtitle:e.userRole.title,before:r.createElement(d.Icon28SchoolOutline,{className:"SettingsEdu__icon"})},e.name)))))},H=()=>{const{lang:e}=(0,f.useBrowserEnv)(),{settings:t}=(0,f.useViewer)(),s=(0,f.useFeatureFlags)(),n=(0,f.useDispatch)(),a=(()=>{switch(t.messageSelfMentionHighlighting){case"none":return e.use("me_settings_mention_off");case"primary":return e.use("me_settings_mention_simple");case"secondary":return e.use("me_settings_mention_calm");case"tertiary":return e.use("me_settings_mention_special");default:(0,w.exhaustivenessCheck)(t.messageSelfMentionHighlighting)}})(),o=e=>{n({type:"SettingExperimentalUpdated",messageMentionHighlighting:e})};return r.createElement(_.FieldGroup,null,r.createElement(_.FieldGroupItem,{after:r.createElement(F.Dropdown,{openType:"click",hideOnClick:!0,content:r.createElement(b.ActionsMenu,null,r.createElement(b.ActionsMenuAction,{onClick:()=>o("none"),title:e.use("me_settings_mention_off"),rightIcon:r.createElement(u.Icon16Done,{style:{visibility:"none"===t.messageSelfMentionHighlighting?"visible":"hidden"}}),type:"primary"}),r.createElement(b.ActionsMenuAction,{onClick:()=>o("primary"),title:e.use("me_settings_mention_simple"),rightIcon:r.createElement(u.Icon16Done,{style:{visibility:"primary"===t.messageSelfMentionHighlighting?"visible":"hidden"}}),type:"primary"}),r.createElement(b.ActionsMenuAction,{onClick:()=>o("secondary"),title:e.use("me_settings_mention_calm"),rightIcon:r.createElement(u.Icon16Done,{style:{visibility:"secondary"===t.messageSelfMentionHighlighting?"visible":"hidden"}}),type:"primary"}),s.vkm_mention_highlight_tertiary&&r.createElement(b.ActionsMenuAction,{onClick:()=>o("tertiary"),title:e.use("me_settings_mention_special"),rightIcon:r.createElement(u.Icon16Done,{style:{visibility:"tertiary"===t.messageSelfMentionHighlighting?"visible":"hidden"}}),type:"primary"})),align:"right",position:"bottom"},r.createElement(p.Button,{mode:"tertiary",after:r.createElement(h.Icon12Dropdown,null)},r.createElement(p.Text,{className:"SettingsContent__drop-down-text"},a)))},e.use("me_settings_message_mention_highlighting")),r.createElement(p.Spacing,{size:0},r.createElement(p.Separator,{wide:!0})),r.createElement(_.FieldGroupItem,{after:r.createElement(p.Switch,{checked:t.autoExtendReactionPicker,onChange:e=>{n({type:"UserChangedSetting",setting:"autoExtendReactionPicker",value:e.target.checked})}})},e.use("me_settings_auto_expand_all_reactions")))},G=({isCtrSubmitSelected:e,onChange:t})=>{const{lang:s}=(0,f.useBrowserEnv)(),n="Enter",a=U.isMac?"Cmd + Enter":"Ctrl + Enter",o=e?a:n;return r.createElement(F.Dropdown,{openType:"click",hideOnClick:!0,content:r.createElement(b.ActionsMenu,null,r.createElement(b.ActionsMenuAction,{onClick:()=>t(!1),title:n,subtitle:s.use("me_settings_message_submit_option_default_note"),rightIcon:r.createElement(u.Icon16Done,{style:{visibility:e?"hidden":"visible"}}),type:"primary"}),r.createElement(b.ActionsMenuAction,{onClick:()=>t(!0),title:a,subtitle:s.use("me_settings_message_submit_option_ctr_note"),rightIcon:r.createElement(u.Icon16Done,{style:{visibility:e?"visible":"hidden"}}),type:"primary"})),align:"right",position:"bottom"},r.createElement(p.Button,{mode:"tertiary",after:r.createElement(h.Icon12Dropdown,null)},r.createElement(p.Text,{className:"SettingsContent__drop-down-text"},o)))},V=({isRightClickActionsEnabled:e,onChange:t})=>{const{lang:s}=(0,f.useBrowserEnv)(),n=e?s.use("me_settings_message_actions_control_context_menu"):s.use("me_settings_message_actions_control_button");return r.createElement(F.Dropdown,{openType:"click",hideOnClick:!0,content:r.createElement(b.ActionsMenu,null,r.createElement(b.ActionsMenuAction,{onClick:()=>t(!1),title:s.use("me_settings_message_actions_control_button"),rightIcon:r.createElement(u.Icon16Done,{style:{visibility:e?"hidden":"visible"}}),type:"primary"}),r.createElement(b.ActionsMenuAction,{onClick:()=>t(!0),title:s.use("me_settings_message_actions_control_context_menu"),rightIcon:r.createElement(u.Icon16Done,{style:{visibility:e?"visible":"hidden"}}),type:"primary"})),align:"right",position:"bottom"},r.createElement(p.Button,{mode:"tertiary",after:r.createElement(h.Icon12Dropdown,null)},r.createElement(p.Text,{className:"SettingsContent__drop-down-text"},n)))},W=({browserNotifications:e,ariaLabelledby:t})=>{const s=(0,f.useDispatch)(),{settings:n}=(0,f.useViewer)(),{lang:a}=(0,f.useBrowserEnv)();return"external"===n.browserNotifications?r.createElement(p.Button,{mode:"tertiary",after:r.createElement(m.Icon12Chevron,null),onClick:e.onExternal},a.use("me_settings_browser_notifications_external")):r.createElement(p.Switch,{checked:n.browserNotifications,"aria-labelledby":t,onChange:t=>e.onChange(Boolean(t.target.checked)).then((e=>s({type:"UserChangedBrowserNotifications",value:e})))})},K=["system","light","dark"],j=({theme:e,onChange:t})=>{const{lang:s}=(0,f.useBrowserEnv)();return r.createElement(F.Dropdown,{openType:"click",hideOnClick:!0,content:r.createElement(b.ActionsMenu,null,K.map((n=>r.createElement(b.ActionsMenuAction,{key:n,onClick:()=>t(n),title:s.use(`me_settings_theme_${n}`),rightIcon:r.createElement(u.Icon16Done,{style:{visibility:e===n?"visible":"hidden"}}),type:"primary"})))),align:"right",position:"bottom"},r.createElement(p.Button,{mode:"tertiary",after:r.createElement(h.Icon12Dropdown,null)},r.createElement(p.Text,{className:"SettingsContent__drop-down-text"},s.use(`me_settings_theme_${e}`))))},Z=({activeSection:e,convos:t,locks:s,folders:n,recommendedFolders:a,foldersView:o})=>{const i=(0,r.useMemo)((()=>{switch(e){case"account":case"edu":case"about":return null;case"main":return r.createElement(O,null);case"folders":return r.createElement(q,{folders:n,recommendedFolders:a,convos:t,locks:s,foldersView:o});case"notifications":return r.createElement(L,{countOnlyNotMutedControl:!0});case"theme":return r.createElement(B,null);case"experimental":return r.createElement(H,null);default:(0,w.exhaustivenessCheck)(e)}}),[a,e,t,n,o,s]);return r.createElement("div",{className:"SettingsContent"},r.createElement("div",{className:"SettingsContent__body"},i))}},635402:(e,t,s)=>{"use strict";s.d(t,{SettingsMenu:()=>M,VKCOMSettingsMenu:()=>S});var n=s(434788),r=(s(661342),s(667294)),a=s(532048),o=s(294184),i=s.n(o),c=s(387613),l=s(96715),d=s(354819),u=s(784118),h=s(661620),m=s(707599),p=s(644695),f=s(77199),g=s(820210),v=s(735166),_=s(86894),C=s(696023),y=s(988994),k=s(597298),I=s(709646),E=s(611654),b=s(421199),w=s(89131);const M=({route:e})=>{var t;const{mode:s}=(0,y.useLayoutData)(),{lang:o,router:v}=(0,C.useBrowserEnv)(),{profileInfo:E,profileType:M,viewer:S}=(0,C.useViewer)(),R=(0,C.useFeatureFlags)(),A=(0,r.useMemo)((()=>{var e,t;return null==(t=E)||null==(e=t.phoneNumber)?void 0:e.replace(/\*/g,"•")}),[null==(t=E)?void 0:t.phoneNumber]),P=I.isEdu(M),F=(0,b.useUniqId)(),U=t=>{const n={className:"SettingsMenu__item",onClick:()=>v.push({kind:"SettingsRoute",section:t})};switch(t){case"main":n.className=i()(n.className,{"SettingsMenu__item--active":"two-column"===s&&!e.section||"main"===e.section});break;case"account":case"about":case"edu":case"experimental":case"folders":case"notifications":case"theme":n.className=i()(n.className,{"SettingsMenu__item--active":e.section===t});break;default:(0,w.exhaustivenessCheck)(t)}return n};return r.createElement(a.ScrollbarProvider,{className:i()("SettingsMenu",{"SettingsMenu--mobile":"one-column"===s}),overflowX:"hidden"},r.createElement(_.Group,{"aria-labelledby":F,className:"SettingsMenu__group",mode:"card",separator:"auto",padding:"m",header:r.createElement(_.PanelHeader,{fixed:!1,separator:!1,transparent:!0,before:r.createElement(_.Button,{mode:"tertiary",size:"l",before:r.createElement(c.Icon24Back,{fill:"var(--vkui--color_text_secondary)"}),Component:k.Link,to:"two-column"!==s&&e.section&&"main"!==e.section?{kind:"SettingsRoute"}:{kind:"MainRoute"}}),className:"SettingsMenu__header"},r.createElement(_.Title,{level:"3"},o.use("me_route_settings")))},r.createElement(_.Separator,{wide:!0,className:"SettingsMenu__separator"}),r.createElement(_.Spacing,{size:4}),r.createElement(_.SimpleCell,(0,n._)({},U("account"),{before:r.createElement(_.Avatar,{className:"Settings__profileAvatar",size:48,src:E.avatarPhoto}),subtitle:P?r.createElement(r.Fragment,null,r.createElement("div",null,o.use("me_route_settings_edu_profile_id",{num:S.id})),r.createElement("div",{className:"SettingsMenu__accent"},o.use("me_route_settings_edu_profile_sferum"))):r.createElement(r.Fragment,null,A&&r.createElement("div",null,A),E.screenName&&r.createElement("div",{className:"SettingsMenu__accent"},"@",E.screenName))}),P?r.createElement("p",{className:"SettingsMenu__name"},r.createElement("span",null,E.lastName," ",E.firstName," ",E.nickName),S.isVerified&&r.createElement(d.Icon16Education,{className:"SettingsMenu__accent"})):r.createElement("p",{className:"SettingsMenu__name"},r.createElement("span",null,E.firstName," ",E.lastName),S.isVerified&&r.createElement(l.Icon16Verified,{className:"SettingsMenu__accent"}))),r.createElement(_.SimpleCell,(0,n._)({},U("main"),{before:r.createElement(u.Icon20GearOutline,null)}),o.use("me_settings_menu_main")),r.createElement(_.SimpleCell,(0,n._)({},U("folders"),{before:r.createElement(h.Icon20FolderOutline,null)}),o.use("me_settings_menu_folders")),r.createElement(_.Spacing,{size:1}),r.createElement(_.Separator,{wide:!0,className:"SettingsMenu__separator"}),r.createElement(_.Spacing,{size:1}),r.createElement(_.SimpleCell,(0,n._)({},U("notifications"),{before:r.createElement(m.Icon20NotificationOutline,null)}),o.use("me_settings_menu_notifications")),r.createElement(_.SimpleCell,(0,n._)({},U("theme"),{before:r.createElement(p.Icon20PalleteOutline,null)}),o.use("me_settings_menu_theme")),R.vkm_settings_experimental&&r.createElement(_.SimpleCell,(0,n._)({},U("experimental"),{before:r.createElement(f.Icon20Stars,null)}),o.use("me_settings_menu_experimental")),P&&r.createElement(r.Fragment,null,r.createElement(_.Spacing,{size:1}),r.createElement(_.Separator,{wide:!0}),r.createElement(_.Spacing,{size:1}),r.createElement(_.SimpleCell,(0,n._)({},U("edu"),{before:r.createElement(g.Icon20EducationOutline,null)}),o.use("me_settings_menu_edu_role")))))},S=({activeSection:e})=>{const{lang:t,router:s}=(0,C.useBrowserEnv)(),n=(0,C.useFeatureFlags)(),a=(0,r.useCallback)((e=>{"back"!==e?s.push({kind:"SettingsRoute",section:e}):s.push({kind:"MainRoute"})}),[s]),o=(0,r.useMemo)((()=>{const e=[{type:"item",id:"back",before:r.createElement(v.Icon20ArrowLeftOutline,{fill:"var(--vkui--color_icon_secondary)"}),label:t.use("me_return_in_messenger")},{type:"separator"},{type:"item",id:"main",before:r.createElement(u.Icon20GearOutline,{fill:"var(--vkui--color_icon_secondary)"}),label:t.use("me_settings_menu_main")},{type:"item",id:"folders",before:r.createElement(h.Icon20FolderOutline,{fill:"var(--vkui--color_icon_secondary)"}),label:t.use("me_settings_menu_folders")},{type:"separator"},{type:"item",id:"notifications",before:r.createElement(m.Icon20NotificationOutline,{fill:"var(--vkui--color_icon_secondary)"}),label:t.use("me_settings_menu_notifications")}];return n.vkm_reactions&&e.push({type:"item",id:"theme",before:r.createElement(p.Icon20PalleteOutline,{fill:"var(--vkui--color_icon_secondary)"}),label:t.use("me_settings_menu_theme")}),n.vkm_settings_experimental&&e.push({type:"item",id:"experimental",before:r.createElement(f.Icon20Stars,{fill:"var(--vkui--color_icon_secondary)"}),label:t.use("me_settings_menu_experimental")}),e}),[n.vkm_reactions,n.vkm_settings_experimental,t]);return r.createElement(E.RightMenu,{className:"VKCOMSettingsMenu",selectedId:e,items:o,onSelect:a})}},129879:(e,t,s)=>{"use strict";s.d(t,{Snackbar:()=>l});s(168577);var n=s(667294),r=s(294184),a=s.n(r),o=s(367763),i=s(86894),c=s(513698);const l=(0,n.memo)((({message:e,layout:t="horizontal",action:s,before:r,after:l,duration:d=4e3,onActionClick:u,onClose:h,mode:m="default",className:p,stopOnHover:f=!0,isManuallyClosable:g=!1,autoClose:v=!0,requestClose:_=!1,onRequestRemove:C})=>{const{isTouchOnly:y}=(0,o.useDeviceData)(),[k,I]=(0,n.useState)(d);(0,n.useEffect)((()=>{I(d)}),[d]);const E=(0,n.useRef)((()=>{}));E.current=()=>{var e;C(),null==(e=h)||e()};(0,n.useEffect)((()=>{if(null==k||!v)return;let e=null;return e=window.setTimeout((()=>{E.current()}),k),()=>{e&&window.clearTimeout(e)}}),[v,k]),(0,n.useEffect)((()=>{_&&E.current()}),[_]);const b=l||!y?"vertical":t;return n.createElement("div",{className:a()("Snackbar",`Snackbar--layout-${b}`,`Snackbar--mode-${m}`,p),onMouseEnter:()=>{f&&I(null)},onMouseLeave:()=>{f&&I(d)}},n.createElement("div",{className:"Snackbar__body"},r&&n.createElement("div",{className:"Snackbar__before"},r),n.createElement("div",{className:"Snackbar__content"},n.createElement(i.Paragraph,{className:"Snackbar__content-text"},e),s&&n.createElement(i.Button,{align:"left",hasHover:!1,mode:"tertiary",appearance:"dark"===m?"overlay":"accent",size:"s",className:"Snackbar__action",onClick:e=>{var t;(E.current(),s)&&(null==(t=u)||t(e))}},s)),l&&n.createElement("div",{className:"Snackbar__after"},l)),g&&n.createElement(i.Button,{onClick:E.current,after:n.createElement(c.Icon12Cancel,null),mode:"tertiary",appearance:"dark"===m?"overlay":"neutral",size:"s",className:"Snackbar__close"}))}))},814640:(e,t,s)=>{"use strict";s.d(t,{SnackbarContainer:()=>o});var n=s(434788),r=s(667294),a=s(355795);s(980160);const o=({withPortal:e=!0,portalProps:t={portalClassName:"MEConfig SnackbarModal"},children:s})=>r.createElement(i,{withPortal:e,portalProps:t},r.createElement("div",{className:"SnackbarContainer"},s)),i=(0,r.memo)((({withPortal:e,children:t,portalProps:s})=>e?r.createElement(a.Portal,(0,n._)({},s),t):r.createElement(r.Fragment,null,t)))},545443:(e,t,s)=>{"use strict";s.d(t,{Symbols:()=>r});s(516073);var n=s(667294);const r=()=>n.createElement("svg",{className:"Symbols"},n.createElement("defs",null,n.createElement("symbol",{id:"mePhone10"},n.createElement("path",{d:"M6.17 6.8c1.1-1.09 2.32-.5 3.3.33 1.15.97.26 2.7-1.08 2.83-1.82.24-3.72-.63-5.72-2.63-2-2-2.88-3.91-2.63-5.73C.16.27 1.91-.62 2.87.52c.82.98 1.41 2.2.32 3.3-.9.9-.16 1.55.64 2.35s1.45 1.53 2.34.64z"})),n.createElement("symbol",{id:"meExpand"},n.createElement("path",{d:"M15.7688 13.7067L11.906 10L15.7688 6.29326C16.0771 5.99741 16.0771 5.51774 15.7688 5.22189C15.4605 4.92604 14.9606 4.92604 14.6523 5.22189L10.2312 9.46431C9.92292 9.76017 9.92292 10.2398 10.2312 10.5357L14.6523 14.7781C14.9606 15.074 15.4605 15.074 15.7688 14.7781C16.0771 14.4823 16.0771 14.0026 15.7688 13.7067Z"}),n.createElement("path",{d:"M9.76877 13.7067L5.90596 10L9.76877 6.29326C10.0771 5.99741 10.0771 5.51774 9.76877 5.22189C9.46046 4.92604 8.96059 4.92604 8.65228 5.22189L4.23123 9.46431C3.92292 9.76017 3.92292 10.2398 4.23123 10.5357L8.65228 14.7781C8.96059 15.074 9.46046 15.074 9.76877 14.7781C10.0771 14.4823 10.0771 14.0026 9.76877 13.7067Z"})),n.createElement("symbol",{id:"meCake10"},n.createElement("path",{d:"M9.16667 8.07392C8.33947 8.29895 7.41292 8.1867 6.66667 7.73385C5.66596 8.34111 4.33404 8.34111 3.33333 7.73385C2.58708 8.1867 1.66053 8.29895 0.833333 8.07392V9.09126C0.833333 9.59314 1.20643 10 1.66667 10H8.33333C8.79357 10 9.16667 9.59314 9.16667 9.09126V8.07392Z"}),n.createElement("path",{d:"M0 5.00191C0 4.50003 0.373096 4.09317 0.833333 4.09317H9.16667C9.6269 4.09317 10 4.50003 10 5.00191C10 6.36503 9.16667 6.8194 8.33333 6.8194C7.08333 6.8194 6.66667 5.91065 6.66667 5.91065C6.66667 5.91065 6.25 6.8194 5 6.8194C3.75 6.8194 3.33333 5.91065 3.33333 5.91065C3.33333 5.91065 2.91667 6.8194 1.66667 6.8194C0.833333 6.8194 0 6.36503 0 5.00191Z"}),n.createElement("path",{d:"M7.83935 0.0492567C7.87234 -0.0164189 7.96099 -0.0164189 7.99398 0.0492567C8.38334 0.824332 8.75 1.16164 8.75 1.82131C8.75 2.32319 8.3769 2.73005 7.91667 2.73005C7.45643 2.73005 7.08333 2.32319 7.08333 1.82131C7.08333 1.16164 7.44999 0.824332 7.83935 0.0492567Z"}),n.createElement("path",{d:"M2.00602 0.0492567C2.03901 -0.0164189 2.12766 -0.0164189 2.16065 0.0492567C2.55001 0.824332 2.91667 1.16164 2.91667 1.82131C2.91667 2.32319 2.54357 2.73005 2.08333 2.73005C1.6231 2.73005 1.25 2.32319 1.25 1.82131C1.25 1.16164 1.61665 0.824332 2.00602 0.0492567Z"}),n.createElement("path",{d:"M4.92268 0.0492567C4.95568 -0.0164189 5.04432 -0.0164189 5.07732 0.0492567C5.46668 0.824332 5.83333 1.16164 5.83333 1.82131C5.83333 2.32319 5.46024 2.73005 5 2.73005C4.53976 2.73005 4.16667 2.32319 4.16667 1.82131C4.16667 1.16164 4.53332 0.824332 4.92268 0.0492567Z"}))),n.createElement("circle",{id:"mePeerFrameOffline20",cx:"10",cy:"10",r:"10"}),n.createElement("path",{id:"mePeerFrameMe24",d:"M20 10a12 12 0 10-9.9 9.9 7 7 0 019.9-9.9z"}),n.createElement("circle",{id:"mePeerFrameOffline24",cx:"12",cy:"12",r:"12"}),n.createElement("path",{id:"mePeerFrameOnline24",d:"M23.57 15.18A12.02 12.02 0 0012 0a12 12 0 103.18 23.57 6 6 0 018.4-8.4z"}),n.createElement("path",{id:"mePeerFrameMobile24",d:"M14.08 23.82a12 12 0 119.9-12.29 3.98 3.98 0 00-1.98-.53h-4a4 4 0 00-4 4v8c0 .28.03.56.08.82z"}),n.createElement("path",{id:"mePeerFrameMe24",d:"M23.84 13.95a12 12 0 10-9.9 9.9 7 7 0 019.9-9.9z"}),n.createElement("circle",{id:"mePeerFrameOffline32",cx:"16",cy:"16",r:"16"}),n.createElement("path",{id:"mePeerFrameOnline32",d:"M30.72 22.29a16 16 0 10-8.43 8.43 6 6 0 018.43-8.43z"}),n.createElement("path",{id:"mePeerFrameMobile32",d:"M21 31.2a16 16 0 1110.52-11.3A3.98 3.98 0 0029 19h-4a4 4 0 00-4 4v8.2z"}),n.createElement("path",{id:"mePeerFrameMe32",d:"M31.1 21.32a16 16 0 10-9.77 9.77 7 7 0 019.77-9.77z"}),n.createElement("path",{id:"mePeerFrameMe32c",d:"M18.1533 0.143651C17.449 0.0489165 16.7302 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32C17.8656 32 19.6565 31.6807 21.3213 31.0938C20.4899 29.9426 20 28.5285 20 27C20 24.8923 20.9316 23.0021 22.4054 21.7188C17.0253 20.533 13 15.7366 13 10C13 5.91761 15.0386 2.31134 18.1533 0.143651ZM30.2451 20.796C30.5411 20.9512 30.8247 21.1269 31.0938 21.3213C31.2337 20.9244 31.3584 20.5204 31.4672 20.1099C31.0749 20.3614 30.6669 20.5907 30.2451 20.796Z"}),n.createElement("path",{id:"mePeerFrameMobile32c",d:"M18.1533 0.143651C17.449 0.0489165 16.7302 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32C17.748 32 19.4305 31.7197 21.005 31.2016C21.0017 31.1348 21 31.0676 21 31V23C21 22.4411 21.1146 21.9089 21.3217 21.4257C16.4937 19.8727 13 15.3443 13 10C13 5.91761 15.0386 2.31134 18.1533 0.143651Z"}),n.createElement("path",{id:"mePeerFrameOffline32c",d:"M31.47 20.11A12 12 0 0118.16.14a16 16 0 1013.31 19.97z"}),n.createElement("path",{id:"mePeerFrameOnline32c",d:"M18.1533 0.143651C17.449 0.0489165 16.7302 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32C18.2328 32 20.3588 31.5426 22.2893 30.7165C21.4819 29.6945 21 28.4035 21 27C21 24.8726 22.1072 23.0038 23.7767 21.9384C17.7239 21.3256 13 16.2145 13 10C13 5.91761 15.0386 2.31134 18.1533 0.143651ZM28.9655 21.3293C29.6052 21.551 30.1958 21.8779 30.7165 22.2893C31.0169 21.5873 31.2686 20.8594 31.4672 20.1099C30.6899 20.6082 29.8514 21.0192 28.9655 21.3293Z"}),n.createElement("circle",{id:"mePeerFrameOffline36",cx:"18",cy:"18",r:"18"}),n.createElement("circle",{id:"mePeerFrameOffline40",cx:"20",cy:"20",r:"20"}),n.createElement("path",{id:"mePeerFrameOnline40",d:"M29.29 37.72a20 20 0 118.43-8.43 5.99 5.99 0 10-8.43 8.43z"}),n.createElement("path",{id:"mePeerFrameMobile40",d:"M28.2 38.25a20 20 0 1110.78-11.92A3.99 3.99 0 0036 25h-4a4 4 0 00-4 4v8a4 4 0 00.2 1.25z"}),n.createElement("path",{id:"mePeerFrameMe40",d:"M28.31 38.2a20 20 0 119.89-9.89 7 7 0 10-9.89 9.89z"}),n.createElement("path",{id:"mePeerFrameMe40c",d:"M33 22c2.61 0 5.03-.83 7-2.25V20c0 2.97-.65 5.78-1.8 8.31a7 7 0 10-9.89 9.89A20 20 0 1125.38.73 12 12 0 0033 22z"}),n.createElement("path",{id:"mePeerFrameMobile40c",d:"M33 22c2.61 0 5.03-.83 7-2.25V20c0 2.21-.36 4.34-1.02 6.33A3.99 3.99 0 0036 25h-4a4 4 0 00-4 4v8a4 4 0 00.2 1.25A20 20 0 1125.38.73 12 12 0 0033 22z"}),n.createElement("path",{id:"mePeerFrameOffline40c",d:"M40 19.75A12 12 0 0125.38.73 20.02 20.02 0 000 20a20 20 0 1040-.25z"}),n.createElement("path",{id:"mePeerFrameOnline40c",d:"M33 22c2.61 0 5.03-.83 7-2.25V20c0 3.35-.83 6.51-2.28 9.29a5.99 5.99 0 10-8.43 8.43A20 20 0 1125.38.74 12 12 0 0033 22z"}),n.createElement("circle",{id:"mePeerFrameOffline44",cx:"22",cy:"22",r:"22"}),n.createElement("path",{id:"mePeerFrameOnline44",d:"M41.21 32.73a22 22 0 10-8.49 8.49 6 6 0 018.49-8.49z"}),n.createElement("path",{id:"mePeerFrameMobile44",d:"M31.13 42.02a22 22 0 1111.1-11.37A4 4 0 0039 29h-4a4 4 0 00-4 4v8c0 .35.05.7.13 1.02z"}),n.createElement("path",{id:"mePeerFrameMe44",d:"M41.7 31.81a22 22 0 10-9.89 9.89 7 7 0 019.89-9.89z"}),n.createElement("path",{id:"mePeerFrameOffline44c",d:"M43.97 20.77A12 12 0 0129.78 1.41a22 22 0 1014.19 19.36z"}),n.createElement("path",{id:"mePeerFrameOnline44c",d:"M29.78 1.41a22 22 0 102.95 39.8 6 6 0 018.49-8.49 21.9 21.9 0 002.75-11.95A12 12 0 0129.78 1.41z"}),n.createElement("path",{id:"mePeerFrameMobile44c",d:"M43.97 20.77A12 12 0 0129.78 1.41a22 22 0 101.35 40.6 4 4 0 01-.13-1.01v-8a4 4 0 014-4h4a4 4 0 013.24 1.65 21.93 21.93 0 001.73-9.88z"}),n.createElement("path",{id:"mePeerFrameMe44c",d:"M29.78 1.41A22 22 0 1031.8 41.7a7 7 0 019.89-9.89 21.91 21.91 0 002.27-11.03A12 12 0 0129.78 1.41z"}),n.createElement("circle",{id:"mePeerFrameOffline46",cx:"23",cy:"23",r:"23"}),n.createElement("path",{id:"mePeerFrameOnline46",d:"M42.94 34.47a23 23 0 10-8.47 8.47 6 6 0 018.47-8.47z"}),n.createElement("path",{id:"mePeerFrameMobile46",d:"M33.06 43.69A23 23 0 1144 32.37 3.99 3.99 0 0041 31h-4a4 4 0 00-4 4v8c0 .24.02.47.06.69z"}),n.createElement("path",{id:"mePeerFrameMe46",d:"M43.43 33.58a23 23 0 10-9.85 9.85 7 7 0 019.85-9.85z"}),n.createElement("path",{id:"mePeerFrameOffline46c",d:"M45.9 20.82A12 12 0 0131.5 1.62a23 23 0 1014.39 19.2z"}),n.createElement("path",{id:"mePeerFrameOnline46c",d:"M31.5 1.63a23 23 0 102.96 41.31 6 6 0 018.47-8.47 22.9 22.9 0 002.97-13.65A12 12 0 0131.5 1.62z"}),n.createElement("path",{id:"mePeerFrameMobile46c",d:"M45.9 20.82A12 12 0 0131.5 1.62a23 23 0 101.55 42.06A4.03 4.03 0 0133 43v-8a4 4 0 014-4h4c1.2 0 2.28.53 3.01 1.37a22.92 22.92 0 001.89-11.55z"}),n.createElement("path",{id:"mePeerFrameMe46c",d:"M31.5 1.63a23 23 0 102.07 41.8 7 7 0 019.85-9.85 22.9 22.9 0 002.48-12.76A12 12 0 0131.5 1.62z"}),n.createElement("circle",{id:"mePeerFrameOffline48",cx:"24",cy:"24",r:"24"}),n.createElement("path",{id:"mePeerFrameOnline48",d:"M44.65 36.2375C46.7781 32.6543 48 28.4699 48 24 48 10.7452 37.2548 0 24 0S0 10.7452 0 24s10.7452 24 24 24c4.4699 0 8.6543-1.2219 12.2375-3.35C35.4614 43.6388 35 42.3733 35 41c0-3.3137 2.6863-6 6-6 1.3733 0 2.6388.4614 3.65 1.2375Z"}),n.createElement("path",{id:"mePeerFrameMobile48",d:"M35.0134 45.3295C31.7149 47.0361 27.97 48 24 48 10.7452 48 0 37.2548 0 24S10.7452 0 24 0s24 10.7452 24 24c0 3.6139-.7987 7.0412-2.2293 10.115C45.0518 33.4245 44.0755 33 43 33h-4c-2.2091 0-4 1.7909-4 4v8c0 .1109.0045.2208.0134.3295Z"}),n.createElement("path",{id:"mePeerFrameMe48",d:"M45.1466 35.3598C46.967 31.9781 48 28.1097 48 24 48 10.7452 37.2548 0 24 0S0 10.7452 0 24s10.7452 24 24 24c4.1097 0 7.9781-1.033 11.3598-2.8534C34.5051 43.986 34 42.552 34 41c0-3.866 3.134-7 7-7 1.552 0 2.986.5051 4.1466 1.3598Z"}),n.createElement("path",{id:"mePeerFrameOffline48c",d:"M47.7535 20.5474c-1.9142 1.485-4.2861 2.3638-6.8546 2.3638-6.3513 0-11.5-5.3726-11.5-12 0-3.60133 1.5202-6.83209 3.9277-9.03164C30.4593.669186 27.3078 0 24 0 10.7452 0 0 10.7452 0 24s10.7452 24 24 24 24-10.7452 24-24c0-1.1724-.0841-2.3252-.2465-3.4526Z"}),n.createElement("path",{id:"mePeerFrameOnline48c",d:"M33.4417 1.92854C30.5438.687251 27.3522 0 24 0 10.7452 0 0 10.7452 0 24s10.7452 24 24 24c4.4699 0 8.6543-1.2219 12.2375-3.35C35.4614 43.6388 35 42.3733 35 41c0-3.3137 2.6863-6 6-6 1.3733 0 2.6388.4614 3.65 1.2375C46.7781 32.6543 48 28.4699 48 24c0-.9987-.061-1.9832-.1795-2.9499-1.8568 1.1786-4.0595 1.8611-6.4216 1.8611-6.6274 0-12-5.3726-12-12 0-3.57469 1.563-6.78427 4.0428-8.98266Z"}),n.createElement("path",{id:"mePeerFrameMobile48c",d:"M47.8002 20.8886C45.8673 22.2203 43.5247 23 41 23c-6.6274 0-12-5.3726-12-12 0-3.66964 1.6472-6.95456 4.2425-9.15573C30.3978.656185 27.2755 0 24 0 10.7452 0 0 10.7452 0 24s10.7452 24 24 24c3.97 0 7.7149-.9639 11.0134-2.6705C35.0045 45.2208 35 45.1109 35 45v-8c0-2.2091 1.7909-4 4-4h4c1.0755 0 2.0518.4245 2.7707 1.115C47.2013 31.0412 48 27.6139 48 24c0-1.0544-.068-2.0929-.1998-3.1114Z"}),n.createElement("path",{id:"mePeerFrameMe48c",d:"M33.4417 1.92854C30.5438.687251 27.3522 0 24 0 10.7452 0 0 10.7452 0 24s10.7452 24 24 24c4.1097 0 7.9781-1.033 11.3598-2.8534C34.5051 43.986 34 42.552 34 41c0-3.866 3.134-7 7-7 1.552 0 2.986.5051 4.1466 1.3598C46.967 31.9781 48 28.1097 48 24c0-.9987-.061-1.9832-.1795-2.9499-1.8568 1.1786-4.0595 1.8611-6.4216 1.8611-6.6274 0-12-5.3726-12-12 0-3.57469 1.563-6.78427 4.0428-8.98266Z"}),n.createElement("circle",{id:"mePeerFrameOffline72",cx:"37",cy:"37",r:"37"}),n.createElement("circle",{id:"mePeerFrameOffline92",cx:"46",cy:"46",r:"46"}),n.createElement("circle",{id:"mePeerFrameOffline96",cx:"48",cy:"48",r:"48"}),n.createElement("path",{id:"meUsersStack16",d:"M14 2.715A8 8 180 008 0 8 8 180 008 16 8 8 180 0014 13.285 8 8 180 0114 2.715"}),n.createElement("path",{id:"meUsersStack18",d:"M 16 14 A 9 9 90 0 1 9 18 A 9 9 90 0 1 9 0 A 9 9 90 0 1 16 4 A 9 9 90 0 0 16 14"}),n.createElement("path",{id:"meUsersStack24",d:"M22 18.6A12 12 0 0112 24 12 12 0 0112 0 12 12 0 0122 5.4 12 12 0 0022 18.6"}),n.createElement("path",{id:"meUsersStack32",d:"M30 23.8A16 16 0 0116 32 16 16 0 0116 0 16 16 0 0130 8.3 16 16 0 0030 23.8"}),n.createElement("path",{id:"meUsersStack40",d:"M37.5 29.8A20 20 90 0120 40 20 20 90 0120 0 20 20 90 0137.5 10.4 20 20 90 0037.5 29.8"}),n.createElement("path",{id:"meUsersStack44",d:"M41.3 32.7A22 22 90 0122 44 22 22 90 0122 0 22 22 90 0141.3 11.4 22 22 90 0041.3 32.7"}),n.createElement("path",{id:"meUsersStack46",d:"M43.1 34.2A23 23 90 0123 46 23 23 90 0123 0 23 23 90 0143.1 11.9 23 23 90 0043.1 34.2"}),n.createElement("path",{id:"meUsersStack48",d:"M44.9739 35.687c-2.0822 3.7346-5.1243 6.8452-8.8117 9.01C32.4747 46.8618 28.2759 48.0021 24 48c-6.3652 0-12.4697-2.5286-16.97056-7.0294C2.52856 36.4697 0 30.3652 0 24c0-6.3652 2.52856-12.4697 7.02944-16.97056C11.5303 2.52856 17.6348 0 24 0c4.2863.00824717 8.4922 1.16428 12.1806 3.34795 3.6884 2.18368 6.7247 5.31531 8.7933 9.06945-1.9734 3.5603-3.0088 7.5641-3.0088 11.6348 0 4.0706 1.0354 8.0744 3.0088 11.6348Z"}))},40803:(e,t,s)=>{"use strict";s.d(t,{TextWithEmoji:()=>i});var n=s(667294),r=s(468336),a=s(89131),o=s(337270);const i=({text:e})=>{const t=(0,r.toTextAndEmojiChunks)(e);return n.createElement(n.Fragment,null,t.map(((e,t)=>{switch(e.kind){case"Text":return e.text;case"Emoji":return n.createElement(o.Emoji,{emoji:e.text,key:t});default:return(0,a.exhaustivenessCheck)(e)}})))}},943997:(e,t,s)=>{"use strict";s.d(t,{Tooltip:()=>l});s(126449);var n=s(667294),r=s(294184),a=s.n(r),o=s(837492),i=s(696023),c=s(367763);const l=(0,n.forwardRef)((({children:e,content:t,disabled:s=!1,open:r=!1,onOpen:l,onClose:d,delay:u=50,backgroundColor:h,pointerEvents:m="none",showOnTouch:p=!1,align:f="auto",position:g="auto"},v)=>{const _=(0,i.useFeatureFlags)(),C=(0,c.useDeviceData)(),[y,k]=(0,n.useState)(r?"opened":"closed"),I=h||"rgba(0, 0, 0, 0.72)",E=(0,n.useRef)(null),b=(0,n.useRef)(null),w=(0,n.useRef)(null),M=()=>{b.current&&clearTimeout(b.current),w.current&&clearTimeout(w.current),b.current=w.current=null},S=(0,n.useCallback)((()=>{k("closed"),d&&d()}),[d]),R=(0,n.useCallback)((()=>{"opened"===y?(k("is_closing"),w.current=window.setTimeout(S,200)):S()}),[y,S]),A=(0,n.useCallback)((()=>{M(),b.current=window.setTimeout((()=>{k("opened"),l&&l()}),u)}),[u,l]),P=(0,n.useCallback)((()=>{M(),b.current=window.setTimeout(R,0)}),[R]);(0,n.useEffect)((()=>{const e=E.current;return e&&(e.addEventListener("mouseenter",A),e.addEventListener("mouseleave",P)),()=>{e&&(e.removeEventListener("mouseenter",A),e.removeEventListener("mouseleave",P))}}),[A,P]),(0,n.useEffect)((()=>M),[]),(0,i.useDidUpdate)((()=>{r?A():P()}),[r]);const F=n.createElement("div",{className:a()("METooltip",{"METooltip--removed":"is_closing"===y}),style:{"--tooltip_dark_background":I,pointerEvents:m}},t);return _.me_fc_tooltips?!p&&C.isTouchOnly?e:n.createElement(o.Popper,{content:F,open:!s&&"closed"!==y,ref:e=>{E.current=e,"function"==typeof v?v(e):v&&(v.current=e)},portalClassName:"MEConfig",mode:"side",align:f,position:g},e):e}))},546428:(e,t,s)=>{"use strict";s.d(t,{onElementKeyDownFactory:()=>r});var n=s(65970);const r=(e,t=!1)=>s=>{const r=(0,n.getKeyCombo)(s);!t&&(0,n.isGlobalKeyCombo)(r)||(0,n.isModuleKeyCombo)(r)&&(s.stopPropagation(),e(r,s.preventDefault.bind(s)))}},127848:(e,t,s)=>{"use strict";s.d(t,{checkEmojiSupportViaCss:()=>o,createEmojiElement:()=>c,getEmojiSupportFromCache:()=>i});var n=s(331092),r=s(15285);const a=new Map;function o(e){const{backgroundImage:t}=window.getComputedStyle(e),s=""!==t&&"none"!==t;return a.set(e.alt,s),s}function i(e){return a.has(e)?a.get(e)?"supported":"unsupported":"unknown"}function c(e){const t=document.createElement("img");let s;return t.classList.add("Emoji","@"+(0,n.unicodeToByteHex)(e)),t.src=r.emptyImage,t.alt=e,a.has(e)?s=!!a.get(e):(document.head.appendChild(t),s=o(t),t.remove()),s?t:document.createTextNode(e)}},698057:(e,t,s)=>{"use strict";s.d(t,{fromApiChatMembers:()=>r});var n=s(96190);function r(e){return e.reduce(((e,t)=>{if(t.incognito_id&&0===t.member_id)return e;const s=n.resolveId(t.member_id);if(!n.isUserPeerId(s)&&!n.isGroupPeerId(s)&&!n.isContactPeerId(s))return e;const r={isAdmin:Boolean(t.is_admin),isRestrictedToWrite:Boolean(t.is_restricted_to_write),canKick:Boolean(t.can_kick),isMessageRequest:Boolean(t.is_message_request),peerId:s};return t.is_message_request&&t.request_date&&(r.requestDate=1e3*t.request_date),t.join_date&&(r.joinDate=1e3*t.join_date),e.members.push(r),n.isContactPeerId(s)||(t.is_admin&&e.adminIds.push(s),t.is_owner&&(e.ownerId=s)),e}),{members:[],adminIds:[]})}},851828:(e,t,s)=>{"use strict";s.d(t,{fromApiComment:()=>u});var n=s(434788),r=s(866358),a=s(96190),o=s(86144),i=s(839963),c=s(434425),l=s(504698),d=s(694788);function u(e){var t,s,h,m,p,f,g;const v={cmid:r.resolveCmid(e.id),postCmid:o.resolveCmid(e.post_id||0),channelId:i.resolveId(e.owner_id||0),canEdit:Boolean(e.can_edit),rootCmid:(null==(t=e.parents_stack)?void 0:t[0])?r.resolveCmid(e.parents_stack[0]):void 0,replies:{count:(null==(h=e)||null==(s=h.thread)?void 0:s.count)||0,history:((null==(m=e.thread)?void 0:m.items)||[]).map(u),nextFrom:null==(p=e.thread)?void 0:p.next_from,prevFrom:e.thread&&e.thread.prev_from},sentAt:1e3*e.date};return e.deleted?(0,n._)({kind:"Deleted"},v):(0,n._)({kind:"Normal"},v,{chunks:e.text?l.fromServerText(e.text):[],attaches:(0,d.fromApiWallReplyAttach)(e.attachments||[]),likes:{count:(null==(f=e.likes)?void 0:f.count)||0,reactionId:Boolean(null==(g=e.likes)?void 0:g.user_likes)?c.resolveId(0):void 0,availableReactionIds:[],peerIds:new Set},peerId:a.resolveId(e.from_id)})}},264518:(e,t,s)=>{"use strict";function n(e){return{userRole:{id:e.role.name,title:e.role.title},name:e.organization_name}}s.d(t,{fromApiOrganization:()=>n})},597990:(e,t,s)=>{"use strict";s.d(t,{fromApiProfileType:()=>o,fromApiViewerAccount:()=>r,fromApiViewerProfileInfo:()=>a});var n=s(96190);function r(e){var t,s;return{id:n.resolveRealId("User",e.id),profileType:o(e.profile_type),firstName:null!=(t=e.first_name)?t:"",lastName:null!=(s=e.last_name)?s:"",photo:e.photo_100,isService:e.is_service_account||e.is_service}}function a(e){const{screen_name:t,phone:s,id:r,photo_200:a,first_name:o,last_name:i,nick_name:c,is_service_account:l}=e;return{screenName:t,phoneNumber:s,id:n.resolveRealId("User",r),avatarPhoto:a,firstName:o,lastName:i,nickName:c,isServiceAccount:l}}function o(e){var t;return null!=(t={0:"normal",2:"edu"}[null!=e?e:0])?t:"normal"}},906e3:(e,t,s)=>{"use strict";s.d(t,{Engine:()=>i});var n=s(11010),r=s(434788),a=s(89131),o=s(95154);class i{constructor(e,t){this.isWorking=!1,this.empty=()=>({kind:"Buffer",buffer:[]}),this.queued=this.empty(),this.connect=e=>{if(this.isWorking)return;this.isWorking=!0,this.queued=this.empty();var t=this;(0,n._)((function*(){for(;t.isWorking;){if("Buffer"===t.queued.kind){if(t.queued.buffer.reduce(((e,t)=>"Batch"===t.kind?e+t.updates.length:e+1),0)>=100)return t.isWorking=!1,void t.dispatch({kind:"Failure"})}try{const s=`https://${e.server}?version=${t.version}&mode=682`,n=new AbortController,a=setTimeout((()=>n.abort()),3e4),o=yield t.request(s,{act:"a_check",key:e.key,ts:e.ts,wait:25},n.signal).finally((()=>clearTimeout(a)));if("failed"in o)throw o;e.ts=o.ts,e.pts=o.pts,t.dispatch((0,r._)({kind:"Batch"},o))}catch(e){t.logger.info("[ENGINE] Error",e),t.isWorking=!1,t.dispatch({kind:"Failure"})}}}))().catch((e=>{this.isWorking=!1,this.logger.error("[ENGINE] Drain error",e)})),this.logger.info("[ENGINE] Connected")},this.dispatch=e=>{if("Callback"===this.queued.kind)return this.queued.resolve(e),void(this.queued=this.empty());switch(e.kind){case"Failure":return void this.queued.buffer.push(e);case"Batch":{const t=this.queued.buffer[this.queued.buffer.length-1];return void(t&&"Failure"!==t.kind&&t.pts===e.pts?(t.ts=e.ts,t.pts=e.pts,t.updates.push(...e.updates)):this.queued.buffer.push(e))}default:(0,a.exhaustivenessCheck)(e)}},this.poll=()=>{if("Callback"===this.queued.kind)return this.queued.reject("Engine.poll вызван повторно до обработки первого вызова!"),new Promise(((e,t)=>{this.queued={kind:"Callback",resolve:e,reject:t}}));const e=this.queued.buffer.shift();return e?Promise.resolve(e):this.isWorking?new Promise(((e,t)=>{this.queued={kind:"Callback",resolve:e,reject:t}})):Promise.reject("Engine.connect еще не был вызван!")},this.isConnected=()=>this.isWorking,this.logger=e,this.request=t,this.version=o.ENGINE_VERSION}}},302278:(e,t,s)=>{"use strict";s.d(t,{EventEmitter:()=>n});class n{subscribe(e,t){var s;Array.isArray(this.subscriptions[e])?null==(s=this.subscriptions[e])||s.push(t):this.subscriptions[e]=[t]}unsubscribe(e,t){var s;Array.isArray(this.subscriptions[e])&&(this.subscriptions[e]=(null==(s=this.subscriptions[e])?void 0:s.filter((e=>e!==t)))||[])}emit(e,t){var s;Array.isArray(this.subscriptions[e])&&(null==(s=this.subscriptions[e])||s.forEach((e=>e(t))))}constructor(){this.subscriptions={}}}},851369:(e,t,s)=>{"use strict";var n,r;s.d(t,{PlayerEventTypes:()=>n,VideoMessagePlayerEventTypes:()=>r}),function(e){e.STATE_UPDATED="stateupdated",e.START_NEW_TRACK="startNewTrack",e.START_NEXT_TRACK="startNextTrack",e.START_PREV_TRACK="startPrevTrack",e.RESUME_TRACK="resumeTrack",e.START_NEXT_TRACK_AUTOMATICALLY="startNextTrackAutomatically",e.STOP_CURRENT_TRACK_AUTOMATICALLY="stopCurrentTrackAutomatically",e.PLAYLIST_ENDED="playlistEnded",e.STOP_CURRENT_TRACK_BEFORE_STARTING_NEW_TRACK="stopCurrentTrackBeforeStartingNewTrack",e.STOP_CURRENT_TRACK_BY_ERROR="stopCurrentTrackByError",e.PAUSE_CURRENT_TRACK="pauseCurrentTrack"}(n||(n={})),function(e){e.SCROLL_TO_MESSAGE="scrollToMessage",e.STATE_UPDATED="stateUpdated"}(r||(r={}))},397384:(e,t,s)=>{"use strict";s.d(t,{handler:()=>a});var n=s(991792),r=s(96190);const a=(e,t)=>{const{profiles:s,groups:a,conversations:o,mutualFriends:i,contacts:c}=t;if((0,n.insertConvos)(e,o||[]),(0,n.insertPeers)(e,{apiUsers:s||[],apiGroups:a||[],apiContacts:c||[]}),i){const t=e.peers.get(r.resolveId(i.peerId));t&&r.updateMutualFriends(t,i.hint.map(r.resolveId),i.count)}return[]}},664061:(e,t,s)=>{"use strict";s.d(t,{handler:()=>f});var n=s(11010),r=s(434788),a=s(991792),o=s(89131),i=s(83062),c=s(452788),l=s(839963),d=s(86144),u=s(96190),h=s(54965),m=s(95154);const p=1e3;const f=(e,t)=>{switch(t.type){case"ChannelEngineBatchReceived":switch(t.variant.kind){case"FromChannelEngine":return g(e,t.variant);case"FromChannelEngineWithMissingData":return function(e,t){const{next:s,response:[n,r,...o]}=t;let i=new Map;o&&o.forEach((t=>{var s;(0,a.insertPeers)(e,{apiUsers:t.profiles||[],apiGroups:t.groups||[],apiContacts:[]}),(null==(s=t.items)?void 0:s.length)&&(i=function(e){const t=new Map;for(const s of e){let e=t.get(s.channel_id);e||(e=new Map,t.set(s.channel_id,e)),e.set(s.cmid,s)}return t}(t.items))}));n&&(0,a.insertChannels)(e,{apiChannels:n.items||[],apiGroups:n.groups||[],dangerouslyMerge:!0});var c,l;(r||n)&&(0,a.insertPeers)(e,{apiUsers:[...r||[],...(null==(c=n)?void 0:c.profiles)||[]],apiGroups:(null==(l=n)?void 0:l.groups)||[],apiContacts:[]});return g(e,{kind:"FromChannelEngine",isRetry:!0,next:s},{channelsMessagesById:i})}(e,t.variant);case"FromChannelEngineApiHistory":return function(e,t){const{ts:s,history:n,posts:r}=t,a=new Map;for(const e of r){let t=a.get(e.channel_id);t||(t=new Map,a.set(e.channel_id,t)),t.set(e.cmid,e)}return g(e,{kind:"FromChannelEngine",next:{kind:"Batch",ts:s,updates:n.reduce(((e,t)=>{switch(t[0]){case 70001:case 70002:{var s;const n=null==(s=a.get(t[1]))?void 0:s.get(t[2]);return n?(e.push([...t,n]),e):e}default:return e.push(t),e}}),[])}})}(e,t.variant);default:return(0,o.exhaustivenessCheck)(t.variant)}case"ComposerDraftsUpdateNeeded":return[];default:return(0,o.exhaustivenessCheck)(t)}};function g(e,t,s){const{isRetry:a,next:f}=t;if("Failure"===f.kind){e.channelConn.status="resyncing";const{ts:t}=e.channelConn;return[(g=(0,n._)((function*({api:e,channelEngine:s}){if(!s)return{type:"Noop"};let n;yield(0,o.sleep)(p);try{n=yield e.fetch("channels.getLongPollHistory",{lp_version:s.version,ts:t,limit:1e3,extended:1},{retries:1/0,timeout:m.CHANNELS_GLPH_TIMEOUT})}catch(e){return{type:"Noop"}}return s.connect((0,r._)({},n.credentials,{ts:n.new_ts})),{type:"ChannelEngineBatchReceived",variant:{kind:"FromChannelEngineApiHistory",ts:n.new_ts,history:n.history,posts:n.messages||[]}}})),function(e){return g.apply(this,arguments)})]}var g,v;if(!a){const t=function(e,t){const s=new Set,n=new Set,r=new Map;function a(t){switch(t[0]){case 70001:{var o,i,c,h;const[,a,m,,p]=t,f=l.resolveId(a);if(e.channels.has(f)||s.add(f),!p){const e=d.resolveCmid(m),t=r.get(f);t?t.add(e):r.set(f,new Set([e]));break}if(null==(h=p.attachments)||null==(c=h[0])||null==(i=c.wall.copy_history)||null==(o=i[0])?void 0:o.from_id){const e=u.resolveId(p.attachments[0].wall.copy_history[0].from_id);if(u.isUserPeerId(e)){n.add(e);break}if(u.isGroupPeerId(e)){s.add(l.resolveId(e));break}}break}case 70002:{const[,s,n,a]=t,o=l.resolveId(s);if(!e.channels.has(o))break;if(!a){const e=d.resolveCmid(n),t=r.get(o);t?t.add(e):r.set(o,new Set([e]));break}break}case 70010:{const[,s,n,,a]=t,o=l.resolveId(s);if(!e.channels.has(o))break;if(!a){const e=d.resolveCmid(n),t=r.get(o);t?t.add(e):r.set(o,new Set([e]));break}break}case 70003:case 70004:case 70006:case 70007:case 70008:break;case 70005:{const[,e,n]=t;if(n){const t=l.resolveId(e);s.add(t)}break}case 70009:{const[,e,n]=t;if(n){const t=l.resolveId(e);s.add(t)}break}case 70011:for(const e of t[1])a(e);break;default:}}for(const e of t.updates)a(e);return{channelIds:s,userIds:n,postCmidsByChannel:r}}(e,f);if(t.channelIds.size>0||t.userIds.size>0||t.postCmidsByChannel.size>0)return[(v=(0,n._)((function*({api:e}){try{const s=yield e.fetchMany([t.channelIds.size>0&&{method:"channels.getById",params:{channel_ids:Array.from(t.channelIds).join(","),extended:1}},t.userIds.size>0&&{method:"users.get",params:{user_ids:Array.from(t.userIds).map(u.toRealId).join(","),extended:1}},...Array.from(t.postCmidsByChannel).map((([e,t])=>({method:"channels.getMessagesById",params:{channel_id:e,cmids:Array.from(t).join(","),extended:1}})))],{retries:1/0});return{type:"ChannelEngineBatchReceived",variant:{kind:"FromChannelEngineWithMissingData",next:f,response:s}}}catch(e){return{type:"Noop"}}})),function(e){return v.apply(this,arguments)})]}e.channelConn.status="running",e.channelConn.ts=f.ts;const _=t=>{switch(t[0]){case 70001:return function(e,t,s){var n,r;const[,a,o,c,d]=t,u=l.resolveId(a),m=e.channels.get(u);if(!m)return[];if("ChannelRestricted"===m.kind)return[];l.setSortId(m,{minorSortId:c});const p=(null==(r=s)||null==(n=r.channelsMessagesById.get(u))?void 0:n.get(o))||d;if(!p)return[];const{post:f,reactions:g}=(0,h.fromApiPost)(p);for(const t of g)e.reactions.set(t.id,t);l.appendPost(m,f),i.refreshChannels(e.organisers,m),e.locks.channelsCleanup.has(u)||l.cleanup(m);return[]}(e,t,s);case 70002:return function(e,t,s){var r,a,o;const[,i,c,u]=t,m=l.resolveId(i),p=e.channels.get(m);if(!p)return[];if("ChannelRestricted"===p.kind)return[];const f=(null==(a=s)||null==(r=a.channelsMessagesById.get(m))?void 0:r.get(c))||u;if(!f)return[];const{post:g,reactions:v}=(0,h.fromApiPost)(f),_=l.findPostByCmid(p,g.cmid),C=d.merge(g,"Node"===(null==(o=_)?void 0:o.kind)?_.item:void 0);for(const t of v)e.reactions.set(t.id,t);return l.replacePost(p,C),[(0,n._)((function*(){return{type:"ComposerDraftsUpdateNeeded",foreignKind:"post",itemsToReplace:[C]}}))]}(e,t,s);case 70003:return function(e,t){const[,s,r,a]=t,o=l.resolveId(s),i=d.resolveCmid(r),c=e.channels.get(o);if(!c)return[];if("ChannelRestricted"===c.kind)return[];return l.setSortId(c,{minorSortId:a}),l.deletePost(c,i,{isRestorable:!1}),[(0,n._)((function*(){return{type:"ComposerDraftsUpdateNeeded",foreignKind:"post",itemsToDelete:[{channelId:o,cmid:i}]}}))]}(e,t);case 70004:return function(e,t){const[,s,n,r]=t,a=l.resolveId(s),o=d.resolveCmid(n),i=e.channels.get(a);if(!i)return[];if("ChannelRestricted"===i.kind)return[];return l.readUntil(i,o,r),[]}(e,t);case 70005:return function(e,t){const[,s,n,r]=t,a=l.resolveId(s),o=e.channels.get(a);if(!o)return[];if("ChannelRestricted"===o.kind)return[];return l.setArchived(o,!n),c.updateCounters(e.organisers.channelFilters,{archiveTotal:r}),i.refreshChannels(e.organisers,o),[]}(e,t);case 70006:return function(e,t){const[,s,n,r]=t,a=l.resolveId(s),o=e.channels.get(a);if(!o)return[];if("ChannelRestricted"===o.kind)return[];return l.setRights(o,{canPost:!!r}),l.setAdminLevel(o,n),[]}(e,t);case 70007:return function(e,t){const[,s,n]=t,r=l.resolveId(s),a=e.channels.get(r);if(!a)return[];if("ChannelRestricted"===a.kind)return[];return l.setMuted(a,0!==n),[]}(e,t);case 70008:return function(e,t){const[,s]=t;return c.updateCounters(e.organisers.channelFilters,{unread:s}),[]}(e,t);case 70009:return function(e,t){const[,s,n]=t,r=l.resolveId(s),a=e.channels.get(r);if(!a)return[];if("ChannelRestricted"===a.kind)return[];return l.setMembership(a,Boolean(n)),i.refreshChannels(e.organisers,a),[]}(e,t);case 70010:return function(e,t,s){var n,r;const[,a,o,,i]=t,c=l.resolveId(a),d=e.channels.get(c);if(!d)return[];if("ChannelRestricted"===d.kind)return[];const u=(null==(r=s)||null==(n=r.channelsMessagesById.get(c))?void 0:n.get(o))||i;if(!u)return[];const{post:m}=(0,h.fromApiPost)(u);"Normal"===m.kind&&l.restorePost(d,m.cmid,m);return[]}(e,t,s);case 70011:return t[1].flatMap(_);default:return[]}};return[...f.updates.flatMap(_),(C=(0,n._)((function*({channelEngine:e}){return e?{type:"ChannelEngineBatchReceived",variant:{kind:"FromChannelEngine",next:yield e.poll()}}:{type:"Noop"}})),function(e){return C.apply(this,arguments)})];var C}},967819:(e,t,s)=>{"use strict";s.d(t,{handler:()=>i});var n=s(11010),r=s(89131),a=s(452788),o=s(991792);const i=(e,t)=>{switch(t.type){case"ChannelsOnboardingDone":return 0===t.pickedChannelsIds.length?(a.push(e.organisers.channelFilters,"all",[],!1),[(0,n._)((function*({api:e}){return yield e.fetch("account.hideHelpHint",{hint_id:"im:channels_onboarding"},{retries:1/0}),{type:"Noop"}}))]):[(0,n._)((function*({api:e}){try{return{type:"ChannelsOnboardingDone_RequestSucceeded",responseChannels:yield e.fetch("channels.unarchive",{channel_ids:t.pickedChannelsIds.join(",")||"",extended:1})}}catch(e){return{type:"ChannelsOnboardingDone_RequestFailed"}}}))];case"ChannelsOnboardingDone_RequestSucceeded":{const s=(0,o.insertChannels)(e,{apiChannels:t.responseChannels.succeeded||[],apiGroups:t.responseChannels.groups||[]});return a.push(e.organisers.channelFilters,"all",s,!1),[(0,n._)((function*({api:e}){return yield e.fetch("account.hideHelpHint",{hint_id:"im:channels_onboarding"},{retries:1/0}),{type:"Noop"}}))]}case"ChannelsOnboardingDone_RequestFailed":return[];default:(0,r.exhaustivenessCheck)(t)}}},4854:(e,t,s)=>{"use strict";s.d(t,{handler:()=>a});var n=s(89131),r=s(96190);const a=(e,t)=>{switch(t.type){case"ConvoMediaViewerCacheRemoved":{const{convo:s}=t,n=e.convos.get(s.peerId);return n?(n.mediaViewerCache=void 0,n.mediaViewerCacheHasNext=void 0,n.mediaViewerCacheHasPrev=void 0,[]):[]}case"ConvoMediaViewerCacheInserted":{const{peer_id:s,items:n,direction:a}=t,o=e.convos.get(r.resolveId(s));if(!o)return[];if(!o.mediaViewerCache)return o.mediaViewerCache=n,[];switch(a){case"next":o.mediaViewerCache.push(...n);break;case"prev":o.mediaViewerCache.unshift(...n);break;case"both":o.mediaViewerCache=n}return[]}case"ConvoMediaViewerCacheSetHasNext":{const{peer_id:s,value:n}=t,a=e.convos.get(r.resolveId(s));return a?(a.mediaViewerCacheHasNext=n,[]):[]}case"ConvoMediaViewerCacheSetHasPrev":{const{peer_id:s,value:n}=t,a=e.convos.get(r.resolveId(s));return a?(a.mediaViewerCacheHasPrev=n,[]):[]}default:return(0,n.exhaustivenessCheck)(t)}}},500156:(e,t,s)=>{"use strict";s.d(t,{handler:()=>M});var n=s(11010),r=s(434788),a=s(453934),o=s(991792),i=s(877740),c=s(481186),l=s(83062),d=s(498928),u=s(96190),h=s(185327),m=s(777634),p=s(999504),f=s(197934),g=s(651285),v=s(168465),_=s(89131),C=s(95154),y=s(954811),k=s(233300),I=s(171949),E=s(927411);const b=1e3,w=200,M=(e,t,s)=>{switch(t.type){case"EngineBatchReceived":{const{variant:r}=t;switch(r.kind){case"FromEngine":return S(s,e,r);case"FromEngineWithMissingData":return function(e,t,s){const{apiConvos:n,apiMessages:r,apiUsers:a,apiGroups:i,apiContacts:c,apiIncognitoMembers:l}=s,d=R(r,n);return(0,o.insertConvos)(t,n.map((e=>{var t;return{conversation:e,last_message:null==(t=d.messagesByPeerId.get(e.peer.id))?void 0:t.get(e.last_conversation_message_id||0)}})),{dangerouslyMerge:!0}),(0,o.insertPeers)(t,{apiUsers:a,apiGroups:i,apiContacts:c}),(0,o.insertIncognitoMembers)(t,l),S(e,t,{kind:"FromEngine",next:s.skippedBatch},d)}(s,e,r);case"FromApiEngineHistory":return function(e,t,s){var r;const{next:a,apiMessages:i,apiConvos:c,apiUsers:l,apiGroups:u,apiContacts:h,apiCounters:m}=s,f=R(i,c);(0,o.insertConvos)(t,c.map((e=>{var t;return{conversation:e,last_message:null==(t=f.messagesByPeerId.get(e.peer.id))?void 0:t.get(e.last_conversation_message_id||0)}})),{dangerouslyMerge:!0}),(0,o.insertPeers)(t,{apiUsers:l,apiGroups:u,apiContacts:h},{dangerouslyOverwrite:!0}),t.activeCallsCount=m.calls||0,d.updateCounters(t.organisers.filters,{unread:m.messages||0,unreadUnmuted:m.messages_unread_unmuted||0,headerNotMutedUnread:0,archive:m.messages_archive_unread||0,archiveMentions:m.messages_archive_mentions_count||0,archiveTotal:m.messages_archive||0,messageRequests:m.message_requests||0,businessNotify:m.business_notify||0,businessNotifyTotal:m.business_notify_all||0}),null==(r=m.messages_folders)||r.forEach((e=>{p.setUnreadCounters(t.organisers.folders,p.resolveId(e.folder_id),e.total_count,e.unmuted_count)}));const{unreadUnmutedCount:g}=t.organisers.filters.unread;return[...S(e,t,{kind:"FromEngine",next:a},f),function(){var e=(0,n._)((function*({notification:e}){return e.setCounters({unread:g}),{type:"Noop"}}));function t(t){return e.apply(this,arguments)}return t}()]}(s,e,r);default:return(0,_.exhaustivenessCheck)(r)}}case"EngineBatchReceived_TypingsTimedOut":{const{peerId:s,typingType:n,timestamp:r}=t,a=e.typings.get(s);if(!a)return[];const o=a[n];return o?(o.updatedAt<=r&&delete a[n],0===Object.keys(a).length&&e.typings.delete(s),[]):[]}case"UpdateMessageRequestsCounter":return[(0,n._)((function*({api:e}){try{const t=E.IApi.resolveTrackId("account.getCounters","message_requests");e.dangerouslyAbort(t);const{message_requests:s}=yield e.fetch("account.getCounters",{filter:"message_requests"},{trackId:t});return{type:"UpdateMessageRequestsCounter_RequestCompleted",count:null!=s?s:0}}catch(e){return{type:"Noop"}}}))];case"UpdateMessageRequestsCounter_RequestCompleted":return d.updateCounters(e.organisers.filters,{messageRequests:t.count}),[];case"TemporaryHackForResync":case"LoadChatMembers":case"LoadChatInfo":case"ComposerDraftsUpdateNeeded":return[];default:return(0,_.exhaustivenessCheck)(t)}};function S(e,t,s,E){const{next:M}=s;if("Failure"===M.kind){t.convoConn.status="resyncing";const e=t.convoConn.pts,s=t.ownerId;return[(S=(0,n._)((function*({api:t,engine:n,queue:a}){var i;let c,l;yield(0,_.sleep)(b);try{[c,l]=yield t.fetchSeq([{method:"messages.getLongPollHistory",params:{lp_version:n.version,credentials:1,pts:e,msgs_limit:1100,events_limit:1100,last_n:1e3,extended:1,group_id:(0,o.getOwnerGroupId)(s)}},{method:"account.getCounters",params:{filter:"all"}}],{retries:1/0})}catch(e){return{type:"Noop"}}if(e<(c.from_pts||0))return a.disconnect(),console.error("Выполняется полный ресинк"),{type:"TemporaryHackForResync"};if(!c.credentials||!c.credentials.pts)throw new Error("В ответе getLongPollHistory отсутствуют новые креды!");return yield n.connect((0,r._)({},c.credentials,{pts:c.credentials.pts})),{type:"EngineBatchReceived",variant:{kind:"FromApiEngineHistory",apiMessages:(null==(i=c.messages)?void 0:i.items)||[],apiConvos:c.conversations||[],apiUsers:c.profiles||[],apiGroups:c.groups||[],apiContacts:c.contacts||[],apiCounters:l,next:{kind:"Batch",pts:c.credentials.pts,ts:c.credentials.ts,updates:c.history||[]}}}})),function(e){return S.apply(this,arguments)})]}var S;if(!(void 0!==E)&&function(e,t){for(const s of t.updates){if(i.IEngine.isIncompleteUpdate(s))return!0;switch(s[0]){case 20:case 21:{const[,t]=s,n=u.resolveId(t);if(!e.convos.has(n))return!0;break}case 52:{const[,t,n,r]=s,a=u.resolveId(n),o=e.convos.get(a);if(!o)break;switch(t){case i.IEngine.ChatUpdateType.FlagsChanged:case i.IEngine.ChatUpdateType.TitleChanged:case i.IEngine.ChatUpdateType.AvatarChanged:case i.IEngine.ChatUpdateType.BannerChanged:case i.IEngine.ChatUpdateType.MessageRequestChanged:case i.IEngine.ChatUpdateType.MessageRequestCanceled:case i.IEngine.ChatUpdateType.MessageRequestAccepted:case i.IEngine.ChatUpdateType.MessageRequestRejected:case i.IEngine.ChatUpdateType.CallInProgressChanged:case i.IEngine.ChatUpdateType.ContactConverted:case i.IEngine.ChatUpdateType.ContactJoined:case i.IEngine.ChatUpdateType.DescriptionChanged:case i.IEngine.ChatUpdateType.IncognitoJoined:case i.IEngine.ChatUpdateType.ConvertIncognito:return!0;case i.IEngine.ChatUpdateType.UserJoined:case i.IEngine.ChatUpdateType.UserLeft:case i.IEngine.ChatUpdateType.UserKicked:{const s=u.resolveId(r);if(!e.peers.has(s))return!0;if(t===i.IEngine.ChatUpdateType.UserJoined&&s===e.ownerId)return!0;break}case i.IEngine.ChatUpdateType.Pinned:{const[,,,e]=s;if(0===e)break;const t=m.resolveCmid(e),{status:n}=h.findHistoryNodeByCmid(o,t);return"NotLoaded"===n}case i.IEngine.ChatUpdateType.CopyFlagChanged:case i.IEngine.ChatUpdateType.AdminGrated:case i.IEngine.ChatUpdateType.AdminKicked:case i.IEngine.ChatUpdateType.KeyboardChanged:case i.IEngine.ChatUpdateType.BusinessNotifyDataChanged:case i.IEngine.ChatUpdateType.DonUnsubscribed:case i.IEngine.ChatUpdateType.DonSubscribed:case i.IEngine.ChatUpdateType.IsNewChange:case i.IEngine.ChatUpdateType.StyleChanged:case i.IEngine.ChatUpdateType.ShortPollReactionsChanged:case i.IEngine.ChatUpdateType.IncognitoLeft:break;default:}break}case 10013:{const[,t]=s,n=u.resolveId(t);return e.convos.has(n)}case 63:case 64:case 65:case 66:case 67:case 68:case 10:case 11:case 12:case 80:case 91:case 114:case 115:case 119:case 501:case 502:case 503:case 504:case 505:case 506:case 507:case 508:case 509:case 602:case 10001:case 10002:case 10006:case 10007:break;case 10003:{const[,,t,n]=s;if(i.IEngine.isIncompleteUpdate(s))break;const r=u.resolveId(n),a=e.convos.get(r);if(!a)break;const{isDeleted:o,isSpam:c}=m.convertFlags(t);if((o||c)&&a)return!0;break}case 10004:{const[,,,,t,,,n,r]=s,a=u.resolveId(t),o=e.convos.get(a);if(!o)return!0;const i=A(o);if(P(r,i))return!0;if(n.has_template)return!0;const{message:l}=(0,c.fromEngineMessage)(s,e.ownerId,i);if(!e.peers.has(l.peerId)||!e.peers.has(l.authorId))return!0;if(u.isUserPeerId(l.authorId)&&l.peerId===l.authorId&&!e.lastSeens.has(l.authorId))return!0;break}case 10005:case 10018:{const[,t,n,r,,,,a]=s,o=u.resolveId(r),i=e.convos.get(o);if(!i)break;const c=m.resolveCmid(t);if(!h.findMessageByCmid(i,c))break;if(P(a,A(i)))return!0;if(m.convertFlags(n).hasReactions)return!0;break}case 10019:return!0;case 601:{const[,t,n,r]=s;if(1!==t&&2!==t)break;const a=e.convos.get(u.resolveId(n));if(!a||"NotLoaded"===v.findNodeByCmid(a.history,m.resolveCmid(r)).status)return!0;break}default:}}return!1}(t,M))return[(F=t.convoConn.pts,U=M,N=t.ownerId,R=(0,n._)((function*({api:e,engine:t,logger:s}){var n;let r;try{r=yield e.fetch("messages.getLongPollHistory",{pts:F,lp_version:t.version,msgs_limit:1100,events_limit:1100,last_n:1e3,extended:1,group_id:(0,o.getOwnerGroupId)(N)},{retries:1/0})}catch(e){return{type:"Noop"}}return F<(r.from_pts||0)?(s.error("[EngineBatchReceived]",new Error("Ошибка дозагрузки кэша")),{type:"TemporaryHackForResync"}):{type:"EngineBatchReceived",variant:{kind:"FromEngineWithMissingData",apiConvos:r.conversations||[],apiMessages:(null==(n=r.messages)?void 0:n.items)||[],apiUsers:r.profiles||[],apiGroups:r.groups||[],skippedBatch:U,apiContacts:r.contacts||[],apiIncognitoMembers:r.incognito_members||[]}}})),function(e){return R.apply(this,arguments)})];var R,F,U,N;t.convoConn.status="running",t.convoConn.pts=M.pts;const T=M.updates.flatMap((e=>{switch(e[0]){case 10:case 11:case 12:return function(e,t){const[s,n,r]=t,a=u.resolveId(n),o=e.convos.get(a);if(!o)return[];const i={10:"unset",11:"replace",12:"set"}[s];return h.updateFlags(o,i,r),l.refresh(e.organisers,o),[]}(t,e);case 20:return function(e,t){const[,s,n]=t,r=u.resolveId(s),a=e.convos.get(r);if(!a)return[];return h.updateSortId(a,{majorSortId:n}),l.refresh(e.organisers,a),[]}(t,e);case 21:return function(e,t){const[,s,r]=t,a=u.resolveId(s),o=e.convos.get(a);if(!o)return[];h.updateSortId(o,{minorSortId:r}),l.refresh(e.organisers,o);const i=r<=0,c=e.organisers.filters.messageRequest.totalCount>0;if(i&&c)return[(0,n._)((function*(){return{type:"UpdateMessageRequestsCounter",peerId:a}}))];return[]}(t,e);case 52:return function(e,t,s,a){var o;const[,c,d,p]=t,f=u.resolveId(d),g=e.convos.get(f);if(!g)return[];const v=null==(o=a)?void 0:o.convos.get(d),_=v&&(0,y.fromApiConvo)(v);switch(c){case i.IEngine.ChatUpdateType.CopyFlagChanged:case i.IEngine.ChatUpdateType.TitleChanged:case i.IEngine.ChatUpdateType.AvatarChanged:return[];case i.IEngine.ChatUpdateType.FlagsChanged:var C;return"ChatConvo"!==g.kind||"ChatConvo"!==(null==(C=_)?void 0:C.convo.kind)||(g.isService=_.convo.isService,g.permissions=_.convo.permissions,g.acl=_.convo.acl,g.inviteLinks=_.convo.inviteLinks,g.isIncognito=_.convo.isIncognito),[];case i.IEngine.ChatUpdateType.Pinned:{var k;if("ChatConvo"!==g.kind)return[];const t=p,s=m.resolveCmid(t);if(g.pinnedMessage){var I;const e=h.findMessageByCmid(g,g.pinnedMessage.cmid);"Normal"===(null==(I=e)?void 0:I.kind)&&m.unpinMessage(e)}if(e.hiddenPinnedMessages.delete(f),(null==(k=_)?void 0:k.convo.kind)===g.kind)return _.convo.pinnedMessage&&h.pinMessage(g,_.convo.pinnedMessage),[];if(0===s)h.unpinMessage(g);else{var E;const e=h.findMessageByCmid(g,s);"Normal"===(null==(E=e)?void 0:E.kind)&&h.pinMessage(g,m.toPinned(e))}return[]}case i.IEngine.ChatUpdateType.ContactJoined:return[];case i.IEngine.ChatUpdateType.UserJoined:{if("ChatConvo"!==g.kind)return[];const t=u.resolveId(p);if(!u.isUserPeerId(t)&&!u.isGroupPeerId(t))return[];if(g.members){var b;const s=g.adminIds.has(t),n={peerId:t,isAdmin:s,canKick:g.adminIds.has(e.ownerId)&&!s||g.ownerId===e.ownerId,isMessageRequest:!1,isRestrictedToWrite:!!(null==(b=g.members.get(t))?void 0:b.isRestrictedToWrite)};h.addMembers(g,[n])}return t===e.ownerId?(e.locks.getConversationMembers.add(f),[u.isChatPeerId(f)&&(0,n._)((function*(){return{type:"LoadChatMembers",peerId:f}})),u.isChatPeerId(f)&&(0,n._)((function*(){return{type:"LoadChatInfo",peerId:f}}))]):[]}case i.IEngine.ChatUpdateType.UserLeft:{if("ChatConvo"!==g.kind)return[];const t=u.resolveId(p);return u.isUserPeerId(t)||u.isGroupPeerId(t)?(t===e.ownerId&&h.changeUserState(g,"left"),g.adminIds.has(t)&&g.adminIds.delete(t),h.removeMember(g,t),[]):[]}case i.IEngine.ChatUpdateType.UserKicked:{if("ChatConvo"!==g.kind)return[];const t=u.resolveId(p);if(!u.isUserPeerId(t)&&!u.isGroupPeerId(t))break;t===e.ownerId&&(h.changeUserState(g,"kicked"),h.restrictWrite(g,"kicked")),g.adminIds.has(t)&&g.adminIds.delete(t),h.removeMember(g,t);break}case i.IEngine.ChatUpdateType.KeyboardChanged:return[];case i.IEngine.ChatUpdateType.CallInProgressChanged:var w;if("ChatConvo"===g.kind&&(null==(w=_)?void 0:w.convo.kind)===g.kind){h.updateActiveCall(g,_.convo.activeCall);const e=_.convo.inReadBy,t=_.convo.unreadCount;return[function(){var s=(0,n._)((function*({calls:s}){var n;return null==(n=s)||n.updateConvoCounter(f,e,t),{type:"Noop"}}));function r(e){return s.apply(this,arguments)}return r}()]}return[];case i.IEngine.ChatUpdateType.IsNewChange:return h.updateIsNew(g,!!p),[];case i.IEngine.ChatUpdateType.MessageRequestChanged:{const t=p;switch(t){case i.IEngine.MRStatus.Accepted:{var M;if("MessageRequestChatConvo"!==g.kind&&"MessageRequestUserConvo"!==g.kind||"pending"!==g.MRStatus){l.refresh(e.organisers,g);break}const t=h.fromAcceptedMessageRequest(g,null==(M=_)?void 0:M.convo);e.convos.set(f,t),l.refresh(e.organisers,t);break}case i.IEngine.MRStatus.New:var S,R,A,P;if(null==(S=_)?void 0:S.convo)e.convos.set(f,null==(A=_)?void 0:A.convo);l.refresh(e.organisers,null!=(P=null==(R=_)?void 0:R.convo)?P:g);break;case i.IEngine.MRStatus.Deleted:if("MessageRequestChatConvo"!==g.kind&&"MessageRequestUserConvo"!==g.kind&&"UserConvo"!==g.kind)break;const t=h.fromCancelledMessageRequest(g);e.convos.set(f,t),l.refresh(e.organisers,t);break;case i.IEngine.MRStatus.Rejected:if(h.isRejectedMR(g)){l.refresh(e.organisers,g);break}if("MessageRequestChatConvo"!==g.kind&&"MessageRequestUserConvo"!==g.kind&&"UserConvo"!==g.kind)break;const s=h.fromRejectedMessageRequest(g);e.convos.set(f,s),l.refresh(e.organisers,s);break;default:}return[(0,n._)((function*(){return{type:"UpdateMessageRequestsCounter",peerId:f}}))]}case i.IEngine.ChatUpdateType.AdminGrated:{var F;const t=u.resolveId(p);if("ChatConvo"!==g.kind||!u.isUserPeerId(t)&&!u.isGroupPeerId(t))return[];g.adminIds.add(t);const s=null==(F=g.members)?void 0:F.get(t);return s&&h.addMembers(g,[(0,r._)({},s,{isAdmin:!0,canKick:g.ownerId===e.ownerId})]),t===e.ownerId&&h.isForbidedWritingForAll(g)&&h.allowWrite(g),[]}case i.IEngine.ChatUpdateType.AdminKicked:{var U;const t=u.resolveId(p);if("ChatConvo"!==g.kind||!u.isUserPeerId(t)&&!u.isGroupPeerId(t))return[];g.adminIds.delete(t);const s=null==(U=g.members)?void 0:U.get(t);return s&&h.addMembers(g,[(0,r._)({},s,{isAdmin:!1,canKick:g.adminIds.has(e.ownerId)})]),t===e.ownerId&&h.isForbidedWritingForAll(g)&&h.restrictWrite(g,"forbid_writing_for_all"),[]}case i.IEngine.ChatUpdateType.ContactConverted:{const t=u.resolveId(p),s=e.convos.get(t),n=e.peers.get(t);return n&&s&&"Contact"===n.kind&&u.isUserPeerId(f)?(u.convertContact(n,f),h.updateSortId(s,{minorSortId:0}),[]):[]}case i.IEngine.ChatUpdateType.BannerChanged:var N,T;return"UserConvo"!==g.kind||(null==(N=_)?void 0:N.convo.kind)!==g.kind||(g.convoBanner=null==(T=_)?void 0:T.convo.convoBanner),[];case i.IEngine.ChatUpdateType.DescriptionChanged:var x;return"ChatConvo"!==g.kind||(null==(x=_)?void 0:x.convo.kind)!==g.kind||(g.description=_.convo.description),[];case i.IEngine.ChatUpdateType.ShortPollReactionsChanged:return"ChatConvo"!==g.kind||(g.shouldShortPollReactions=Boolean(p)),[];case i.IEngine.ChatUpdateType.IncognitoJoined:{var O,L,q;if("ChatConvo"!==g.kind)return[];const t=h.resolveIncognitoMemberId(p),s=h.getIncognitoMember(g,t);if(!(null==(O=s)?void 0:O.memberId))return[];const n=u.resolveId(s.memberId);if(!u.isUserPeerId(n)&&!u.isContactPeerId(n))return[];const r={peerId:n,isAdmin:!1,isRestrictedToWrite:!!(null==(q=g.members)||null==(L=q.get(n))?void 0:L.isRestrictedToWrite),canKick:g.adminIds.has(e.viewer.id)||e.viewer.id===s.inviterId,isMessageRequest:!1,joinDate:1e3*s.inviteDate};return h.addMembers(g,[r]),[]}case i.IEngine.ChatUpdateType.ConvertIncognito:case i.IEngine.ChatUpdateType.IncognitoLeft:{var B;if("ChatConvo"!==g.kind)return[];const e=h.resolveIncognitoMemberId(p),t=h.getIncognitoMember(g,e);return(null==(B=t)?void 0:B.memberId)&&h.removeMember(g,t.memberId),h.removeIncognitoMember(g,e),[]}case i.IEngine.ChatUpdateType.BusinessNotifyDataChanged:case i.IEngine.ChatUpdateType.MessageRequestAccepted:case i.IEngine.ChatUpdateType.MessageRequestCanceled:case i.IEngine.ChatUpdateType.MessageRequestRejected:case i.IEngine.ChatUpdateType.DonSubscribed:case i.IEngine.ChatUpdateType.DonUnsubscribed:case i.IEngine.ChatUpdateType.StyleChanged:return[];default:}return[]}(t,e,0,E);case 63:case 64:case 65:case 66:case 67:case 68:return function(e,t){const[s,a,o,,i]=t,c=new Set(o.map((e=>u.resolveId(e))));if(c.delete(e.viewer.id),!c.size)return[];const l=u.resolveId(a),d=e.convos.get(l);if(!d)return[];const h={63:"text",64:"voice",65:"photo",66:"video",67:"file",68:"videomessage"}[s],m=(0,r._)({},e.typings.get(l)||{},{[h]:{peerIds:c,updatedAt:i}});return e.typings.set(l,m),[function(){var e=(0,n._)((function*(){return yield(0,_.sleep)(C.TYPING_EXPIRATION_TIME),{type:"EngineBatchReceived_TypingsTimedOut",peerId:l,typingType:h,timestamp:i}}));function t(){return e.apply(this,arguments)}return t}()]}(t,e);case 80:return function(e,t){const[,s,r,,a,,o,i,,c]=t;return d.updateCounters(e.organisers.filters,{unread:s,headerNotMutedUnread:o,unreadUnmuted:r,archive:i,archiveMentions:c,businessNotify:a}),[function(){var e=(0,n._)((function*({notification:e}){return e.setCounters({unreadIdle:o,unread:r}),{type:"Noop"}}));function t(t){return e.apply(this,arguments)}return t}()]}(t,e);case 91:return[];case 114:return function(e,t){const[,{peer_id:s}]=t,n=u.resolveId(s),r=e.convos.get(n);if(!r)return[];const a=(0,y.fromLongpollPushSettings)(t);return h.updatePush(r,a),[]}(t,e);case 115:return function(e,t){const[,s]=t,{browserNotifications:r}=e.viewer.settings;return[(0,n._)((function*({calls:e,notification:t}){if(!e)return{type:"Noop"};if(e.showIncomingCall(s),!r)return{type:"Noop"};const n=u.resolveId(s.from_id);let a,o="";return s.caller_info&&(o=`${s.caller_info.first_name} ${s.caller_info.last_name}`,a=s.caller_info.photo_400),s.chat_info&&(o=s.chat_info.title,a=s.chat_info.photo_400),t.notify({kind:"call",peerId:n,caller:o,image:a},n),{type:"Noop"}}))]}(t,e);case 119:return function(e,t){const[,s]=t,n=u.resolveId(s.peer_id),r=u.resolveId(s.owner_id),a=e.convos.get(n),o=e.peers.get(n),i=e.peers.get(r),c=a&&o&&i?(0,k.fromApiMessageEvent)(o,i,s):void 0;return e.botKeyboardEvent=c,[]}(t,e);case 501:return function(e,t){return(0,o.insertFolders)(e,[(0,I.fromEngineFolder)(t)]),[]}(t,e);case 502:return function(e,t){const[,s]=t,n=p.resolveId(s);p.deleteFolder(e.organisers.folders,n);for(const t of e.convos.values())h.removeFolder(t,n);return[]}(t,e);case 503:return function(e,t){const[,s,n]=t,r=p.resolveId(s),a=e.organisers.folders.find((e=>e.id===r));if(!a)return[];return p.setName(a,n),[]}(t,e);case 504:return function(e,t){const[,s,...n]=t,r=p.resolveId(s),a=(0,o.getConvosByIds)(e,n),i=e.organisers.folders.find((e=>e.id===r));if(!i)return[];return(0,o.addConvosToFolder)(e,r,a),[]}(t,e);case 505:return function(e,t){const[,s,...n]=t,r=p.resolveId(s),a=(0,o.getConvosByIds)(e,n),i=e.organisers.folders.find((e=>e.id===r));if(!i)return[];return(0,o.removeConvosFromFolder)(e,r,a),[]}(t,e);case 506:return function(e,t){const[,...s]=t;return p.reorderFolders(e.organisers.folders,s.map((e=>p.resolveId(e)))),[]}(t,e);case 507:return function(e,t){const[,...s]=t;for(const t of s){if(t.length<3)continue;const s=p.resolveId(t[0]);p.setUnreadCounters(e.organisers.folders,s,t[1],t[2])}return[]}(t,e);case 508:return function(e,t){const[,s]=t,n=p.resolveId(s),r=e.organisers.folders.find((e=>e.id===n));if(!r)return[];return p.replaceFolder(e.organisers.folders,(0,I.fromApiFolder)({id:n,name:r.name,type:r.type,flags:p.convertFlags({type:r.type,hasSublist:r.hasSublist})})),[]}(t,e);case 509:return function(e,t){const[,s,n]=t,r=p.resolveId(s),a=e.organisers.folders.find((e=>e.id===r));a&&p.updateFlags(a,n);return[]}(t,e);case 601:return function(e,t,s){var r;const[,o,i,l]=t,d=u.resolveId(i),p=m.resolveCmid(l);let f,v=0,_=[];switch(o){case 1:{const[,,,,e,s,...n]=t;v=s,_=n,f=g.resolveId(e);break}case 2:case 3:case 4:{const[,,,,e,...s]=t;v=e,_=s;break}default:return[]}const C=[];let y=0;for(let e=0;e<v;e++){const e=_[y];if(!e)return[];const t=_.slice(y+1,y+1+e);y+=1+e;const[s,n,r]=t.slice(0,3);if(void 0===s||void 0===n||void 0===r)return[];const a=t.slice(3,3+r).map(u.resolveId);C.push({reactionId:g.resolveId(s),count:n,peerIds:new Set(a)})}const k=e.convos.get(d);if(!k)return[];let I,E,b=0,M=[];if(2===o||4===o){var S;b=null!=(S=_[y])?S:0;const e=y+1,t=e+Math.min(3,null!=b?b:0);M=_.slice(e,t).map((e=>u.resolveId(e))),I=_[t]?g.resolveId(_[t]):void 0}E=h.findMessageByCmid(k,p),"Normal"===(null==(r=E)?void 0:r.kind)&&(1!==o&&3!==o||m.setCurrentUserReaction(E,f),m.setReactions(E,C));if(E)E=(0,a.isDraft)(E)?(0,a.current)(E):E;else{var R,A;const e=null==(A=s)||null==(R=A.messagesByPeerId.get(d))?void 0:R.get(p);if(E=e&&(0,c.fromApiMessage)(e).message,!E)return[]}const P=`${d}-${p}`;var F;const U=null!=(F=e.messageReactedPeers.get(P))?F:new Set;let N=[];switch(o){case 2:N=M.filter((e=>!U.has(e))),e.messageReactedPeers.set(P,new Set([...U,...N]));break;case 4:const t=new Set([...U].filter((e=>!M.includes(e))));if(0===t.size){e.messageReactedPeers.delete(P);break}e.messageReactedPeers.set(P,t)}if(e.messageReactedPeers.size>w){const t=e.messageReactedPeers.keys(),s=e.messageReactedPeers.size-w;for(let n=0;n<s;n++)e.messageReactedPeers.delete(t.next().value)}const T=N.map((t=>{const s=e.peers.get(u.resolveId(t)),n=(0,a.isDraft)(s)?(0,a.current)(s):s;return null!=n?n:null})).filter((e=>null!==e)),x=!h.isMuted(k)&&e.viewer.settings.push.messageReaction.isEnabled,O=C.some((t=>!e.messageReactions.has(t.reactionId)));I&&h.setUnreadReaction(k,p,I);return[function(){var e=(0,n._)((function*({notification:e}){var t;if("Normal"!==(null==(t=E)?void 0:t.kind))return{type:"Noop"};const s=E.sentAt<Date.now()-432e5,n=[...E.reactions.values()].reduce(((e,t)=>e+t.count),0);return x&&E.isOut&&2===o&&!s&&n<8&&b>0&&e.notify({kind:"reaction",message:E,reactedPeers:T,reactedCount:b}),{type:"Noop"}}));function t(t){return e.apply(this,arguments)}return t}(),O&&(0,n._)((function*(){return{type:"InvalidateMessageReactions",force:!0}}))]}(t,e,E);case 602:return function(e,t){const[,s,...n]=t,r=u.resolveId(s),a=e.convos.get(r);if(!a)return[];const o=n[0];if(void 0===o)return[];const i=n.slice(1,o+1).map(m.resolveCmid);return h.replaceUnreadReactions(a,i),[]}(t,e);case 10001:case 10002:case 10003:return function(e,t,s){const[r,a,o,i]=t,l=m.resolveCmid(a),d=u.resolveId(i),p=e.convos.get(d);if(!p)return[];const f=m.convertFlags(o);if(10003===r){const{isDeleted:e,isSpam:t}=f;if((e||t)&&a){var g,v;const e=null==(v=s)||null==(g=v.messagesByPeerId.get(i))?void 0:g.get(a);if(e){const t=(0,c.fromApiMessage)(e);h.restoreMessage(p,t.message,t.mentions.hasDirect||t.mentions.hasMass)}}}const _={10001:"replace",10002:"set",10003:"unset"}[r],{status:C}=h.findHistoryNodeByCmid(p,l);if("NotLoaded"===C)return[];return h.updateMessageFlags(p,l,_,o),[(0,n._)((function*(){if(10002!==r)return{type:"Noop"};const{isDeleted:e,isDeletedForAll:t}=f;return e||t?{type:"ComposerDraftsUpdateNeeded",peerId:d,foreignKind:"message",itemsToDelete:[{peerId:d,cmid:l}]}:{type:"Noop"}}))]}(t,e,E);case 10004:case 10005:case 10018:case 10019:return function(e,t,s){var r,a;const[,d]=t;let p;switch(t[0]){case 10004:p=t[4];break;case 10005:case 10018:p=t[3];break;case 10019:p=t[2];break;default:(0,_.exhaustivenessCheck)(t)}const g=u.resolveId(p),v=e.convos.get(g);if(!v)return[];const C=null==(a=s)||null==(r=a.messagesByPeerId.get(p))?void 0:r.get(d);let y,I,E;if(C){var b,w;const e=(0,c.fromApiMessage)(C);y=e.message,I=e.mentions;const t=null==(w=s)||null==(b=w.convos.get(g))?void 0:b.current_keyboard;if(t){const e=(0,k.fromApiKeyboard)(t,g);if("InputKeyboard"===e.kind){JSON.stringify(v.currentKeyboard)!==JSON.stringify(e)&&(E={kind:"InputKeyboardUpsertEvent",keyboard:e})}}else E={kind:"InputKeyboardDeleteEvent"}}else{if(i.IEngine.isIncompleteUpdate(t)||10019===t[0])return[];const s=(0,c.fromEngineMessage)(t,e.ownerId,A(v));y=s.message,I=s.mentions,E=s.keyboardEvent}if(C&&!i.IEngine.isIncompleteUpdate(t)&&10019!==t[0]){I=(0,c.fromEngineMessage)(t,e.ownerId,A(v)).mentions}switch(t[0]){case 10004:{var M,S;const s=e.typings.get(v.peerId);if(s)for(const t of o.TypingVariants){const n=s[t];n&&n.peerIds.has(y.authorId)&&(n.peerIds.delete(y.authorId),0===n.peerIds.size&&delete s[t],0===Object.keys(s).length&&e.typings.delete(v.peerId))}const r=t[3],a=I.hasDirect||I.hasMass;"ChatConvo"===v.kind?h.appendMessage(v,y,r,a,E):h.appendMessage(v,y,r,!1,E),l.refresh(e.organisers,v),e.locks.convosCleanup.has(v.peerId)||h.cleanup(v),"InputKeyboardUpsertEvent"===(null==(M=E)?void 0:M.kind)&&e.hiddenBotKeyboards.delete(v.peerId);const i=m.convertFlags(t[2]),c=h.isMessageUnread(v,y),{browserNotifications:d,soundNotifications:p,push:_}=e.viewer.settings,C=!y.isOut&&!i.noPush&&c&&!h.isMuted(v)&&p&&!y.isSilent;let k,b=null;switch(v.kind){case"UserConvo":b=_.userConvo;break;case"ChatConvo":b=_.chatConvo;break;case"GroupConvo":b=_.groupConvo}switch(!0){case y.isOut:case!c:case"nothing"===v.push.mode||"nothing"===_.mention:case null!==b&&!b.isEnabled:case!d:case i.noPush:k=!1;break;case!h.isMuted(v):k=!0;break;case"direct-mention"===v.push.mode||"direct-mention"===_.mention:k=I.hasDirect;break;case"every-mention"===v.push.mode&&"every-mention"===_.mention:k=a;break;default:k=!0}const w=u.isMarusia(g)&&"Normal"===y.kind&&{type:"add_message",payload:{randomId:Number(y.randomId),text:m.toRawText(y),isOutbound:y.isOut,local:!1,payload:null==(S=t[7])?void 0:S.payload,attachIds:f.ids(y.attaches)}},R=v.unreadCount,A=v.inReadBy;return[function(){var e=(0,n._)((function*({notification:e}){return k&&e.notify({kind:"message",message:y},g),C&&e.playSound(),{type:"Noop"}}));function t(t){return e.apply(this,arguments)}return t}(),"ChatConvo"===v.kind&&v.activeCall&&function(){var e=(0,n._)((function*({calls:e}){var t;return null==(t=e)||t.updateConvoCounter(g,A,R),{type:"Noop"}}));function t(t){return e.apply(this,arguments)}return t}(),w&&function(){var e=(0,n._)((function*({marusia:e}){var t;return null==(t=e)||t.handleAction(w),{type:"Noop"}}));function t(t){return e.apply(this,arguments)}return t}()]}case 10005:case 10018:case 10019:return h.replaceMessage(v,y,I.hasDirect||I.hasMass),"Expired"===y.kind&&h.replaceExpiredReplies(v,y.cmid),[(0,n._)((function*(){return{type:"ComposerDraftsUpdateNeeded",peerId:g,foreignKind:"message",itemsToDelete:"Expired"===y.kind?[{peerId:g,cmid:y.cmid}]:void 0,itemsToReplace:"Normal"===y.kind?[y]:void 0}}))];default:return(0,_.exhaustivenessCheck)(t)}}(t,e,E);case 10006:case 10007:return function(e,t){const[s,r,a,o]=t,i=u.resolveId(r),c=m.resolveCmid(a),d=e.convos.get(i);if(!d)return[];10006===s?(h.readInUntil(d,c,o),u.isFavorites(d.peerId,e.ownerId)&&h.readOutUntil(d,c)):h.readOutUntil(d,c);return l.refresh(e.organisers,d),[10006===s&&"ChatConvo"===d.kind&&d.activeCall&&function(){var e=(0,n._)((function*({calls:e}){var t;return null==(t=e)||t.updateConvoCounter(i,a,o),{type:"Noop"}}));function t(t){return e.apply(this,arguments)}return t}()]}(t,e);case 10013:return function(e,t,s){var r;const[,a,o]=t,i=u.resolveId(a),c=m.resolveCmid(o),d=e.convos.get(i);if(!d)return[];if(v.lastCmid(d.history)!==c)return[];const h=null==(r=s)?void 0:r.convos.get(a),p=h&&(0,y.fromApiConvo)(h);if(!p)return[function(){var e=(0,n._)((function*({logger:e}){return e.error("[EngineBatchReceived]",new Error(`В ${t[0]} отсутствует дозагруженная беседа`)),{type:"Noop"}}));function s(t){return e.apply(this,arguments)}return s}()];e.convos.set(p.convo.peerId,p.convo),p.peer&&e.peers.set(p.peer.id,p.peer);return l.refresh(e.organisers,d),[]}(t,e,E);default:return[]}}));return[function(){var e=(0,n._)((function*({engine:e}){return{type:"EngineBatchReceived",variant:{kind:"FromEngine",next:yield e.poll()}}}));return function(t){return e.apply(this,arguments)}}(),...T]}function R(e,t){const s=new Map;for(const t of e){let e=s.get(t.peer_id);e||(e=new Map,s.set(t.peer_id,e)),e.set(t.conversation_message_id,t)}return{messagesByPeerId:s,convos:new Map(t.map((e=>[e.peer.id,e])))}}function A(e){return function(t){var s;const n=h.findMessageByCmid(e,t);return"Normal"===(null==(s=n)?void 0:s.kind)?n:void 0}}function P(e,t){if(e.fwd&&!e.reply)return!0;if(e.reply){const s=JSON.parse(e.reply);if(!t(m.resolveCmid(s.conversation_message_id)))return!0}if(e.geo)return!0;if(e.attachments&&e.attach1_type&&!e.attach2_type)try{const t=JSON.parse(e.attachments);if(Array.isArray(t)&&t[0].type===e.attach1_type)return!1}catch(e){return!0}return!!e.attach1_type}},553977:(e,t,s)=>{"use strict";s.d(t,{handler:()=>r});var n=s(991792);const r=(e,t)=>((0,n.insertPeers)(e,{apiUsers:t.profile?[t.profile]:[],apiContacts:[t.contact],apiGroups:[]},{dangerouslyOverwrite:!0}),(0,n.insertContacts)(e,[t.contact]),[])},972284:(e,t,s)=>{"use strict";s.d(t,{handler:()=>c});var n=s(11010),r=s(434788),a=s(89131),o=s(651285);const i=864e5,c=(e,t)=>{switch(t.type){case"InvalidateMessageReactions":{const{force:r}=t,{locks:{invalidateMessageReactions:a}}=e;return a?[]:(e.locks.invalidateMessageReactions=!0,[(s=(0,n._)((function*({api:e,storage:t}){try{const s=yield function(e){return l.apply(this,arguments)}({api:e,storage:t,force:Boolean(r)});return{type:"InvalidateMessageReactions_RequestCompleted",hasFailed:null===s,response:s}}catch(e){return{type:"InvalidateMessageReactions_RequestCompleted",hasFailed:!0,response:null}}})),function(e){return s.apply(this,arguments)})])}case"InvalidateMessageReactions_RequestCompleted":{const{response:s,hasFailed:n}=t;return n||!s||(e.locks.invalidateMessageReactions=!1,e.messageReactions=s.assets.reduce(((e,t)=>{var n,r;const a=null!=(r=null==(n=s.override_assets)?void 0:n.find((e=>e.reaction_id===t.reaction_id)))?r:t;return e.set(o.resolveId(a.reaction_id),{id:o.resolveId(a.reaction_id),image:a.links.static,animationSmall:a.links.small_animation,animationBig:a.links.big_animation,name:""}),e}),new Map)),[]}default:(0,a.exhaustivenessCheck)(t)}var s};function l(){return(l=(0,n._)((function*({api:e,storage:t,force:s=!1}){var n;const a=t.get("message-reactions-assets"),o=(new Date).getTime(),c=!a||a.expiresAt<o;let l=null;var d;if(c||s)try{var u,h;l=yield e.fetch("messages.getReactionsAssets",{client_version:null!=(h=null==(u=a)?void 0:u.response.version)?h:void 0},{retries:3})}catch(e){var m;l=(null==(m=a)?void 0:m.response)||null}else l=(null==(d=a)?void 0:d.response)||null;const p=l?(0,r._)({},l,{assets:[...(null==(n=a)?void 0:n.response.assets)||[],...l.assets],override_assets:l.override_assets||[]}):null;return(c||s)&&p&&t.set("message-reactions-assets",{response:p,expiresAt:o+i}),p}))).apply(this,arguments)}},735130:(e,t,s)=>{"use strict";s.d(t,{handler:()=>l});var n=s(11010),r=s(434788),a=s(89131),o=s(185327),i=s(991792),c=s(954811);const l=(e,t)=>{switch(t.type){case"LoadChatInfo":{const{peerId:s}=t,r=(0,i.getOwnerGroupId)(e.ownerId);return e.locks.getConversationInfo.has(s)?[]:(e.locks.getConversationInfo.add(s),[(d=(0,n._)((function*({api:e}){try{const t=yield e.fetch("messages.getConversationsById",{peer_ids:s.toString(),group_id:r,extended:0});return{type:"LoadChatInfo_RequestComplete",peerId:s,convo:t.items[0],hasFailed:!t.items[0]}}catch(e){return{type:"LoadChatInfo_RequestComplete",peerId:s,hasFailed:!0}}})),function(e){return d.apply(this,arguments)})])}case"LoadChatInfo_RequestComplete":{var s,l;const{peerId:n,convo:a,hasFailed:i}=t;e.locks.getConversationInfo.delete(n);const d=e.convos.get(n);if("ChatConvo"!==(null==(s=d)?void 0:s.kind)||i||!a)return[];const u=(0,c.fromApiConvo)(a);return"ChatConvo"!==(null==(l=u)?void 0:l.convo.kind)||(o.updateAcl(d,(0,r._)({},u.convo.acl)),o.updateMembersCount(d,u.convo.membersCount)),[]}default:(0,a.exhaustivenessCheck)(t)}var d}},339962:(e,t,s)=>{"use strict";s.d(t,{handler:()=>l});var n=s(11010),r=s(89131),a=s(185327),o=s(991792),i=s(698057),c=s(217912);const l=(e,t)=>{switch(t.type){case"LoadChatMembers":{var s,l;const{peerId:r,offset:a}=t,i=(0,o.getOwnerGroupId)(e.ownerId),c=e.convos.get(r),d="ChatConvo"!==(null==(s=c)?void 0:s.kind)||null==(l=c.members)?void 0:l.size;return[(m=(0,n._)((function*({api:e}){try{return{type:"LoadChatMembers_RequestComplete",peerId:r,response:yield e.fetch("messages.getConversationMembers",{peer_id:r,extended:1,group_id:i,count:1e3,offset:a||d},{retries:1}),hasFailed:!1}}catch(e){return{type:"LoadChatMembers_RequestComplete",peerId:r,hasFailed:!0}}})),function(e){return m.apply(this,arguments)})]}case"LoadChatMembers_RequestComplete":{var d,u;const{peerId:s,response:r,hasFailed:l}=t;e.locks.getConversationMembers.delete(s);const m=e.convos.get(s);if("ChatConvo"!==(null==(d=m)?void 0:d.kind)||l||!r)return[];const{members:p,adminIds:f,ownerId:g}=(0,i.fromApiChatMembers)(r.items),v=(0,c.fromApiChatIncognitoMemberConverter)(r.items,r.incognito_members);a.addIncognitoMembers(m,v),a.addMembers(m,p,r.count),f.forEach((e=>{a.addAdmin(m,e)})),g&&a.setOwner(m,g),(0,o.insertPeers)(e,{apiUsers:r.profiles||[],apiGroups:r.groups||[],apiContacts:r.contacts||[]});const _=a.getIncognitoMembersCount(m);return((null==(u=m.members)?void 0:u.size)||0)+_<r.count?[(h=(0,n._)((function*(){return{type:"LoadChatMembers",peerId:s}})),function(){return h.apply(this,arguments)})]:[]}default:(0,r.exhaustivenessCheck)(t)}var h,m}},427418:(e,t,s)=>{"use strict";s.d(t,{handler:()=>o});var n=s(11010),r=s(89131),a=s(991792);const o=(e,t)=>{switch(t.type){case"LoadContactList":return e.locks.contactList?[]:(e.locks.contactList=!0,[(s=(0,n._)((function*({api:e}){try{const s=yield e.fetch("account.getContactList",{extended:1,offset:t.offset},{retries:1});return{type:"LoadContactList_RequestCompleted",contacts:s.contacts||[],profiles:s.profiles||[],items:s.items||[]}}catch(e){return{type:"LoadContactList_RequestCompleted",contacts:[],profiles:[],items:[]}}})),function(e){return s.apply(this,arguments)})]);case"LoadContactList_RequestCompleted":return e.locks.contactList=!1,(0,a.insertContacts)(e,t.contacts),(0,a.insertContactItems)(e,t.items,t.profiles),e.contacts.hasMore=!1,[];default:(0,r.exhaustivenessCheck)(t)}var s}},61448:(e,t,s)=>{"use strict";s.d(t,{getImportantMessageKey:()=>c,handler:()=>i});var n=s(11010),r=s(89131),a=s(481186),o=s(991792);const i=(e,t)=>{switch(t.type){case"LoadImportantMessages":{const t=20*Math.floor(e.importantMessages.messages.size/20),s=e.ownerId;return[(l=(0,n._)((function*({api:e}){try{return{type:"LoadImportantMessages_RequestCompleted",hasFailed:!1,response:yield e.fetch("messages.getImportantMessages",{count:20,offset:t,extended:1,group_id:(0,o.getOwnerGroupId)(s)})}}catch(e){return{type:"Noop"}}})),function(e){return l.apply(this,arguments)})]}case"LoadImportantMessages_RequestCompleted":{var s,i;const{response:{messages:n,profiles:r,groups:l,conversations:d}}=t;return((null==(s=n.items)?void 0:s.length)||0)<20&&(e.importantMessages.hasMore=!1),(0,o.insertConvos)(e,d||[]),(0,o.insertPeers)(e,{apiUsers:r||[],apiGroups:l||[],apiContacts:[]}),null==(i=n.items)||i.forEach((t=>{const{message:s}=(0,a.fromApiMessage)(t);"Normal"===s.kind&&e.importantMessages.messages.set(c(s.peerId,s.cmid),s)})),[]}case"UserClosedImportantMessages":return e.importantMessages.messages.clear(),e.importantMessages.hasMore=!0,[];default:return(0,r.exhaustivenessCheck)(t)}var l},c=(e,t)=>`${e}-${t}`},15778:(e,t,s)=>{"use strict";s.d(t,{handler:()=>o});var n=s(11010),r=s(89131),a=s(991792);const o=(e,t)=>{switch(t.type){case"LoadRecommendedFolders":return e.locks.loadRecommendedFolders||e.organisers.recommendedFolders.length?[]:(e.locks.loadRecommendedFolders=!0,[(s=(0,n._)((function*({api:e}){try{var t;const s=yield e.fetch("messages.getRecommendedFolders",{group_id:0});return{type:"LoadRecommendedFolders_RequestComplete",recommendedFolders:s.items||[],hasFailed:!(null==(t=s.items)?void 0:t.length)}}catch(e){return{type:"LoadRecommendedFolders_RequestComplete",recommendedFolders:[],hasFailed:!0}}})),function(e){return s.apply(this,arguments)})]);case"LoadRecommendedFolders_RequestComplete":{const{recommendedFolders:s,hasFailed:n}=t;return e.locks.loadRecommendedFolders=n,(0,a.insertRecommendedFolders)(e,s||[]),[]}default:(0,r.exhaustivenessCheck)(t)}var s}},228153:(e,t,s)=>{"use strict";s.d(t,{handler:()=>o});var n=s(11010),r=s(89131),a=s(986727);const o=(e,t)=>{switch(t.type){case"LoadStickers":{const{stickers:s,locks:{loadStickers:r}}=e,a=t.stickerIds.filter((e=>!r.has(e)&&!s.has(e)));return a.length?(e.locks.loadStickers=new Set([...r,...a]),[(0,n._)((function*({api:e}){try{return{type:"LoadStickers_RequestCompleted",response:yield e.fetch("store.getStickers",{sticker_ids:a.join()})}}catch(e){}return{type:"LoadStickers_RequestCompleted",hasFailed:!0}}))]):[]}case"LoadStickers_RequestCompleted":{const{response:s,hasFailed:n}=t;if(n||!s)return[];const{stickers:r}=e;return s.forEach((e=>{const t=(0,a.fromApiSticker)(e);t&&r.set(t.id,t)})),[]}default:(0,r.exhaustivenessCheck)(t)}}},382379:(e,t,s)=>{"use strict";s.d(t,{handler:()=>l});var n=s(11010),r=s(434788),a=s(991792),o=s(95154),i=s(452788),c=s(89131);const l=(e,t)=>{switch(t.type){case"MoreChannelsNeeded":{const{organiser:a}=t,{filter:c}=a,l=i.getLockId(c);if(e.locks.getChannels[l]||!e.organisers.channelFilters[c].hasMore)return[];const{minorSortId:d,channelId:u}=e.organisers.channelFilters[c].boundary;e.locks.getChannels[l]=!0;const h=o.CHANNELS_PER_PAGE+1,m=i.isLoaded(e.organisers.channelFilters[c])?d:void 0;return[(s=(0,n._)((function*({api:e}){try{var s;const n=yield e.fetch("channels.get",{count:h,offset_minor_sort_id:m,offset_channel_id:u,filter:i.snakeCaseId(a.filter),extended:1},{retries:3});return(0,r._)({},t,{type:"MoreChannelsNeeded_RequestCompleted",hasFailed:!1,response:n,hasMore:((null==(s=n.items)?void 0:s.length)||0)>=h})}catch(e){return(0,r._)({},t,{type:"MoreChannelsNeeded_RequestCompleted",hasFailed:!0,hasMore:!1})}})),function(e){return s.apply(this,arguments)})]}case"MoreChannelsNeeded_RequestCompleted":{const{hasFailed:s,organiser:n,hasMore:r}=t;let o="";if("channelFilters"===n.kind)o=i.getLockId(n.filter);else(0,c.exhaustivenessCheck)(n.kind);if(e.locks.getChannels[o]=!1,s)return[];const{response:l}=t;if(l){const t=(0,a.insertChannels)(e,{apiChannels:l.items||[],apiGroups:l.groups||[]});if((0,a.insertPeers)(e,{apiUsers:l.profiles||[],apiGroups:l.groups||[],apiContacts:[]}),"channelFilters"===n.kind)i.push(e.organisers.channelFilters,n.filter,t,r);else(0,c.exhaustivenessCheck)(n.kind)}return[]}default:(0,c.exhaustivenessCheck)(t)}var s}},203677:(e,t,s)=>{"use strict";s.d(t,{handler:()=>d});var n=s(11010),r=s(434788),a=s(991792),o=s(95154),i=s(498928),c=s(89131),l=s(999504);const d=(e,t)=>{switch(t.type){case"MoreConvosNeeded":{const{organiser:d}=t,u=e.ownerId;let h,m="";switch(d.kind){case"filters":{const{filter:t}=d;if(m=i.getLockId(t),e.locks.getConversations[m]||!e.organisers.filters[t].hasMore)return[];h={start_message_id:i.isLoaded(e.organisers.filters[t])?e.organisers.filters[t].boundary.minorSortId:void 0,filter:i.snakeCaseId(t),extended:1,group_id:(0,a.getOwnerGroupId)(u)};break}case"folders":{const{id:t,filter:s}=d;m=l.getLockId(t,s);const n=e.organisers.folders.find((e=>e.id===t));if(!n)throw new Error("Не найдена папка");if(e.locks.getConversations[m]||l.isLoaded(n,s)&&!n[s].hasMore)return[];h={start_message_id:l.isLoaded(n,s)?n[s].boundaryMinorId:void 0,folder_id:n.id,filter:s,extended:1,group_id:(0,a.getOwnerGroupId)(u)};break}default:(0,c.exhaustivenessCheck)(d)}return e.locks.getConversations[m]=!0,[(s=(0,n._)((function*({api:e}){try{if(!h)throw new Error("Нет параметров запроса");const s=o.CONVOS_PER_PAGE,n=yield e.fetch("messages.getConversations",(0,r._)({},h,{count:s}),{retries:3});return(0,r._)({},t,{type:"MoreConvosNeeded_RequestCompleted",hasFailed:!1,requestedCount:s,hasMore:n.items.length>=s,response:n})}catch(e){return(0,r._)({},t,{type:"MoreConvosNeeded_RequestCompleted",hasMore:!1,hasFailed:!0})}})),function(e){return s.apply(this,arguments)})]}case"MoreConvosNeeded_RequestCompleted":{const{hasFailed:s,organiser:n,hasMore:r}=t;let o="";switch(n.kind){case"filters":o=i.getLockId(n.filter);break;case"folders":o=l.getLockId(n.id,n.filter);break;default:(0,c.exhaustivenessCheck)(n)}if(e.locks.getConversations[o]=!1,s)return[];const{response:d}=t;if(d){const t=(0,a.insertConvos)(e,d.items,{dangerouslyMerge:!0});switch((0,a.insertPeers)(e,{apiUsers:d.profiles||[],apiGroups:d.groups||[],apiContacts:d.contacts||[]}),n.kind){case"filters":i.push(e.organisers.filters,n.filter,t,r);break;case"folders":if(!e.organisers.folders.find((e=>e.id===n.id)))return[];l.push(e.organisers.folders,n.id,n.filter,t,r);break;default:(0,c.exhaustivenessCheck)(n)}}return[]}default:(0,c.exhaustivenessCheck)(t)}var s}},628010:(e,t,s)=>{"use strict";s.d(t,{handler:()=>d});var n=s(11010),r=s(434788),a=s(839963),o=s(86144),i=s(168465),c=s(434425),l=s(89131);const d=(e,t)=>{switch(t.type){case"PollChannelPosts":{const{channelId:s,fromCmid:a,toCmid:o}=t,c=e.channels.get(s);if(!c||"Channel"!==c.kind)return[];const l=null!=o?o:i.lastCmid(c.history);if(!l)return[];const d=i.around(c.history,a);if(void 0===d)return[];const u=d.nodes.reduce(((e,t)=>{const s=i.nodeCmid(t);return void 0!==s&&s>=a&&s<=l&&e.push(s),e}),[]).slice(-200);return[(r=(0,n._)((function*({api:e}){try{const t=yield e.fetch("channels.getChannelMessagesCounters",{channel_id:s,cmids:u.join(",")});return{type:"PollChannelPosts_RequestSucceed",channelId:s,response:t}}catch(e){console.error(e)}return{type:"Noop"}})),function(e){return r.apply(this,arguments)})]}case"PollChannelPosts_RequestSucceed":{var s;const{channelId:n,response:r}=t,i=e.channels.get(n);return i&&"Channel"===i.kind?(null==(s=r.items)||s.forEach((e=>{const t=a.findPostByCmid(i,o.resolveCmid(e.message_id));t&&"Node"===t.kind&&u(t.item,e)})),[]):[]}default:(0,l.exhaustivenessCheck)(t)}var r},u=(e,t)=>{var s,n,a,o,i,l;t.comments&&(e.comments=(0,r._)({},e.comments,{canPost:!!(null!=(n=t.comments.can_post)?n:e.comments.canPost),canView:!!(null!=(a=t.comments.can_view)?a:e.comments.canView),count:null!=(o=t.comments.count)?o:e.comments.count}));(t.reactions?e.likes=(0,r._)({},e.likes,{count:t.reactions.count,reactionId:void 0!==t.reactions.user_reaction?c.resolveId(t.reactions.user_reaction):void 0}):(e.likes.count=0,e.likes.reactionId=void 0),t.reposts)&&(e.reposts={count:t.reposts.count,isReposted:!!(null!=(i=t.reposts.user_reposted)?i:e.reposts.isReposted)});e.views=null!=(l=null==(s=t.views)?void 0:s.count)?l:e.views}},565321:(e,t,s)=>{"use strict";s.d(t,{handler:()=>d});var n=s(11010),r=s(89131),a=s(777634),o=s(185327),i=s(168465),c=s(991792),l=s(858289);const d=(e,t,s)=>{if(!s.vkm_reactions)return[];switch(t.type){case"PollConvoReactions":{const{peerId:s,fromCmid:r,toCmid:a}=t,o=e.convos.get(s);if(!o)return[];const l=i.around(o.history,r);if(void 0===l)return[];const d=l.nodes.reduce(((e,t)=>{const s="Node"===t.kind?t.item.cmid:void 0;return void 0!==s&&s>=r&&s<=a&&e.push(s),e}),[]).slice(-100),h=e.ownerId;return[(u=(0,n._)((function*({api:e}){try{const t=yield e.fetch("messages.getMessagesReactions",{peer_id:s,cmids:d.join(","),extended:1,group_id:(0,c.getOwnerGroupId)(h)});return{type:"PollConvoReactions_RequestSucceed",peerId:s,cmids:d,apiResponse:t}}catch(e){}return{type:"Noop"}})),function(e){return u.apply(this,arguments)})]}case"PollConvoReactions_RequestSucceed":{const{peerId:s,apiResponse:r,cmids:i}=t;(0,c.insertPeers)(e,{apiUsers:r.profiles||[],apiGroups:r.groups||[],apiContacts:r.contacts||[]});const u=e.convos.get(s);if(!u)return[];const h=new Set(r.items.map((e=>a.resolveCmid(e.cmid))));let m=!1;i.filter((e=>!h.has(e))).forEach((e=>{var t;const s=o.findMessageByCmid(u,a.resolveCmid(e));"Normal"===(null==(t=s)?void 0:t.kind)&&0!==s.reactions.size&&a.setReactions(s,[])}));for(const{cmid:t,counters:s}of r.items){var d;const n=o.findMessageByCmid(u,a.resolveCmid(t));if("Normal"!==(null==(d=n)?void 0:d.kind))continue;const r=(0,l.fromApiMessageReactions)(s);a.setReactions(n,Array.from(r.values())),m||(m=Array.from(r.keys()).some((t=>!e.messageReactions.has(t))))}return m?[(0,n._)((function*(){return{type:"InvalidateMessageReactions",force:!0}}))]:[]}default:(0,r.exhaustivenessCheck)(t)}var u}},192241:(e,t,s)=>{"use strict";s.d(t,{handler:()=>i});var n=s(11010),r=s(434788),a=s(96190),o=s(882670);const i=(e,t)=>{const{next:s}=t;if("Reconnecting"===s.kind)return[(i=(0,n._)((function*({queue:e}){return{type:"QueueBatchReceived",next:yield e.poll()}})),function(e){return i.apply(this,arguments)})];var i;if("Disconnected"===s.kind){if("manual"===s.reason)return[];const t=e.viewer.id;return[function(){var e=(0,n._)((function*({queue:e,api:s}){const n=yield s.fetch("queue.subscribe",{queue_ids:`onlfriends_${t},accountcounters_${t}`},{retries:1/0});return e.connect((0,r._)({user_id:a.toRealId(t)},n)),{type:"QueueBatchReceived",next:yield e.poll()}}));return function(t){return e.apply(this,arguments)}}()]}for(const t of s.events)switch(t.entity_type){case"online":const s=a.resolveId(t.data.user_id);if(!a.isUserPeerId(s))break;e.lastSeens.set(s,{isOnline:!!t.data.online,at:1e3*t.data.last_seen,platform:(0,o.convertPlatform)(t.data.platform,t.data.app_id)});break;case"accountcounters":if("calls"===t.data.type)e.activeCallsCount=t.data.count;else{t.data.type}break;default:}return[function(){var e=(0,n._)((function*({queue:e}){return{type:"QueueBatchReceived",next:yield e.poll()}}));return function(t){return e.apply(this,arguments)}}()]}},939903:(e,t,s)=>{"use strict";s.d(t,{handler:()=>i});var n=s(11010),r=s(89131),a=s(498928),o=s(991792);const i=(e,t)=>{switch(t.type){case"ResetUpdatesCounter":{const t=e.ownerId;return[(0,n._)((function*({api:e}){try{return{type:"ResetUpdatesCounter_RequestCompleted",hasFailed:!(yield e.fetch("messages.resetUpdatesCounter",{group_id:(0,o.getOwnerGroupId)(t)}))}}catch(e){return{type:"ResetUpdatesCounter_RequestCompleted",hasFailed:!0}}}))]}case"ResetUpdatesCounter_RequestCompleted":{const{hasFailed:r}=t;return r?[]:(a.updateCounters(e.organisers.filters,{headerNotMutedUnread:0}),[(s=(0,n._)((function*({notification:e}){return e.setCounters({unreadIdle:0}),{type:"Noop"}})),function(e){return s.apply(this,arguments)})])}default:(0,r.exhaustivenessCheck)(t)}var s}},619444:(e,t,s)=>{"use strict";s.d(t,{handler:()=>a});var n=s(11010),r=s(89131);const a=(e,t)=>{const{type:s}=t;switch(s){case"SettingExperimentalUpdated":return e.viewer.settings.messageSelfMentionHighlighting=t.messageMentionHighlighting,[(a=(0,n._)((function*(e){try{e.storage.set("settings-message-self-mention-highlighting",t.messageMentionHighlighting)}finally{return{type:"SettingExperimentalUpdated_RequestCompleted"}}})),function(e){return a.apply(this,arguments)})];case"SettingExperimentalUpdated_RequestCompleted":return[];default:(0,r.exhaustivenessCheck)(s)}var a}},526025:(e,t,s)=>{"use strict";s.d(t,{handler:()=>a});var n=s(11010),r=s(89131);const a=(e,t)=>{const{type:s}=t;switch(s){case"SettingThemeUpdated":{e.locks.settings.add("theme");const s=e.viewer.settings.theme;return e.viewer.settings.theme=t.value,[(a=(0,n._)((function*(e){try{return e.storage.set("theme",t.value),{type:"SettingThemeUpdated_RequestCompleted",hasFailed:!1,previousValue:s}}catch(e){return{type:"SettingThemeUpdated_RequestCompleted",hasFailed:!0,previousValue:s}}})),function(e){return a.apply(this,arguments)})]}case"SettingThemeUpdated_RequestCompleted":return e.locks.settings.delete("theme"),t.hasFailed&&(e.viewer.settings.theme=t.previousValue),[];default:(0,r.exhaustivenessCheck)(s)}var a}},695247:(e,t,s)=>{"use strict";s.d(t,{handler:()=>a});var n=s(11010),r=s(89131);const a=(e,t)=>{const{type:s}=t;switch(s){case"UserChangedBrowserNotifications":{e.locks.settings.add("browserNotifications");const s=e.viewer.settings.browserNotifications;return e.viewer.settings.browserNotifications=t.value,[(a=(0,n._)((function*(e){try{return e.storage.set("settings-browser-notifications-on",t.value),{type:"UserChangedBrowserNotifications_RequestCompleted",hasFailed:!1,previousValue:s}}catch(e){return{type:"UserChangedBrowserNotifications_RequestCompleted",hasFailed:!0,previousValue:s}}})),function(e){return a.apply(this,arguments)})]}case"UserChangedBrowserNotifications_RequestCompleted":return e.locks.settings.delete("browserNotifications"),t.hasFailed&&(e.viewer.settings.browserNotifications=t.previousValue),[];default:(0,r.exhaustivenessCheck)(s)}var a}},82358:(e,t,s)=>{"use strict";s.d(t,{handler:()=>a});var n=s(11010),r=s(89131);const a=(e,t)=>{const{type:s}=t;switch(s){case"UserChangedBubblesTheme":return e.viewer.settings.bubblesTheme=t.value,[(a=(0,n._)((function*(e){try{e.storage.set("settings-bubbles-theme",t.value)}finally{return{type:"UserChangedBubblesTheme_RequestCompleted"}}})),function(e){return a.apply(this,arguments)})];case"UserChangedBubblesTheme_RequestCompleted":return[];default:(0,r.exhaustivenessCheck)(s)}var a}},584781:(e,t,s)=>{"use strict";s.d(t,{handler:()=>d});var n=s(11010),r=s(89131),a=s(839963),o=s(83062),i=s(197934);const c={archive:"archive",unarchive:"unarchive",join:"join",leave:"join",mute:"mute",unmute:"unmute",mark_read:"mark_read"},l={archive:"unarchive",unarchive:"archive",join:"leave",leave:"join",mute:"unmute",unmute:"mute"},d=(e,t,s)=>{const{type:c}=t;switch(c){case"UserChangedChannel":{const{channelId:s,userAction:i}=t,c=u(t.userAction,s);if(e.locks.channelActions.has(c))return[];e.locks.channelActions.add(c);const l=e.channels.get(s);if(!l)return[];if("ChannelRestricted"===l.kind)return[];let d;switch(i){case"archive":a.setArchived(l,!0),o.refreshChannels(e.organisers,l),d=e=>e.fetch("channels.archive",{channel_ids:String(s)}).then((e=>Boolean(e)));break;case"unarchive":a.setArchived(l,!1),o.refreshChannels(e.organisers,l),d=e=>e.fetch("channels.unarchive",{channel_ids:String(s),extended:1}).then((e=>Boolean(e)));break;case"join":a.setMembership(l,!0),o.refreshChannels(e.organisers,l),d=e=>e.fetch("channels.join",{channel_id:s,extended:1}).then((e=>Boolean(e)));break;case"leave":a.setMembership(l,!1),o.refreshChannels(e.organisers,l),d=e=>e.fetch("channels.leave",{channel_id:s});break;case"mute":a.setMuted(l,!0),d=e=>e.fetch("channels.setNotificationMode",{channel_id:s,mode:"disabled"}).then((e=>Boolean(e)));break;case"unmute":a.setMuted(l,!1),d=e=>e.fetch("channels.setNotificationMode",{channel_id:s,mode:"enabled"}).then((e=>Boolean(e)));break;case"mark_read":{const e=a.lastPost({channel:l,withPending:!1});if(e){const t=e.cmid;l.inReadCmid=t,d=e=>e.fetch("channels.markAsRead",{last_read_cmid:t,channel_id:s})}break}default:(0,r.exhaustivenessCheck)(i)}return[(p=(0,n._)((function*({api:e}){try{let t=!1;return d&&(t=!(yield d(e))),{type:"UserChangedChannel_RequestCompleted",channelId:s,hasFailed:t,userAction:i}}catch(e){return{type:"UserChangedChannel_RequestCompleted",channelId:s,hasFailed:!0,userAction:i}}})),function(e){return p.apply(this,arguments)})]}case"UserChangedChannel_RequestCompleted":{const{channelId:n,userAction:r,hasFailed:a}=t,o=u(r,n);e.locks.channelActions.delete(o);const i=l[r];return a&&i&&(d(e,{type:"UserChangedChannel",userAction:i,channelId:n},s),e.locks.channelActions.delete(o)),[]}case"UserSetChannelPhoto":{var h,m;const{channelId:s,photo:n}=t,r=e.channels.get(s);return r&&"Channel"===r.kind?(a.setPhotos(r,{photo50:null==(h=i.preview(n,50,50,!0))?void 0:h.url,photo100:null==(m=i.preview(n,100,100,!0))?void 0:m.url}),[]):[]}case"UserUpdateChannelInfo":{const{channelId:s,name:n,description:r}=t,a=e.channels.get(s);return a&&"Channel"===a.kind?(n&&(a.name=n),void 0!==r&&(a.description=r),[]):[]}default:(0,r.exhaustivenessCheck)(c)}var p},u=(e,t)=>`${c[e]}-${t.toString()}`},637467:(e,t,s)=>{"use strict";s.d(t,{handler:()=>d});var n=s(11010),r=s(434788),a=s(559360),o=s(86144),i=s(89131),c=s(453934),l=s(29064);const d=(e,t)=>{const{channelId:s}=t;var d;const u=null!=(d=e.channelComposerDrafts[s])?d:a.empty();let h=a.empty();switch(t.type){case"UserChangedChannelComposerDraft":switch(t.kind){case"text":{const{text:e,visibility:s,donutDelay:n,topic:a,date:o,sendOptions:i,resetSendOptions:c}=t;h=(0,r._)({},u,{text:null!=e?e:u.text,visibility:s||u.visibility,donutDelay:n||u.donutDelay,topic:a||u.topic,date:o,sendOptions:i||u.sendOptions,resetSendOptions:c||u.resetSendOptions});break}case"addAttaches":case"removeAttach":case"removeVoice":case"startUploading":case"removeUploads":case"rearrangeAttaches":const e=(0,l.applyAttachmentActions)(u,t);h=(0,r._)({},u,e);break;case"editing":{var m;const{editing:e}=t,s=[],n=["mute_notifications"];e.comments.canPost&&e.comments.canView||s.push("close_comments"),e.signerId&&s.push("signed"),e.markedAsAds&&s.push("mark_as_ads"),h={editing:e,text:o.toRawText(e),attaches:e.attaches,uploadsTrackIds:u.uploadsTrackIds,visibility:o.isDonut(e)?"donut":"all",donutDelay:(null==(m=e.donut)?void 0:m.duration)||-1,topic:a.getPostThemeKeyFromId(e.topicId),sendOptions:{selected:s,disabled:n},resetSendOptions:[]};break}default:(0,i.exhaustivenessCheck)(t)}break;case"UserClearedChannelComposerDraft":break;default:(0,i.exhaustivenessCheck)(t)}!h.text&&0===Object.keys(h.attaches).length&&0===h.uploadsTrackIds.size&&"all"===h.visibility&&"no_theme"===h.topic&&void 0===h.date&&-1===h.donutDelay&&0===h.sendOptions.selected.length&&0===h.sendOptions.disabled.length&&0===h.resetSendOptions.length?delete e.channelComposerDrafts[s]:e.channelComposerDrafts[s]=h;const p=(0,c.current)(e.channelComposerDrafts);return[(0,n._)((function*({storage:e}){return e.set("channels-drafts",p),{type:"Noop"}}))]}},12190:(e,t,s)=>{"use strict";s.d(t,{handler:()=>c});var n=s(11010),r=s(89131),a=s(839963),o=s(168465);const i={delete:"delete",restore:"restore",report:"report"},c=(e,t,s)=>{const{type:i}=t;switch(i){case"UserChangedChannelPost":{const{channelId:s,cmid:i,userAction:c}=t,u=l(t.userAction.kind,s,i);if(e.locks.channelPostActions.has(u))return[];e.locks.channelPostActions.add(u);const h=e.channels.get(s);if(!h)return[];if("ChannelRestricted"===h.kind)return[];const m=o.findNodeByCmid(h.history,i);if("NotLoaded"===m.status)return[];let p;switch(c.kind){case"delete":if("Deleted"===m.status)break;a.deletePost(h,i,{isRestorable:!0,isSpam:!0}),p=e=>e.fetch("wall.delete",{owner_id:s,post_id:i}).then((e=>Boolean(e)));break;case"restore":if("Deleted"!==m.status)break;a.restorePost(h,i),p=e=>e.fetch("wall.restore",{owner_id:s,post_id:i}).then((e=>Boolean(e)));break;case"report":if("Deleted"===m.status)break;a.deletePost(h,i,{isRestorable:!0,isSpam:!0}),p=e=>e.fetch("wall.reportPost",{owner_id:s,post_id:i,reason:c.reason}).then((e=>Boolean(e)));break;default:(0,r.exhaustivenessCheck)(c)}return[(d=(0,n._)((function*({api:e}){try{let t=!1;return p&&(t=!(yield p(e))),{type:"UserChangedChannelPost_RequestCompleted",channelId:s,cmid:i,hasFailed:t,userAction:c}}catch(e){return{type:"UserChangedChannelPost_RequestCompleted",channelId:s,cmid:i,hasFailed:!0,userAction:c}}})),function(e){return d.apply(this,arguments)})]}case"UserChangedChannelPost_RequestCompleted":{const{channelId:n,cmid:a,userAction:o,hasFailed:i}=t,d=l(o.kind,n,a);if(e.locks.channelPostActions.delete(d),i){let t;switch(o.kind){case"delete":case"report":t={kind:"restore"};break;case"restore":t={kind:"delete"};break;default:(0,r.exhaustivenessCheck)(o)}t&&c(e,{type:"UserChangedChannelPost",userAction:t,channelId:n,cmid:a},s),e.locks.channelPostActions.delete(d)}return[]}default:(0,r.exhaustivenessCheck)(i)}var d},l=(e,t,s)=>`${i[e]}-${t.toString()}-${s}`},623022:(e,t,s)=>{"use strict";s.d(t,{handler:()=>l});var n=s(11010),r=s(89131),a=s(96190),o=s(185327),i=s(197934),c=s(991792);const l=(e,t)=>{const{type:s}=t;switch(s){case"UserChangedChatTitle":{const{peerId:s,title:r}=t,o=a.toRealId(s),i=e.peers.get(s),l=e.ownerId;if(!i||"Chat"!==i.kind)return[];const d=i.title;return a.updateChatInfo(i,{title:r}),[(h=(0,n._)((function*({api:e}){try{const t=yield e.fetch("messages.editChat",{chat_id:o,title:r,group_id:(0,c.getOwnerGroupId)(l)},{retries:1});return{type:"UserChangedChatTitle_RequestCompleted",hasFailed:1!==t,peerId:s,title:1!==t?d:r}}catch(e){return{type:"UserChangedChatTitle_RequestCompleted",hasFailed:!0,peerId:s,title:d}}})),function(e){return h.apply(this,arguments)})]}case"UserChangedChatTitle_RequestCompleted":{const{peerId:s,title:n,hasFailed:r}=t,o=e.peers.get(s);return o&&"Chat"===o.kind&&r?(a.updateChatInfo(o,{title:n}),[]):[]}case"UserChangedChatDescription":{const{peerId:s,description:r}=t,i=a.toRealId(s),l=e.convos.get(s),d=e.ownerId;if(!l||"ChatConvo"!==l.kind&&"GroupConvo"!==l.kind)return[];const u=l.description;return o.setDescription(l,r),[function(){var e=(0,n._)((function*({api:e}){try{const t=yield e.fetch("messages.editChat",{chat_id:i,description:r,group_id:(0,c.getOwnerGroupId)(d)},{retries:1});return{type:"UserChangedChatDescription_RequestCompleted",hasFailed:1!==t,peerId:s,description:1!==t?u:r}}catch(e){return{type:"UserChangedChatDescription_RequestCompleted",hasFailed:!0,peerId:s,description:u}}}));return function(t){return e.apply(this,arguments)}}()]}case"UserChangedChatDescription_RequestCompleted":{const{peerId:s,description:n,hasFailed:r}=t,a=e.convos.get(s);return!a||"ChatConvo"!==a.kind&&"GroupConvo"!==a.kind?[]:r?(o.setDescription(a,n),[]):[]}case"UserSetChatPhoto":{var l,d,u;const{peerId:s,photo:n}=t,r=e.peers.get(s);return r&&"Chat"===r.kind?(a.updateChatInfo(r,{photo50:null==(l=i.preview(n,50,50))?void 0:l.url,photo100:null==(d=i.preview(n,100,100))?void 0:d.url,photo200:null==(u=i.preview(n,200,200))?void 0:u.url}),[]):[]}case"UserRemovedChatPhoto":{const{peerId:s}=t,r=e.ownerId,o=a.toRealId(s),i=e.peers.get(s);return i&&"Chat"===i.kind?(a.updateChatInfo(i,{photo50:void 0,photo100:void 0,photo200:void 0}),[function(){var e=(0,n._)((function*({api:e}){try{return yield e.fetch("messages.deleteChatPhoto",{chat_id:o,group_id:(0,c.getOwnerGroupId)(r)},{retries:1}),{type:"UserRemovedChatPhoto_RequestCompleted",hasFailed:!1,peerId:s}}catch(e){return{type:"UserRemovedChatPhoto_RequestCompleted",hasFailed:!0,peerId:s}}}));return function(t){return e.apply(this,arguments)}}()]):[]}case"UserRemovedChatPhoto_RequestCompleted":return[];case"UserChangedChatSettings":{const{peerId:s,isService:r,permissions:o}=t,i=a.toRealId(s),l=e.ownerId;return[function(){var e=(0,n._)((function*({api:e}){try{return{type:"UserChangedChatSettings_RequestCompleted",hasFailed:1!==(yield e.fetch("messages.editChat",{chat_id:i,is_service:r?1:0,permissions:JSON.stringify(o),group_id:(0,c.getOwnerGroupId)(l)},{retries:1})),permissions:o,peerId:s,isService:r}}catch(e){return{type:"UserChangedChatSettings_RequestCompleted",hasFailed:!0,permissions:o,peerId:s,isService:r}}}));return function(t){return e.apply(this,arguments)}}()]}case"UserChangedChatSettings_RequestCompleted":{const{peerId:s,isService:n,permissions:r,hasFailed:a}=t;if(a)return[];const i=e.convos.get(s);return i&&"ChatConvo"===i.kind?(o.setChatPermissions(i,r,n),[]):[]}default:(0,r.exhaustivenessCheck)(s)}var h}},541222:(e,t,s)=>{"use strict";s.d(t,{handler:()=>c});var n=s(11010),r=s(89131),a=s(96190),o=s(185327),i=s(991792);const c=(e,t)=>{switch(t.type){case"UserChangedChatMember":{const{peerId:s,memberId:o,userAction:c}=t;if(!e.convos.get(s))return[];const l=function(e,t){const{userAction:s,peerId:n,memberId:o}=t;switch(s){case"promote":return({api:e})=>e.fetch("messages.setMemberRole",{member_id:o,peer_id:n,role:"admin"});case"demote":return({api:e})=>e.fetch("messages.setMemberRole",{member_id:o,peer_id:n,role:"member"});case"cancel_invitation":case"remove":return({api:t})=>t.fetch("messages.removeChatUser",{chat_id:a.toRealId(n),member_id:o,group_id:(0,i.getOwnerGroupId)(e)});default:return(0,r.exhaustivenessCheck)(s)}}(e.ownerId,t);return[(d=(0,n._)((function*(e){try{return{type:"UserChangedChatMember_RequestCompleted",hasFailed:1!==(yield l(e)),peerId:s,memberId:o,userAction:c}}catch(e){return{type:"UserChangedChatMember_RequestCompleted",hasFailed:!0,peerId:s,memberId:o,userAction:c}}})),function(e){return d.apply(this,arguments)})]}case"UserRemoveIncognitoMember":{const{peerId:s,userAction:r,incognitoId:o}=t,c=e.convos.get(s),l=e.ownerId;return c?[function(){var e=(0,n._)((function*({api:e}){try{return{type:"UserRemoveIncognitoMember_RequestCompleted",hasFailed:1!==(yield e.fetch("messages.removeChatUser",{chat_id:a.toRealId(s),incognito_id:o,group_id:(0,i.getOwnerGroupId)(l)})),peerId:s,incognitoId:o,userAction:r}}catch(e){return{type:"UserRemoveIncognitoMember_RequestCompleted",hasFailed:!0,peerId:s,incognitoId:o,userAction:r}}}));return function(t){return e.apply(this,arguments)}}()]:[]}case"UserChangedChatMember_RequestCompleted":{var s;const{memberId:n,peerId:r,userAction:i,hasFailed:c}=t,l=e.convos.get(r);return c||"ChatConvo"!==(null==(s=l)?void 0:s.kind)?[]:("cancel_invitation"===i&&o.removeMember(l,n),a.isContactPeerId(n)||("promote"===i&&o.addAdmin(l,n),"demote"===i&&o.removeAdmin(l,n),"remove"===i&&o.removeMember(l,n)),[])}case"UserRemoveIncognitoMember_RequestCompleted":{var c,l;const{incognitoId:s,peerId:n,hasFailed:r}=t,i=e.convos.get(n);if(r||"ChatConvo"!==(null==(c=i)?void 0:c.kind))return[];const d=o.getIncognitoMember(i,s);o.removeIncognitoMember(i,s);const u=a.resolveId(null==(l=d)?void 0:l.memberId);return u&&o.removeMember(i,u),[]}default:return(0,r.exhaustivenessCheck)(t)}var d}},601289:(e,t,s)=>{"use strict";s.d(t,{handler:()=>l});var n=s(11010),r=s(89131),a=s(86144),o=s(866358),i=s(168465);const c={delete:"delete",restore:"restore",report:"report"},l=(e,t,s)=>{var c,u;const{type:h,channelId:m,postCmid:p,commentCmid:f,userAction:g}=t,v=d(g.kind,m,p,f),_=e.channels.get(m);if("ChannelRestricted"===(null==(c=_)?void 0:c.kind))return[];const C=_&&i.findNodeByCmid(_.history,p).node,y="Node"===(null==(u=C)?void 0:u.kind)&&C.item,k=y&&a.findCommentByCmid(y,f);if(!k)return[];switch(h){case"UserChangedComment":{if(e.locks.commentActions.has(v))return[];let t;switch(e.locks.commentActions.add(v),g.kind){case"delete":{if("Normal"!==k.kind)break;const e=o.markDeleted(k);a.replaceComment(y,e),t=t=>t.fetch("wall.deleteComment",{owner_id:m,comment_id:e.cmid}).then((e=>Boolean(e)));break}case"restore":{if("MarkedDeleted"!==k.kind)break;const e=o.restoreDeleted(k);a.replaceComment(y,e),t=t=>t.fetch("wall.restoreComment",{owner_id:m,comment_id:e.cmid}).then((e=>Boolean(e)));break}case"report":{if("Normal"!==k.kind)break;a.deleteComment(y,k.cmid);const e=k.cmid;t=t=>t.fetch("wall.reportComment",{owner_id:m,comment_id:e,reason:g.reason}).then((e=>Boolean(e)));break}default:(0,r.exhaustivenessCheck)(g)}return[(I=(0,n._)((function*({api:e}){try{let s=!1;return t&&(s=!(yield t(e))),{type:"UserChangedComment_RequestCompleted",channelId:m,postCmid:p,commentCmid:f,hasFailed:s,userAction:g}}catch(e){return{type:"UserChangedComment_RequestCompleted",channelId:m,postCmid:p,commentCmid:f,hasFailed:!0,userAction:g}}})),function(e){return I.apply(this,arguments)})]}case"UserChangedComment_RequestCompleted":{const{hasFailed:n}=t;if(e.locks.commentActions.delete(v),n){let t;switch(g.kind){case"delete":case"report":t={kind:"restore"};break;case"restore":t={kind:"delete"};break;default:(0,r.exhaustivenessCheck)(g)}t&&l(e,{type:"UserChangedComment",userAction:t,channelId:m,postCmid:p,commentCmid:f},s),e.locks.commentActions.delete(v)}return[]}default:(0,r.exhaustivenessCheck)(t)}var I},d=(e,t,s,n)=>`${c[e]}-${t}-${s}-${n}`},847281:(e,t,s)=>{"use strict";s.d(t,{handler:()=>d});var n=s(11010),r=s(434788),a=s(655829),o=s(866358),i=s(89131),c=s(453934),l=s(29064);const d=(e,t)=>{const{channelId:s,postCmid:d}=t,u=`${s}-${d}`;var h;const m=null!=(h=e.commentsComposerDrafts[u])?h:a.empty();let p=a.empty();switch(t.type){case"UserChangedCommentsComposerDraft":switch(t.kind){case"text":{const{text:e}=t;p=(0,r._)({},m,{text:null!=e?e:m.text});break}case"editing":{const{editing:e}=t;p={editing:e,text:o.toRawText(e),attaches:e.attaches,uploadsTrackIds:m.uploadsTrackIds,reply:void 0};break}case"reply":{const{reply:e}=t;p=(0,r._)({},e&&m.editing?a.empty():m,{reply:e});break}case"addAttaches":case"removeAttach":case"removeVoice":case"startUploading":case"removeUploads":case"rearrangeAttaches":const e=(0,l.applyAttachmentActions)(m,t);p=(0,r._)({},m,e);break;default:(0,i.exhaustivenessCheck)(t)}break;case"UserClearedCommentsComposerDraft":break;default:(0,i.exhaustivenessCheck)(t)}!p.text&&!p.reply&&!p.editing&&0===p.uploadsTrackIds.size&&0===Object.keys(p.attaches).length?delete e.commentsComposerDrafts[u]:e.commentsComposerDrafts[u]=p;const f=(0,c.current)(e.commentsComposerDrafts);return[(0,n._)((function*({storage:e}){return e.set("comments-drafts",f),{type:"Noop"}}))]}},29064:(e,t,s)=>{"use strict";s.d(t,{applyAttachmentActions:()=>f,handler:()=>p});var n=s(11010),r=s(434788),a=s(400681),o=s(777634),i=s(197934),c=s(89131),l=s(453934),d=s(991792),u=s(481186),h=s(54965),m=s(851828);const p=(e,t)=>{const{peerId:s}=t;var i;const p=void 0!==s&&null!=(i=e.composerDrafts[s])?i:[];var C;const y=null!=(C=p[p.length-1])?C:(0,l.castDraft)(a.empty());let k=(0,l.castDraft)(p.slice(0,-1));switch(t.type){case"UserChangedComposerDraft":switch(t.kind){case"text":{const{text:e}=t;k.push((0,r._)({},y,{text:null!=e?e:y.text}));break}case"addAttaches":case"removeAttach":case"removeVoice":case"startUploading":case"removeUploads":case"rearrangeAttaches":const e=f(y,t);k.push((0,r._)({},y,e));break;case"editing":{const{editing:e}=t;k.push(y,{editing:e,text:o.toRawText(e),attaches:e.attaches,uploadsTrackIds:y.uploadsTrackIds,forward:e.forwardedMessages&&{kind:"message",items:e.forwardedMessages},reply:e.replyMessage});break}case"forward":{const{forward:e,isForwardAuthorHidden:s}=t;k.push((0,r._)({},e&&y.editing?a.empty():y,{reply:void 0,forward:e,isForwardAuthorHidden:null!=s?s:a.DEFAULT_FORWARD_AUTHOR_HIDDEN}));break}case"reply":{const{reply:e}=t;k.push((0,r._)({},e&&y.editing?a.empty():y,{forward:void 0,reply:e}));break}default:(0,c.exhaustivenessCheck)(t)}break;case"UserClearedComposerDraft":break;case"ComposerDraftsUpdateNeeded":{const{itemsToDelete:s,itemsToReplace:n,foreignKind:r}=t;k.push(y),k=k.reduce(((e,t)=>{const{editing:a,reply:o}=t;if("message"===r){if(void 0!==a&&g(s,a))return e;if(void 0===a&&void 0!==o)if(g(s,o))t.reply=void 0;else{const e=g(n,o);void 0!==e&&(t.reply=e)}}return e.push(t),e}),[]);const a=Object.values(e.composerDrafts).reduce(((e,t)=>(t.forEach((t=>e.push(t))),e)),[y]);a.forEach((e=>{const{forward:t,editing:a}=e;if(void 0===a&&void 0!==t){if("message"===r&&"message"===t.kind){const r=(0,c.toNonEmpty)([...t.items].reduce(((e,t)=>{const r=g(n,t);return void 0!==r?(e.push(r),e):(g(s,t)||e.push(t),e)}),[]));e.forward=null!==r?{kind:"message",items:r}:void 0}if("post"===r&&"post"===t.kind){const r=(0,c.toNonEmpty)([...t.items].reduce(((e,t)=>{const r=v(n,t);return void 0!==r?(e.push(r),e):(v(s,t)||e.push(t),e)}),[]));e.forward=null!==r?{kind:"post",items:r}:void 0}if("comment"===t.kind&&"comment"===r){const r=(0,c.toNonEmpty)([...t.items].reduce(((e,t)=>{const r=_(n,t);return void 0!==r?(e.push(r),e):(_(s,t)||e.push(t),e)}),[]));e.forward=null!==r?{kind:"comment",items:r}:void 0}}}));break}case"ActualizeComposerDraft":{const t=e.ownerId;return k.push(y),k.map((e=>{const r=(0,l.isDraft)(e)?(0,l.current)(e):e;return(0,n._)((function*({api:e}){var n,a;const{reply:o,forward:i,editing:l}=r,u=[...l?[l]:[],...o?[o]:[],..."message"===(null==(n=i)?void 0:n.kind)?i.items:[]].reduce(((e,t)=>("Foreign"!==t.kind&&"ForeignExpired"!==t.kind&&e.push(t),e)),[]);if(u.length>0&&u[0]){const s=u[0].peerId,n=u.reduce(((e,t)=>{if(t.peerId!==s){if(c.isDev)throw new Error("Перессылаемые сообщения не из одного чата");return e}return e.push(t.cmid),e}),[]);try{const r=yield e.fetch("messages.getByConversationMessageId",{peer_id:s,conversation_message_ids:n.join(","),extended:1,group_id:(0,d.getOwnerGroupId)(t)});return{type:"ActualizeComposerDraft_RequestCompleted",peerId:s,foreignKind:"message",foreignItems:u,response:r}}catch(e){}}if("post"===(null==(a=i)?void 0:a.kind)){const{channelId:t}=i.items[0],n=i.items.reduce(((e,s)=>{if(s.channelId!==t){if(c.isDev)throw new Error("Перессылаемые посты не из одного канала");return e}return e.push(s.cmid),e}),[]);try{const r=yield e.fetch("channels.getMessagesById",{channel_id:t,cmids:n.join(","),extended:1});return{type:"ActualizeComposerDraft_RequestCompleted",peerId:s,foreignKind:"post",foreignItems:i.items,response:r}}catch(e){}}return{type:"Noop"}}))}))}case"ActualizeComposerDraft_RequestCompleted":{const{response:r,foreignKind:a,foreignItems:o}=t;switch(a){case"message":{const{profiles:t,groups:a,contacts:i,items:c}=r;(0,d.insertPeers)(e,{apiUsers:t||[],apiGroups:a||[],apiContacts:i||[]});const l=c.reduce(((e,t)=>{if(t.deleted)return e;const s=(0,u.fromApiMessage)(t).message;return"Normal"===s.kind&&e.push(s),e}),[]),h=o.filter((e=>!g(l,e)));return h.length>0||l.length>0?[(0,n._)((function*(){return{type:"ComposerDraftsUpdateNeeded",foreignKind:"message",itemsToDelete:h,itemsToReplace:l,peerId:s}}))]:[]}case"post":{var I;const{profiles:t,groups:a,items:i}=r;var E;(0,d.insertPeers)(e,{apiUsers:t||[],apiGroups:a||[],apiContacts:[]});const c=null!=(E=null==(I=i)?void 0:I.map((e=>(0,h.fromApiPost)(e).post)))?E:[],l=o.filter((e=>!v(c,e)));return l.length>0||c.length>0?[(0,n._)((function*(){return{type:"ComposerDraftsUpdateNeeded",foreignKind:"post",itemsToDelete:l,itemsToReplace:c,peerId:s}}))]:[]}case"comment":{const t=r.reduce(((t,s)=>{const{profiles:n,groups:r,items:a}=s;return(0,d.insertPeers)(e,{apiUsers:n||[],apiGroups:r||[],apiContacts:[]}),a.forEach((e=>{const s=(0,m.fromApiComment)(e);"Normal"===s.kind&&t.push(s)})),t}),[]),a=o.filter((e=>!_(t,e)));return a.length>0||t.length>0?[(0,n._)((function*(){return{type:"ComposerDraftsUpdateNeeded",foreignKind:"comment",itemsToDelete:a,itemsToReplace:t,peerId:s}}))]:[]}default:return(0,c.exhaustivenessCheck)(a)}}default:(0,c.exhaustivenessCheck)(t)}void 0!==s&&(k=k.filter((e=>!(e=>!(e.text||e.forward||e.reply||e.editing||0!==Object.keys(e.attaches).length||0!==e.uploadsTrackIds.size))(e))),0===k.length?delete e.composerDrafts[s]:e.composerDrafts[s]=k);const b=(0,l.current)(e.composerDrafts);return[(0,n._)((function*({storage:e}){return e.set("drafts",b),{type:"Noop"}}))]};function f(e,t){switch(t.kind){case"addAttaches":{var s;const{attaches:n,trackIds:r}=t;let a=e.attaches;n&&(a=(0,l.produce)(a,(e=>{i.addAttach(e,n)})));let o=e.uploadsTrackIds;return(null==(s=r)?void 0:s.length)&&(o=(0,l.produce)(o,(e=>{r.forEach((t=>{e.delete(t)}))}))),{attaches:a,uploadsTrackIds:o}}case"removeAttach":{const{attach:s}=t;let n=e.attaches;return s&&(n=(0,l.produce)(n,(e=>{i.removeAttach(e,s)}))),{attaches:n}}case"removeVoice":return{attaches:(0,l.produce)(e.attaches,(e=>{e.voice&&delete e.voice}))};case"startUploading":{const{trackIds:s}=t;return{uploadsTrackIds:new Set([...e.uploadsTrackIds,...s])}}case"removeUploads":{const{trackIds:s}=t;return{uploadsTrackIds:(0,l.produce)(e.uploadsTrackIds,(e=>{s.forEach((t=>{e.delete(t)}))}))}}case"rearrangeAttaches":{const{key:s,currentPosition:n,newPosition:r}=t;let a=e.attaches;return-1!==r&&r!==n&&(a=(0,l.produce)(a,(e=>{i.rearrangeAttaches(e,{currentPosition:n,newPosition:r},s)}))),{attaches:a}}default:(0,c.exhaustivenessCheck)(t)}}function g(e=[],t){return e.find((e=>t.peerId===e.peerId&&t.cmid===e.cmid))}function v(e=[],t){return e.find((e=>t.channelId===e.channelId&&t.cmid===e.cmid))}function _(e=[],t){return e.find((e=>t.channelId===e.channelId&&t.postCmid===e.postCmid&&t.cmid===e.cmid))}},598801:(e,t,s)=>{"use strict";s.d(t,{handler:()=>p});var n=s(11010),r=s(434788),a=s(185327),o=s(96190),i=s(83062),c=s(777634),l=s(89131),d=s(453934),u=s(991792);const h={mute:"mute",unmute:"mute",mute_until:"mute_until",pin:"pin",unpin:"pin",mark_read:"mark_read",mark_unread:"mark_read",archive:"archive",unarchive:"archive",clear:"clear",leave:"leave",leave_and_clear:"leave_and_clear",show_pinned_message:"show_pinned_message",hide_pinned_message:"show_pinned_message",show_bot_keyboard:"show_bot_keyboard",hide_bot_keyboard:"hide_bot_keyboard",pin_message_for_all:"pin_message_for_all",unpin_message_for_all:"pin_message_for_all",ban:"ban",unban:"unban",return_to_chat:"return_to_chat",business_notify_enable:"business_notify_enable",business_notify_disable:"business_notify_enable",forbid_writing_all:"forbid_writing_all",allow_writing_all:"allow_writing_all",forbid_writing_all_until:"forbid_writing_all_until",finish_call:"finish_call",restrict_to_write:"restrict_to_write",allow_to_write:"allow_to_write"},m={pin:"unpin",unpin:"pin",mark_read:"mark_unread",mark_unread:"mark_read",archive:"unarchive",unarchive:"archive",show_pinned_message:"hide_pinned_message",hide_pinned_message:"show_pinned_message",show_bot_keyboard:"hide_bot_keyboard",hide_bot_keyboard:"show_bot_keyboard"},p=(e,t,s)=>{const{type:h}=t;switch(h){case"UserChangedConvo":{const{peerId:s,userAction:r}=t,{organisers:c}=e,d=e.viewer.id,h=f(t.userAction,s);if(e.locks.convoActions.has(h))return[];e.locks.convoActions.add(h);const m=e.convos.get(s),p=e.peers.get(s),g=e.ownerId;if(!m||!p)return[];let v;switch(r){case"pin":v=e=>e.fetch("messages.pinConversation",{peer_id:s});break;case"unpin":v=e=>e.fetch("messages.unpinConversation",{peer_id:s});break;case"mark_read":m.isMarkedUnread=!1,v=e=>e.fetch("messages.markAsRead",{peer_id:s,mark_conversation_as_read:1,group_id:(0,u.getOwnerGroupId)(g)});break;case"mark_unread":m.isMarkedUnread=!0,v=e=>e.fetch("messages.markAsUnreadConversation",{peer_id:s,group_id:0});break;case"archive":case"unarchive":m.isArchived="archive"===r,i.refresh(c,m),v=e=>e.fetch("archive"===r?"messages.archiveConversation":"messages.unarchiveConversation",{peer_id:s});break;case"hide_pinned_message":"ChatConvo"===m.kind&&m.pinnedMessage&&e.hiddenPinnedMessages.set(t.peerId,m.pinnedMessage.cmid);break;case"show_pinned_message":e.hiddenPinnedMessages.delete(t.peerId);break;case"hide_bot_keyboard":e.hiddenBotKeyboards.add(t.peerId);break;case"show_bot_keyboard":e.hiddenBotKeyboards.delete(t.peerId);break;case"clear":v=e=>e.fetch("messages.deleteConversation",{peer_id:s,group_id:(0,u.getOwnerGroupId)(g)}).then((({last_deleted_id:e})=>Boolean(e)));break;case"leave":case"leave_and_clear":{if("ChatConvo"!==m.kind)break;v=e=>e.fetch("messages.removeChatUser",{chat_id:o.toRealId(s),user_id:o.toRealId(d),group_id:(0,u.getOwnerGroupId)(g)});const t=e.peers.get(s);if(!t||"Chat"!==t.kind)break;a.clearChatDataOnLeave(m),o.clearChatDataOnLeave(t);break}case"ban":if(!("User"===p.kind&&"UserConvo"===m.kind||"Group"===p.kind&&"GroupConvo"===m.kind))break;o.updateIsPeerBlacklistedByMe(p,!0),"UserConvo"===m.kind&&a.restrictWrite(m,"peer_blacklisted_by_me"),v=o.isGroupPeerId(g)?e=>e.fetch("groups.ban",{owner_id:s,group_id:(0,u.getOwnerGroupId)(g)}):o.isGroupPeerId(s)?e=>e.fetch("messages.denyMessagesFromGroup",{group_id:o.toRealId(s)}):e=>e.fetch("account.ban",{owner_id:s});break;case"unban":if(!("User"===p.kind&&"UserConvo"===m.kind||"Group"===p.kind&&"GroupConvo"===m.kind))break;o.updateIsPeerBlacklistedByMe(p,!1),"UserConvo"===m.kind&&a.allowWrite(m),v=o.isGroupPeerId(g)?e=>e.fetch("groups.unban",{owner_id:s,group_id:(0,u.getOwnerGroupId)(g)}):o.isGroupPeerId(s)?e=>e.fetch("messages.allowMessagesFromGroup",{group_id:o.toRealId(s)}):e=>e.fetch("account.unban",{owner_id:s});break;case"return_to_chat":v=e=>e.fetch("messages.addChatUser",{chat_id:o.toRealId(s),user_id:o.toRealId(d)}).then((({result:e})=>Boolean(e)));break;case"finish_call":if(a.canFinishCall(m)){const e=m.activeCall.id;v=t=>t.fetch("messages.forceCallFinish",{call_id:e})}break;default:(0,l.exhaustivenessCheck)(r)}return[(E=(0,n._)((function*({api:e}){try{let t=!1;return v&&(t=!(yield v(e))),{type:"UserChangedConvo_RequestCompleted",hasFailed:t,userAction:r,peerId:s}}catch(e){return{type:"UserChangedConvo_RequestCompleted",hasFailed:!0,userAction:r,peerId:s}}})),function(e){return E.apply(this,arguments)})]}case"UserChangedConvo_RequestCompleted":{const{peerId:r,userAction:o,hasFailed:i}=t,d=f(o,r);e.locks.convoActions.delete(d);const u=m[o];if(i&&u)return p(e,{type:"UserChangedConvo",userAction:u,peerId:r},s),[];if(i)return[];switch(o){case"clear":case"pin":case"unpin":case"mark_read":case"mark_unread":case"unarchive":case"show_pinned_message":case"hide_pinned_message":case"show_bot_keyboard":case"hide_bot_keyboard":case"ban":case"unban":case"finish_call":return[];case"archive":{const t=e.convos.get(r);if(!t||"ChatConvo"!==t.kind||!t.unreadMentions.size)return[];const s=c.resolveCmid(Math.max(...t.unreadMentions));return[(I=(0,n._)((function*({storage:e}){const t=e.get("archive-mentions-map");return t&&s?(t[r]=s,e.set("archive-mentions-map",t),{type:"Noop"}):{type:"Noop"}})),function(e){return I.apply(this,arguments)})]}case"leave":{var g;const t=e.convos.get(r);return"ChatConvo"===(null==(g=t)?void 0:g.kind)&&a.setConvoState(t,"left"),[]}case"leave_and_clear":{var v;const t=e.convos.get(r);return"ChatConvo"!==(null==(v=t)?void 0:v.kind)?[]:(a.setConvoState(t,"left"),p(e,{type:"UserChangedConvo",userAction:"clear",peerId:r},s))}case"return_to_chat":{var _;const t=e.convos.get(r);return"ChatConvo"===(null==(_=t)?void 0:_.kind)&&a.setConvoState(t,"in"),[]}default:return(0,l.exhaustivenessCheck)(t)}}case"UserChangedMute":{const{peerId:s,timer:r,userAction:a}=t,o=f(t.userAction,s);if(e.locks.convoActions.has(o))return[];const i=e.convos.get(s);if(!i)return[];let c;switch(a){case"mute":i.push={mode:"every-mention",disabledUntil:1/0},c=-1;break;case"unmute":i.push={mode:"everything",disabledUntil:0},c=0;break;case"mute_until":i.push={mode:"every-mention",disabledUntil:Date.now()+1e3*r},c=r;break;default:(0,l.exhaustivenessCheck)(a)}return[function(){var e=(0,n._)((function*({api:e}){try{return{type:"UserChangedMute_RequestCompleted",hasFailed:1!==(yield e.fetch("account.setSilenceMode",{time:c,peer_id:s,sound:"unmute"===a?1:0})),userAction:a,peerId:s}}catch(e){return{type:"UserChangedMute_RequestCompleted",hasFailed:!0,userAction:a,peerId:s}}}));return function(t){return e.apply(this,arguments)}}()]}case"UserChangedMute_RequestCompleted":{const{peerId:n,userAction:r,hasFailed:a}=t,o=f(r,n);e.locks.convoActions.delete(o);const i={mute:"unmute",unmute:"mute",mute_until:"unmute"}[r];return a&&i?(p(e,{type:"UserChangedMute",userAction:i,peerId:n,timer:0},s),[]):[]}case"UserPinMessage":{var C;const{peerId:s,cmid:r,userAction:o}=t,i=f(t.userAction,s);if(e.locks.convoActions.has(i))return[];e.locks.convoActions.add(i);const l=e.convos.get(s),h=e.ownerId;if(!l||"ChatConvo"!==l.kind)return[];const m=l.pinnedMessage&&(0,d.current)(l.pinnedMessage),p=a.findMessageByCmid(l,r);return"Normal"===(null==(C=p)?void 0:C.kind)&&a.pinMessage(l,c.toPinned(p)),[function(){var e=(0,n._)((function*({api:e}){try{return yield e.fetch("messages.pin",{peer_id:s,cmid:r,group_id:(0,u.getOwnerGroupId)(h)}),{type:"UserPinMessage_RequestCompleted",hasFailed:!1,userAction:o,peerId:s,cmid:r}}catch(e){return{type:"UserPinMessage_RequestCompleted",hasFailed:!0,userAction:o,pinnedMessage:m,peerId:s,cmid:r}}}));return function(t){return e.apply(this,arguments)}}()]}case"UserPinMessage_RequestCompleted":{const{peerId:s,hasFailed:n,pinnedMessage:r,userAction:o}=t,i=f(o,s);e.locks.convoActions.delete(i);const c=e.convos.get(s);return c&&"ChatConvo"===c.kind?(n&&(a.unpinMessage(c),r&&a.pinMessage(c,r)),[]):[]}case"UserUnpinMessage":{const{peerId:s,userAction:r}=t,o=f(t.userAction,s);if(e.locks.convoActions.has(o))return[];const i=e.convos.get(s),c=e.ownerId;if(!i||"ChatConvo"!==i.kind)return[];const l=(0,d.current)(a.unpinMessage(i));return[function(){var e=(0,n._)((function*({api:e}){try{return yield e.fetch("messages.unpin",{peer_id:s,group_id:(0,u.getOwnerGroupId)(c)}),{type:"UserUnpinMessage_RequestCompleted",hasFailed:!1,userAction:r,peerId:s}}catch(e){return{type:"UserUnpinMessage_RequestCompleted",hasFailed:!0,userAction:r,prevPinnedMessage:l,peerId:s}}}));return function(t){return e.apply(this,arguments)}}()]}case"UserUnpinMessage_RequestCompleted":{const{peerId:s,hasFailed:n,prevPinnedMessage:r,userAction:o}=t,i=f(o,s);e.locks.convoActions.delete(i);const c=e.convos.get(s);return c&&"ChatConvo"===c.kind?(n&&r&&a.pinMessage(c,r),[]):[]}case"UserChangedBusinessNotify":{var y;const{userAction:s,peerId:r}=t,a=f(t.userAction,r);if(e.locks.convoActions.has(a))return[];const i=e.peers.get(r);return"Group"!==(null==(y=i)?void 0:y.kind)||i.isBlacklistedByMe&&"business_notify_disable"===s||!i.isBlacklistedByMe&&"business_notify_enable"===s?[]:(o.updateIsPeerBlacklistedByMe(i,"business_notify_disable"===s),[function(){var e=(0,n._)((function*({api:e}){try{return{type:"UserChangedBusinessNotify_RequestCompleted",hasFailed:1!==(yield e.fetch("business_notify_disable"===s?"messages.denyMessagesFromGroup":"messages.allowMessagesFromGroup",{group_id:o.toRealId(r)})),userAction:s,peerId:r}}catch(e){return{type:"UserChangedBusinessNotify_RequestCompleted",hasFailed:!0,userAction:s,peerId:r}}}));return function(t){return e.apply(this,arguments)}}()])}case"UserChangedBusinessNotify_RequestCompleted":{var k;const{userAction:s,peerId:n,hasFailed:r}=t,a=f(s,n);e.locks.convoActions.delete(a);const i=e.peers.get(n);return"Group"!==(null==(k=i)?void 0:k.kind)||r&&o.updateIsPeerBlacklistedByMe(i,!i.isBlacklistedByMe),[]}case"UserRestrictChatMemberToWrite":{const{userAction:s,chatId:o,memberId:i,duration:c}=t,d=e.convos.get(o);if(!d||"ChatConvo"!==d.kind)return[];const u=f(t.userAction,o);if(e.locks.convoActions.has(u))return[];switch(e.locks.convoActions.add(u),s){case"restrict_to_write":a.restrictMemberToWrite(d,i);break;case"allow_to_write":a.allowMemberToWrite(d,i);break;default:(0,l.exhaustivenessCheck)(s)}const h=d.peerId;return[(0,n._)((function*({api:e}){try{var t;const n=yield e.fetch("messages.changeConversationMemberRestrictions",(0,r._)({peer_id:h,member_ids:[i]},"restrict_to_write"===s?{for:c,action:"ro"}:{action:"rw"}));return{type:"UserRestrictChatMemberToWrite_RequestCompleted",hasFailed:0!==(null==(t=n.failed_member_ids)?void 0:t.length),chatId:o,failedIds:n.failed_member_ids,userAction:s}}catch(e){return{type:"UserRestrictChatMemberToWrite_RequestCompleted",chatId:o,hasFailed:!0,failedIds:[],userAction:s}}}))]}case"UserRestrictChatMemberToWrite_RequestCompleted":{const{hasFailed:s,userAction:n,failedIds:r,chatId:i}=t,c=f(n,i);e.locks.convoActions.delete(c);const d=e.convos.get(i);if(!d||"ChatConvo"!==d.kind)return[];if(s&&r.length)switch(n){case"restrict_to_write":r.forEach((e=>{a.allowMemberToWrite(d,o.resolveId(e))}));break;case"allow_to_write":r.forEach((e=>{a.restrictMemberToWrite(d,o.resolveId(e))}));break;default:(0,l.exhaustivenessCheck)(n)}return[]}case"UserChangeForbidWritingAll":{const{peerId:s,duration:r,userAction:a}=t,i=f(t.userAction,s);if(e.locks.convoActions.has(i))return[];const c=e.convos.get(s);if(!c||"ChatConvo"!==c.kind)return[];switch(a){case"forbid_writing_all":c.forbidedWritingForAll={value:!0};break;case"allow_writing_all":c.forbidedWritingForAll=void 0;break;case"forbid_writing_all_until":c.forbidedWritingForAll={value:!0,until:Date.now()+1e3*r};break;default:(0,l.exhaustivenessCheck)(a)}const d=o.toRealId(s),h=e.ownerId;return[function(){var e=(0,n._)((function*({api:e}){try{return{type:"UserChangeForbidWritingAll_RequestCompleted",hasFailed:1!==(yield e.fetch("messages.editChat",{chat_id:d,group_id:(0,u.getOwnerGroupId)(h),is_disable_writing:"allow_writing_all"===a?0:1})),userAction:a,peerId:s}}catch(e){return{type:"UserChangeForbidWritingAll_RequestCompleted",hasFailed:!0,userAction:a,peerId:s}}}));return function(t){return e.apply(this,arguments)}}()]}case"UserChangeForbidWritingAll_RequestCompleted":{const{peerId:n,userAction:r,hasFailed:a}=t,o=f(r,n);e.locks.convoActions.delete(o);const i={forbid_writing_all:"allow_writing_all",allow_writing_all:"forbid_writing_all",forbid_writing_all_until:"allow_writing_all"}[r];return a&&i?(p(e,{type:"UserChangeForbidWritingAll",userAction:i,peerId:n,duration:1/0},s),[]):[]}default:(0,l.exhaustivenessCheck)(t)}var I,E},f=(e,t)=>`${h[e]}-${t.toString()}`},708807:(e,t,s)=>{"use strict";s.d(t,{handler:()=>o});var n=s(11010),r=s(96190),a=s(89131);const o=(e,t)=>{switch(t.type){case"UserChangedFriendship":{var s;const a=e.peers.get(t.userId);if("User"!==(null==(s=a)?void 0:s.kind)||e.locks.updateFriendshipOrMembership.has(a.id))return[];const o=a.friendship;return r.updateFriendship(a,t.change),o===a.friendship?[]:(e.locks.updateFriendshipOrMembership.add(a.id),[(i=(0,n._)((function*({api:e}){let s=!1;try{yield e.fetch(`friends.${t.change}`,{user_id:r.toRealId(t.userId)})}catch(e){s=!0}return{type:"UserChangedFriendship_RequestCompleted",userId:t.userId,change:t.change,hasFailed:s}})),function(e){return i.apply(this,arguments)})])}case"UserChangedFriendship_RequestCompleted":{var o;e.locks.updateFriendshipOrMembership.delete(t.userId);const s=e.peers.get(t.userId);return"User"!==(null==(o=s)?void 0:o.kind)||t.hasFailed&&r.updateFriendship(s,{add:"delete",delete:"add"}[t.change]),[]}default:return(0,a.exhaustivenessCheck)(t)}var i}},959630:(e,t,s)=>{"use strict";s.d(t,{handler:()=>o});var n=s(11010),r=s(96190),a=s(89131);const o=(e,t)=>{switch(t.type){case"UserChangedGroupMembership":{var s;const a=e.peers.get(t.groupId);if("Group"!==(null==(s=a)?void 0:s.kind)||e.locks.updateFriendshipOrMembership.has(a.id))return[];const o=a.membership;return r.updateMembership(a,t.change),o===a.membership?[]:(e.locks.updateFriendshipOrMembership.add(a.id),[(i=(0,n._)((function*({api:e}){const s=`groups.${t.change}`;let n=!1;try{yield e.fetch(s,{group_id:-t.groupId})}catch(e){n=!0}return{type:"UserChangedGroupMembership_RequestCompleted",groupId:t.groupId,change:t.change,hasFailed:n}})),function(e){return i.apply(this,arguments)})])}case"UserChangedGroupMembership_RequestCompleted":{var o;e.locks.updateFriendshipOrMembership.delete(t.groupId);const s=e.peers.get(t.groupId);return"Group"!==(null==(o=s)?void 0:o.kind)||t.hasFailed&&r.updateMembership(s,{join:"leave",leave:"join"}[t.change]),[]}default:return(0,a.exhaustivenessCheck)(t)}var i}},115804:(e,t,s)=>{"use strict";s.d(t,{handler:()=>m});var n=s(11010),r=s(777634),a=s(185327),o=s(168465),i=s(89131),c=s(61448),l=s(991792),d=s(453934);const u={mark_important:"unmark_important",unmark_important:"mark_important"},h={delete:"delete",restore:"restore",mark_important:"mark_important",unmark_important:"mark_important"},m=(e,t,s)=>{const{type:h}=t;switch(h){case"UserChangedMessage":{const{peerId:s,userAction:r,cmids:o}=t;for(let t=0;t<o.length;t+=1){const n=o[t];if(!n)return[];const a=p(r,s,n);if(e.locks.messageActions.has(a))return[];e.locks.messageActions.add(a)}const l=e.convos.get(s);let u;switch(r){case"mark_important":case"unmark_important":o.forEach((t=>{if(l){var n;const e=(0,d.castDraft)(a.findMessageByCmid(l,t));"Normal"===(null==(n=e)?void 0:n.kind)&&(e.isImportant="mark_important"===r)}const o=e.importantMessages.messages.get((0,c.getImportantMessageKey)(s,t));o&&(o.isImportant="mark_important"===r)})),u=e=>e.fetch("messages.markAsImportant",{peer_id:s,cmids:o.join(","),important:"mark_important"===r?1:0}).then((e=>Boolean(e.marked.length)));break;default:(0,i.exhaustivenessCheck)(r)}return[(v=(0,n._)((function*({api:e}){try{let t=!1;return u&&(t=!(yield u(e))),{type:"UserChangedMessage_RequestCompleted",hasFailed:t,userAction:r,cmids:o,peerId:s}}catch(e){return{type:"UserChangedMessage_RequestCompleted",hasFailed:!0,userAction:r,cmids:o,peerId:s}}})),function(e){return v.apply(this,arguments)})]}case"UserChangedMessage_RequestCompleted":{const{peerId:n,userAction:r,hasFailed:a,cmids:o}=t;o.forEach((t=>{const s=p(r,n,t);e.locks.messageActions.delete(s)}));const i=u[r];return a&&i&&m(e,{type:"UserChangedMessage",userAction:i,peerId:n,cmids:o},s),[]}case"UserDeleteMessage":{const{deleteType:s,peerId:o,userAction:c,messages:d}=t,u=e.ownerId,h=e.convos.get(o);if(!h)return[];const m=[];for(let t=0;t<d.length;t+=1){const n=d[t];if(!n||"Normal"!==n.kind)return[];const l=p(c,o,n.cmid);if(e.locks.messageActions.has(l))return[];e.locks.messageActions.add(l),m.push(n);const u=a.isCasper(h)||r.isCall(n);switch(s){case"local":case"spam":if(u){a.deleteMessage(h,n,{isRestorable:!1});break}a.deleteMessage(h,n,{isRestorable:!0,isSpam:"spam"===s});break;case"for_all":a.deleteMessage(h,n,{isRestorable:!1});break;default:(0,i.exhaustivenessCheck)(s)}}return[function(){var e=(0,n._)((function*({api:e}){try{var t;const n=yield e.fetch("messages.delete",{peer_id:o,cmids:d.map((e=>e.cmid)).join(","),delete_for_all:"for_all"===s?1:0,spam:"spam"===s?1:0,group_id:(0,l.getOwnerGroupId)(u)});return{type:"UserDeleteMessage_RequestCompleted",hasFailed:!Boolean(null==(t=n[0])?void 0:t.response),userAction:c,deleteType:s,peerId:o,messages:d,deletedMessages:m}}catch(e){return{type:"UserDeleteMessage_RequestCompleted",hasFailed:!0,userAction:c,deleteType:s,peerId:o,messages:d,deletedMessages:m}}}));return function(t){return e.apply(this,arguments)}}()]}case"UserDeleteFailedMessage":{const{peerId:s,randomId:n}=t,r=e.convos.get(s);return r?(a.removePending(r,n),[]):[]}case"UserDeleteAllFailedMessage":{const{peerId:s}=t,n=e.convos.get(s);if(!n)return[];return a.allQueuedMessages(n).filter((e=>e.hasFailed)).forEach((e=>{a.removePending(n,e.randomId)})),[]}case"UserDeleteMessage_RequestCompleted":{const{peerId:s,userAction:r,messages:o,hasFailed:i,deletedMessages:c}=t,l=e.convos.get(s);return i&&l&&c.forEach((e=>{a.restoreMessage(l,e,!1)})),o.forEach((({cmid:t})=>{const n=p(r,s,t);e.locks.messageActions.delete(n)})),[(0,n._)((function*(){return{type:"Noop"}}))]}case"UserRestoreMessage":{var f;const{peerId:s,userAction:r,cmid:i}=t,c=p(r,s,i);if(e.locks.messageActions.has(c))return[];e.locks.messageActions.add(c);const d=e.convos.get(s);if(!d)return[];const u=e.ownerId,h=o.findNodeByCmid(d.history,i).node;return"DeletedNode"===(null==(f=h)?void 0:f.kind)&&a.restoreMessage(d,h.restorable,!1),[function(){var e=(0,n._)((function*({api:e}){try{const t=yield e.fetch("messages.restore",{peer_id:s,cmid:i,group_id:(0,l.getOwnerGroupId)(u)});return{type:"UserRestoreMessage_RequestCompleted",hasFailed:!Boolean(t),userAction:r,peerId:s,cmid:i}}catch(e){return{type:"UserRestoreMessage_RequestCompleted",hasFailed:!0,userAction:r,peerId:s,cmid:i}}}));return function(t){return e.apply(this,arguments)}}()]}case"UserRestoreMessage_RequestCompleted":{var g;const{peerId:n,userAction:r,cmid:o,hasFailed:i}=t,c=p(r,n,o);e.locks.messageActions.delete(c);const l=e.convos.get(n);if(void 0===l)return[];const d=a.findMessageByCmid(l,o);return i&&"Normal"===(null==(g=d)?void 0:g.kind)&&m(e,{type:"UserDeleteMessage",messages:[d],deleteType:"local",peerId:n,userAction:"delete"},s),[]}default:(0,i.exhaustivenessCheck)(t)}var v},p=(e,t,s)=>`${h[e]}-${t.toString()}-${s.toString()}`},623267:(e,t,s)=>{"use strict";s.d(t,{handler:()=>i});var n=s(11010),r=s(481186),a=s(89131),o=s(185327);const i=(e,t)=>{switch(t.type){case"UserChangedMessageAttachment":return[(0,n._)((function*({api:e}){try{const s=(yield e.fetch("messages.getByConversationMessageId",{peer_id:t.peerId,conversation_message_ids:t.cmid.toString(),extended:1,group_id:t.groupId||0},{retries:3})).items[0];return s?{type:"UserChangedMessageAttachment_RequestCompleted",hasFailed:!1,peerId:t.peerId,apiMessage:s}:{type:"UserChangedMessageAttachment_RequestCompleted",hasFailed:!0}}catch(e){return{type:"UserChangedMessageAttachment_RequestCompleted",hasFailed:!0}}}))];case"UserChangedMessageAttachment_RequestCompleted":{if(t.hasFailed)return[];const{message:s,mentions:n}=(0,r.fromApiMessage)(t.apiMessage),a=e.convos.get(t.peerId);return a?(o.replaceMessage(a,s,n.hasDirect||n.hasMass),[]):[]}default:(0,a.exhaustivenessCheck)(t)}}},395911:(e,t,s)=>{"use strict";s.d(t,{handler:()=>l});var n=s(11010),r=s(89131),a=s(96190),o=s(185327),i=s(83062),c=s(453934);const l=(e,t)=>{const{type:s}=t,{viewer:l}=e,d=l.id;switch(s){case"UserAcceptedChatMessageRequest":{const{peerId:s}=t;return e.locks.changeMessageRequest.has(s)?[]:(e.locks.changeMessageRequest.add(s),[(0,n._)((function*({api:e}){try{return yield e.fetch("messages.acceptMessageRequest",{peer_id:s,user_id:a.toRealId(d)}),{type:"UserAcceptedChatMessageRequest_RequestCompleted",peerId:s}}catch(e){return{type:"UserAcceptedChatMessageRequest_RequestCompleted",peerId:s}}}))])}case"UserRejectedMessageRequest":{const{peerId:s,isSpam:r}=t;if(e.locks.changeMessageRequest.has(s))return[];e.locks.changeMessageRequest.add(s);const l=e.convos.get(s),u=(0,c.current)(l);if(void 0!==l&&("MessageRequestChatConvo"===l.kind||"MessageRequestUserConvo"===l.kind||"UserConvo"===l.kind)){const t=o.fromRejectedMessageRequest(l);e.convos.set(s,t),i.refresh(e.organisers,t)}return[(0,n._)((function*({api:e}){try{return{type:"UserRejectedChatMessageRequest_RequestCompleted",hasFailed:1!==(yield e.fetch("messages.rejectMessageRequest",{peer_id:s,user_id:a.toRealId(d),spam:r?1:0})),peerId:s,prevConvo:u}}catch(e){return{type:"UserRejectedChatMessageRequest_RequestCompleted",hasFailed:!0,peerId:s,prevConvo:u}}}))]}case"UserAcceptedChatMessageRequest_RequestCompleted":{const{peerId:s}=t;return e.locks.changeMessageRequest.delete(s),[]}case"UserRejectedChatMessageRequest_RequestCompleted":{const{prevConvo:s,hasFailed:n,peerId:r}=t;return e.locks.changeMessageRequest.delete(r),n&&void 0!==s&&(e.convos.set(r,s),i.refresh(e.organisers,s)),[]}default:(0,r.exhaustivenessCheck)(s)}}},573610:(e,t,s)=>{"use strict";s.d(t,{handler:()=>c});var n=s(11010),r=s(89131),a=s(839963),o=s(86144),i=s(54965);const c=(e,t)=>{switch(t.type){case"UserChangedPostAttachment":{const{channelId:e,cmid:s}=t;return[(c=(0,n._)((function*({api:t}){try{var n;const r=null==(n=(yield t.fetch("channels.getMessagesById",{channel_id:e,cmids:s.toString(),extended:1},{retries:3})).items)?void 0:n[0];return r?{type:"UserChangedPostAttachment_RequestCompleted",hasFailed:!1,channelId:e,apiPost:r}:{type:"UserChangedPostAttachment_RequestCompleted",hasFailed:!0}}catch(e){return{type:"UserChangedPostAttachment_RequestCompleted",hasFailed:!0}}})),function(e){return c.apply(this,arguments)})]}case"UserChangedPostAttachment_RequestCompleted":{var s;if(t.hasFailed)return[];const{apiPost:n,channelId:r}=t,c=e.channels.get(r);if(!c)return[];if("ChannelRestricted"===c.kind)return[];const{post:l,reactions:d}=(0,i.fromApiPost)(n),u=a.findPostByCmid(c,l.cmid),h=o.merge(l,"Node"===(null==(s=u)?void 0:s.kind)?u.item:void 0);for(const t of d)e.reactions.set(t.id,t);return a.replacePost(c,h),[]}default:(0,r.exhaustivenessCheck)(t)}var c}},446869:(e,t,s)=>{"use strict";s.d(t,{handler:()=>o});var n=s(11010),r=s(89131),a=s(453934);const o=(e,t)=>{switch(t.type){case"UserChangedPushSetting":{const{setting:r,value:o}=t;e.viewer.settings.push[r]=o;const i=(0,a.current)(e.viewer.settings.push);return[(s=(0,n._)((function*({storage:e}){return e.set("settings-push",i),{type:"UserChangedPushSetting_RequestCompleted",hasFailed:!1,setting:r,value:o}})),function(e){return s.apply(this,arguments)})]}case"UserChangedPushSetting_RequestCompleted":return t.hasFailed,[];default:(0,r.exhaustivenessCheck)(t)}var s}},490469:(e,t,s)=>{"use strict";s.d(t,{handler:()=>i});var n=s(11010),r=s(89131),a=s(927411),o=s(709646);const i=(e,t)=>{const{type:s}=t;switch(s){case"UserChangedSetting":{const s=t.setting;e.locks.settings.add(s);const o=e.viewer.settings[t.setting];return e.viewer.settings[t.setting]=t.value,[(c=(0,n._)((function*(e){try{const s=yield function(e,t,s){const{api:n,storage:o}=e;switch(t){case"ctrSubmit":{const e=a.IApi.resolveTrackId("account.setInfo","messages_multiline_input");return n.dangerouslyAbort(e),n.fetch("account.setInfo",{name:"messages_multiline_input",value:String(Number(s))},{trackId:e})}case"soundNotifications":return o.set("settings-sound-notifications-on",s),Promise.resolve(1);case"eduAccountSwitchBanner":return o.set("settings-edu-account-switch-banner-on",s),Promise.resolve(1);case"showRecommendations":{const e=a.IApi.resolveTrackId("account.setInfo","messages_recommendation_list_hidden");return n.dangerouslyAbort(e),n.fetch("account.setInfo",{name:"messages_recommendation_list_hidden",value:String(Number(!s))},{trackId:e})}case"countOnlyNotMuted":{const e=a.IApi.resolveTrackId("account.setInfo","show_only_not_muted_messages");return n.dangerouslyAbort(e),n.fetch("account.setInfo",{name:"show_only_not_muted_messages",value:String(Number(s))},{trackId:e})}case"autoUnarchive":{const e=a.IApi.resolveTrackId("account.setInfo","messages_auto_unarchive");return n.dangerouslyAbort(e),n.fetch("account.setInfo",{name:"messages_auto_unarchive",value:String(Number(s))},{trackId:e})}case"transcriptAutoShow":{const e=a.IApi.resolveTrackId("account.setInfo","messages_transcript_auto_show");return n.dangerouslyAbort(e),n.fetch("account.setInfo",{name:"messages_transcript_auto_show",value:String(Number(s))},{trackId:e})}case"verticalFoldersView":return o.set("folders-view-vertical",s),Promise.resolve(1);case"messageReactionAnimation":return o.set("message-reactions-animation",s),Promise.resolve(1);case"rightClickActionsEnabled":return o.set("settings-right-click-actions-enabled",s),Promise.resolve(1);case"autoExtendReactionPicker":return o.set("settings-auto-extend-reaction-picker",s),Promise.resolve(1);default:(0,r.exhaustivenessCheck)(t)}}(e,t.setting,t.value);return"transcriptAutoShow"===t.setting&&1===s&&e.stats.logEvent({type:"type_action",type_action:{type:"type_settings_changes_item",type_settings_changes_item:{type:"general",name:"voice_transcription_autoshow",value_old:String(Number(o)),value_new:String(Number(t.value)),screen:"im_web_settings"}}}),{type:"UserChangedSetting_RequestCompleted",hasFailed:1!==s,setting:t.setting,value:t.value,previousValue:o}}catch(e){return{type:"UserChangedSetting_RequestCompleted",hasFailed:!0,setting:t.setting,value:t.value,previousValue:o}}})),function(e){return c.apply(this,arguments)})]}case"UserChangedSetting_RequestCompleted":{const s=t.setting;if(e.locks.settings.delete(s),t.hasFailed)e.viewer.settings[t.setting]=t.previousValue;else if("eduAccountSwitchBanner"===t.setting){const s=e.viewer,r=o.isEdu(s.profileType);return[(i=(0,n._)((function*(e){return e.stats.logEvent({type:"general",name:r?"go_to_messenger_banner":"go_to_sferum_banner",value_new:t.value?"enable":"disable",value_old:t.value?"disable":"enable"}),{type:"Noop"}})),function(e){return i.apply(this,arguments)})]}return[]}default:(0,r.exhaustivenessCheck)(s)}var i,c}},694598:(e,t,s)=>{"use strict";s.d(t,{handler:()=>l});var n=s(11010),r=s(999504),a=s(89131),o=s(991792),i=s(927411),c=s(171949);const l=(e,t)=>{switch(t.type){case"UserCreatedFolder":{const{name:a,peerIds:o,folderType:c}=t;return e.locks.newFolder?[]:(e.locks.newFolder=!0,[(s=(0,n._)((function*({api:e}){try{const t=yield e.fetch("messages.createFolder",{name:a,type:c,included_peer_ids:o.join(",")});return{type:"UserCreatedFolder_CreateRequestCompleted",hasFailed:!1,peerIds:o,name:a,folderType:c,folderId:r.resolveId(t.folder_id)}}catch(e){let t;return e instanceof i.IApi.RequestError&&(t=e.code),{type:"UserCreatedFolder_CreateRequestCompleted",hasFailed:!0,name:a,error:t}}})),function(e){return s.apply(this,arguments)})])}case"UserCreatedFolder_CreateRequestCompleted":{const{hasFailed:s}=t;if(e.locks.newFolder=!1,s){if(t.error);else if(a.isDev)throw new Error("Не удалось создать папку");return[]}const n=(0,o.insertFolders)(e,[(0,c.fromApiFolder)({id:t.folderId,name:t.name,type:t.folderType,flags:0})]),i=(0,o.getConvosByIds)(e,t.peerIds);return(0,o.addConvosToFolder)(e,t.folderId,i),n[0]&&"default"===t.folderType&&r.setHasMore(n[0],"all",!1),[]}default:(0,a.exhaustivenessCheck)(t)}var s}},351447:(e,t,s)=>{"use strict";s.d(t,{handler:()=>i});var n=s(11010),r=s(999504),a=s(185327),o=s(89131);const i=(e,t)=>{switch(t.type){case"UserDeletedFolder":{const{folderId:o}=t;if(e.locks.deleteFolder.has(o))return[];e.locks.deleteFolder.add(o),r.deleteFolder(e.organisers.folders,o);for(const t of e.convos.values())a.removeFolder(t,o);return[(s=(0,n._)((function*({api:e}){try{return{type:"UserDeletedFolder_DeleteRequestCompleted",hasFailed:1!==(yield e.fetch("messages.deleteFolder",{folder_id:o})),folderId:o}}catch(e){return{type:"UserDeletedFolder_DeleteRequestCompleted",hasFailed:!0,folderId:o}}})),function(e){return s.apply(this,arguments)})]}case"UserDeletedFolder_DeleteRequestCompleted":{const{hasFailed:s,folderId:n}=t;if(e.locks.deleteFolder.delete(n),s&&o.isDev)throw new Error("Не удалось удалить папку");return[]}default:(0,o.exhaustivenessCheck)(t)}var s}},791175:(e,t,s)=>{"use strict";s.d(t,{handler:()=>o});var n=s(11010),r=s(498928),a=s(89131);const o=(e,t)=>{switch(t.type){case"UserHideFilter":return"businessNotify"===t.kind?e.organisers.filters.businessNotify.unreadCount>0?[]:[(s=(0,n._)((function*({storage:e}){return e.set("business-notify-manually-hidden",!0),{type:"UserHideFilter_Completed",kind:"businessNotify"}})),function(e){return s.apply(this,arguments)})]:"all"===t.kind||"unread"===t.kind||"chats"===t.kind||"messageRequest"===t.kind||"archive"===t.kind?[]:(0,a.exhaustivenessCheck)(t.kind);case"UserHideFilter_Completed":return"businessNotify"===t.kind?(r.toggleBusinessNotifyVisibility(e.organisers.filters,!1),[]):"all"===t.kind||"unread"===t.kind||"chats"===t.kind||"messageRequest"===t.kind||"archive"===t.kind?[]:(0,a.exhaustivenessCheck)(t.kind);case"UserUndoHideFilter":return"businessNotify"===t.kind?(r.toggleBusinessNotifyVisibility(e.organisers.filters,!0),[(0,n._)((function*({storage:e}){return e.set("business-notify-manually-hidden",!1),{type:"Noop"}}))]):"all"===t.kind||"unread"===t.kind||"chats"===t.kind||"messageRequest"===t.kind||"archive"===t.kind?[]:(0,a.exhaustivenessCheck)(t.kind);case"UserActualizeHideFilter":if("businessNotify"===t.kind){const t=e.organisers.filters.businessNotify.unreadCount,{isHidden:s}=e.organisers.filters.businessNotify;return[(0,n._)((function*({storage:e}){const n=e.get("business-notify-manually-hidden");return n&&!s?{type:"UserHideFilter",kind:"businessNotify"}:!n&&s?{type:"UserUndoHideFilter",kind:"businessNotify"}:0===t?{type:"Noop"}:{type:"UserUndoHideFilter",kind:"businessNotify"}}))]}return"all"===t.kind||"unread"===t.kind||"chats"===t.kind||"messageRequest"===t.kind||"archive"===t.kind?[]:(0,a.exhaustivenessCheck)(t.kind);default:(0,a.exhaustivenessCheck)(t)}var s}},750142:(e,t,s)=>{"use strict";s.d(t,{handler:()=>p});var n=s(11010),r=s(434788),a=s(168465),o=s(86144),i=s(866358),c=s(197934),l=s(89131),d=s(95154),u=s(464474),h=s(851828),m=s(991792);const p=(e,t)=>{var s,p;const{channelId:g,postCmid:v,replyCmid:_}=t,C=f(g,v),y=e.channels.get(g);if(!y||"ChannelRestricted"===y.kind)return[];const k=a.findNodeByCmid(y.history,v).node,I="Node"===(null==(s=k)?void 0:s.kind)&&k.item;if(!I)return[];const E=_&&((null==(p=o.findCommentByCmid(I,_))?void 0:p.rootCmid)||_),b=(0,u.getCommentsHistoryLockKey)(g,v,I.comments.order,E);switch(t.type){case"UserHitCommentSend":{var w;const{text:s,attaches:r,extra:a}=t,o=c.ids(r).join(",");return s||o||(null==(w=a)?void 0:w.sticker)?e.locks.sendComment.has(C)?[]:(e.locks.sendComment.add(C),[(R=(0,n._)((function*({api:e}){try{var t,n,i,c;return{type:"UserHitCommentSend_RequestCompleted",hasFailed:!1,response:yield e.fetch("wall.createComment",{owner_id:g,post_id:v,message:s,attachments:o,reply_to_comment:_,sticker_id:null==(n=a)||null==(t=n.sticker)?void 0:t.id,sticker_referrer:null==(c=a)||null==(i=c.sticker)?void 0:i.referrer}),channelId:g,postCmid:v,replyCmid:_,text:s,attaches:r}}catch(e){return{type:"UserHitCommentSend_RequestCompleted",hasFailed:!0,channelId:g,postCmid:v,replyCmid:_,text:s,attaches:r}}})),function(e){return R.apply(this,arguments)})]):[]}case"UserHitCommentSend_RequestCompleted":{var M;const{text:s,attaches:r,hasFailed:a,response:c}=t;if(a)return[];const l=E?null==(M=o.findCommentByCmid(I,E))?void 0:M.replies:I.comments;if(!l)return[];const h=i.resolveCmid(c.comment_id);if(l.nextFrom){e.locks.getPostCommentsHistory.add(b);const t=(0,u.mapOrderToSort)(I.comments.order);return[(S=(0,n._)((function*({api:e}){try{return{type:"UserHitCommentSend_HistoryRequestCompleted",hasFailed:!1,response:yield e.fetch("wall.getComments",{owner_id:g,post_id:v,count:d.COMMENTS_PER_PAGE,thread_items_count:d.THREAD_COMMENTS_COUNT,need_likes:1,extended:1,sort:t,start_comment_id:h,comment_id:E,offset:1-d.COMMENTS_PER_PAGE}),channelId:g,postCmid:v,rootCommentCmid:E,newCommentCmid:h}}catch(e){return{type:"UserHitCommentSend_HistoryRequestCompleted",hasFailed:!0,channelId:g,postCmid:v,rootCommentCmid:E,newCommentCmid:h}}})),function(e){return S.apply(this,arguments)})]}e.locks.sendComment.delete(C);const m=!!r.sticker||!!r.ugcSticker,p=i.newNormal({canEdit:!m,channelId:g,postCmid:v,sentAt:Date.now(),rootCmid:E,cmid:h,peerId:e.ownerId,attaches:r},s);if(E){const e=o.findCommentByCmid(I,E);if(!e)return[];e.replies.history=[...e.replies.history,p],e.replies.count+=1}else I.comments.history=[...I.comments.history,p],I.comments.count+=1,I.comments.oneLevelCount+=1;return I.comments.lastSendCmid=h,[]}case"UserHitCommentSend_HistoryRequestCompleted":{const{hasFailed:s,response:n,newCommentCmid:a}=t;if(e.locks.sendComment.delete(C),e.locks.getPostCommentsHistory.delete(b),s)return[];const i=n.items.map((e=>(0,h.fromApiComment)(e)));if(E){const e=o.findCommentByCmid(I,E);if(!e)return[];e.replies=(0,r._)({},e.replies,{count:n.current_level_count||0,history:i,nextFrom:n.next_from,prevFrom:n.prev_from})}else I.comments=(0,r._)({},I.comments,{history:i,count:n.count,oneLevelCount:n.current_level_count||0,nextFrom:n.next_from,prevFrom:n.prev_from});return I.comments.lastSendCmid=a,(0,m.insertPeers)(e,{apiUsers:n.profiles||[],apiGroups:n.groups||[],apiContacts:[]}),[]}default:(0,l.exhaustivenessCheck)(t)}var S,R},f=(e,t)=>`${e}-${t}`},109424:(e,t,s)=>{"use strict";s.d(t,{handler:()=>i});var n=s(11010),r=s(89131),a=s(197934),o=s(991792);const i=(e,t)=>{switch(t.type){case"UserHitEdit":{const{cmid:r,text:i,attaches:c,peerId:l,keepForwarded:d}=t,u=e.convos.get(l),h=e.ownerId;if(!u)return[];e.locks.edit.add(l);const m=a.ids(c).join(",");return[(s=(0,n._)((function*({api:e}){let t=!1;try{var s,n;yield e.fetch("messages.edit",{cmid:r,peer_id:l,message:i,attachment:0===m.length?void 0:m,group_id:(0,o.getOwnerGroupId)(h),keep_forward_messages:d?1:0,keep_snippets:c.link||c.inviteLink||c.donutLink?1:0,lat:null==(s=c.geo)?void 0:s.coordinates.latitude,long:null==(n=c.geo)?void 0:n.coordinates.longitude})}catch(e){t=!0}return{type:"UserHitEdit_RequestCompleted",peerId:l,hasFailed:t}})),function(e){return s.apply(this,arguments)})]}case"UserHitEdit_RequestCompleted":{const{peerId:s,hasFailed:n}=t;e.locks.edit.delete(s);e.convos.get(s);return[]}default:return(0,r.exhaustivenessCheck)(t)}var s}},699642:(e,t,s)=>{"use strict";s.d(t,{handler:()=>d});var n=s(11010),r=s(434788),a=s(89131),o=s(197934),i=s(86144),c=s(168465),l=s(504698);const d=(e,t)=>{const{channelId:s,postCmid:d,commentCmid:h}=t,m=u(s,d);switch(t.type){case"UserHitEditComment":{const{text:r,attaches:a}=t;if(e.locks.sendComment.has(m))return[];e.locks.sendComment.add(m);const i=o.ids(a).join(",");return r||i?[(g=(0,n._)((function*({api:e}){let t=!1;try{t=!Boolean(yield e.fetch("wall.editComment",{attachments:i,owner_id:s,message:r,comment_id:h}))}catch(e){t=!0}return{type:"UserHitEditComment_RequestCompleted",hasFailed:t,text:r,attaches:a,channelId:s,postCmid:d,commentCmid:h}})),function(e){return g.apply(this,arguments)})]:[]}case"UserHitEditComment_RequestCompleted":{var p,f;e.locks.sendComment.delete(m);const{hasFailed:n,text:a,attaches:o}=t;if(n)return[];const u=e.channels.get(s);if("ChannelRestricted"===(null==(p=u)?void 0:p.kind))return[];const g=u&&c.findNodeByCmid(u.history,d).node,v="Node"===(null==(f=g)?void 0:f.kind)&&g.item,_=v&&i.findCommentByCmid(v,h);return _&&"Normal"===_.kind?(i.replaceComment(v,(0,r._)({},_,{chunks:l.fromServerText(a),attaches:o})),[]):[]}default:return(0,a.exhaustivenessCheck)(t)}var g},u=(e,t)=>`${e}-${t}`},978758:(e,t,s)=>{"use strict";s.d(t,{handler:()=>d});var n=s(11010),r=s(434788),a=s(197934),o=s(168465),i=s(86144),c=s(559360),l=s(89131);const d=(e,t)=>{switch(t.type){case"UserHitPostSend":{const{text:s,attaches:l,channelId:d,publishAt:h,topic:m,options:p,visibility:f,donutDelay:g,onComplete:v,onFail:_,editingPost:C}=t,y=e.channels.get(d);if(!y)return[];if("ChannelRestricted"===y.kind)return[];const k=a.ids(l).join(",");if(!s&&!k)return[];let I;return void 0!==h||C||(I=i.newPending({channelId:d,attaches:l,sentAt:+new Date},s),o.appendPending(y.history,I)),[(0,n._)((function*({api:e}){try{var t;v();const n={channel_id:d,message:s,attachments:k,publish_date:h&&Math.floor(h.getTime()/1e3),topic_id:c.getPostThemeIdFromKey(m),close_comments:u(p.has("close_comments")),mark_as_ads:u(p.has("mark_as_ads")),mute_notifications:u(p.has("mute_notifications")),signed:u(p.has("signed")),donut_paid_duration:"all"===f?void 0:-1===g?g:86400*g},a=C?yield e.fetch("channels.editMessage",(0,r._)({},n,{cmid:C.cmid})):yield e.fetch("channels.sendMessage",(0,r._)({},n,{from_group:1}));return{type:"UserHitPostSend_RequestCompleted",hasFailed:!1,randomId:null==(t=I)?void 0:t.randomId,cmid:i.resolveCmid(a.cmid),channelId:d}}catch(e){var n;return _(e),{type:"UserHitPostSend_RequestCompleted",hasFailed:!0,randomId:null==(n=I)?void 0:n.randomId,channelId:d}}}))]}case"UserHitPostSend_RequestCompleted":{const{hasFailed:s,randomId:n,channelId:r}=t,a=e.channels.get(r);if(!a)return[];if("ChannelRestricted"===a.kind)return[];if(s)return void 0!==n&&o.removePending(a.history,n),[];if(void 0!==n){const e=o.findPendingNode(a.history,n);void 0!==e&&(e.item.cmid=t.cmid)}return[]}default:(0,l.exhaustivenessCheck)(t)}},u=e=>void 0!==e?Number(e)&&1:e},273971:(e,t,s)=>{"use strict";s.d(t,{handler:()=>p});var n=s(11010),r=s(434788),a=s(453934),o=s(89131),i=s(777634),c=s(96190),l=s(185327),d=s(168465),u=s(197934),h=s(991792),m=s(95154);const p=(e,t,s)=>{switch(t.type){case"UserHitSend":{const{peerId:s}=t,r=e.convos.get(s);return r?function(e,t){const{text:s,attaches:n,peerId:r,timestamp:a,expireTTL:o,deleteTTL:c,entrypoint:l,extra:d,reply:u,forwarded:h}=e,p=function(e){const t=e.length;if(t<m.MAX_MESSAGE_SIZE)return[e];const s=[];let n=0;for(let r=0;r<Math.ceil(t/m.MAX_MESSAGE_SIZE);r++){const r=e.substring(n,n+m.MAX_MESSAGE_SIZE).lastIndexOf(" "),a=-1===r?m.MAX_MESSAGE_SIZE:r,o=t-n<=m.MAX_MESSAGE_SIZE?e.substring(n):e.substring(n,n+a);n+=o.length,s.push(o)}return s.map((e=>e.trim()))}(s),f=function(e){const t=Object.values(e).flat(),s=Object.fromEntries(Object.entries(e).map((([e,t])=>Array.isArray(t)?[t[0].kind,{key:e,isArray:!0}]:[t.kind,{key:e,isArray:!1}])));if(t.length<=m.MAX_MESSAGE_ATTACHES)return[e];return t.reduce(((e,t,n)=>{var r;const a=Math.floor(n/m.MAX_MESSAGE_ATTACHES),o=s[t.kind];return o?(e[a][o.key]=o.isArray?(null==(r=e[a][o.key])?void 0:r.concat(t))||[t]:t,e):e}),Array.from({length:Math.ceil(t.length/m.MAX_MESSAGE_ATTACHES)},(()=>Object())))}(n),g=p.length+f.length-1,v=[];for(let e=0;e<g;e++){const s=p[e]||"",n=f[e-p.length+1]||{},m=i.newQueued({peerId:r,text:s,isOut:!0,sentAt:a+e,authorId:t,attaches:n,expireTTL:o,deleteTTL:c,extra:d,entrypoint:l},0===e?u:void 0,e===g-1?h:void 0);v.push(m)}return v}(t,e.ownerId).flatMap((t=>{l.appendQueuedMessage(r,t);const s=e.locks.sendQueue.get(r.peerId);return s?(s.add(t.randomId),[]):(e.locks.sendQueue.set(r.peerId,new Set([t.randomId])),[f(t.peerId,t.randomId,t.text,u.ids(t.attaches),t.extra,t.entrypoint,t.attaches.geo,(0,h.getOwnerGroupId)(e.ownerId),g(t)),c.isMarusia(t.peerId)&&(a=(0,n._)((function*({marusia:e}){var s;return null==(s=e)||s.handleAction({type:"add_message",payload:{randomId:Number(t.randomId),text:i.toRawText(t),isOutbound:t.isOut,local:!0,payload:t.extra.botPayload,attachIds:u.ids(t.attaches)}}),{type:"Noop"}})),function(e){return a.apply(this,arguments)})]);var a})):[]}case"UserHitSend_RequestCompleted":{var r;const{peerId:s,randomId:n,response:o}=t,c=e.convos.get(s),l=e.ownerId;if(!c)return e.locks.sendQueue.delete(s),[];const m=d.findPendingNode(c.history,n);var v;if(m)o?(null==(v=o)?void 0:v.cmid)&&i.updateCmid(m.item,i.resolveCmid(o.cmid)):i.updateFail(m.item,!0);const p=e.locks.sendQueue.get(c.peerId);if(!p)return[];p.delete(n);const _=[...p][0];if(!_)return e.locks.sendQueue.delete(s),[];const C=null==(r=d.findPendingNode(c.history,_))?void 0:r.item;if(!C)return[];const y=(0,a.current)(C);return[f(s,y.randomId,y.text,u.ids(y.attaches),y.extra,y.entrypoint,y.attaches.geo,(0,h.getOwnerGroupId)(l),g(y))]}case"UserHitResendFailedMessage":{var _;const{randomId:s,peerId:n,entrypoint:r}=t,o=e.convos.get(n),i=e.ownerId;if(!o)return[];const c=null==(_=d.findPendingNode(o.history,s))?void 0:_.item;if(!c)return[];l.updateSendingFail(o,s,!1),l.changeQueuedMessageEntrypoint(o,s,r);const m=e.locks.sendQueue.get(o.peerId);if(m)return m.add(c.randomId),[];e.locks.sendQueue.set(o.peerId,new Set([c.randomId]));const p=(0,a.current)(c);return[f(n,p.randomId,p.text,u.ids(p.attaches),p.extra,r,p.attaches.geo,(0,h.getOwnerGroupId)(i),g(p))]}case"UserHitResendAllFailedMessages":{const{peerId:n,entrypoint:r}=t,a=e.convos.get(n);if(!a)return[];return l.allQueuedMessages(a).filter((e=>e.hasFailed)).flatMap((t=>p(e,{type:"UserHitResendFailedMessage",peerId:n,randomId:t.randomId,entrypoint:r||t.entrypoint},s)))}case"ResendAllFailedMessages":return Array.from(e.convos.values()).flatMap((t=>p(e,{type:"UserHitResendAllFailedMessages",peerId:t.peerId},s)));case"UserHitSendWidget":{const{peerId:n,text:r,timestamp:a,entrypoint:o,extra:c}=t;if(e.convos.get(n))return p(e,{type:"UserHitSend",attaches:{},extra:c,entrypoint:o,text:r,peerId:n,timestamp:a},s);const l=i.newQueued({peerId:n,text:r,isOut:!0,sentAt:a,authorId:e.ownerId,attaches:{},extra:c,entrypoint:o});return[f(l.peerId,l.randomId,l.text,u.ids(l.attaches),l.extra,l.entrypoint,l.attaches.geo,(0,h.getOwnerGroupId)(e.ownerId),null)]}default:return(0,o.exhaustivenessCheck)(t)}};function f(e,t,s,a,o,i,c,l,d){return u=(0,n._)((function*({api:n}){const u={};o.sticker&&(u.sticker_id=o.sticker.id,u.sticker_referrer=o.sticker.referrer),o.botPayload&&(u.payload=o.botPayload),o.silent&&(u.silent=1),o.expiresIn&&(u.expire_ttl=o.expiresIn),c&&(u.lat=c.coordinates.latitude,u.long=c.coordinates.longitude);try{const o=yield n.fetch("messages.send",(0,r._)({},u,{peer_id:e,random_id:t,message:s,forward:d?JSON.stringify(d):void 0,attachment:0===a.length?void 0:a.join(","),entrypoint:i,group_id:l}));return{type:"UserHitSend_RequestCompleted",peerId:e,randomId:t,response:o}}catch(s){return{type:"UserHitSend_RequestCompleted",peerId:e,randomId:t}}})),function(e){return u.apply(this,arguments)};var u}function g(e){let t=null;return e.replyMessage&&(t={peer_id:e.replyMessage.peerId,conversation_message_ids:[e.replyMessage.cmid],is_reply:!0}),e.forwardedMessages&&(t={peer_id:e.forwardedMessages[0].peerId,conversation_message_ids:e.forwardedMessages.map((e=>e.cmid))}),t}},43109:(e,t,s)=>{"use strict";s.d(t,{handler:()=>h});var n=s(11010),r=s(434788),a=s(89131),o=s(86144),i=s(96190),c=s(168465),l=s(95154),d=s(991792);const u={UserChangedLike:"UserChangedLike",UserChangedLike_RequestCompleted:"UserChangedLike",UserLoadedLikes:"UserLoadedLikes",UserLoadedLikes_RequestCompleted:"UserLoadedLikes"},h=(e,t,s)=>{let p,f,g;switch(t.kind){case"comment":{var v,_;const{channelId:s,postCmid:n,commentCmid:r}=t,a=e.channels.get(s);if("ChannelRestricted"===(null==(v=a)?void 0:v.kind))break;const i=a&&c.findNodeByCmid(a.history,n).node,l="Node"===(null==(_=i)?void 0:_.kind)&&o.findCommentByCmid(i.item,r);if(!l||"Normal"!==l.kind)break;p=l.channelId,g=l,f=l.cmid;break}case"post":{var C,y;const{channelId:s,postCmid:n}=t,r=e.channels.get(s);if("ChannelRestricted"===(null==(C=r)?void 0:C.kind))break;const a=r&&c.findNodeByCmid(r.history,n).node,o="Node"===(null==(y=a)?void 0:y.kind)&&a.item;if(!o)break;p=o.channelId,f=o.cmid,g=o;break}default:(0,a.exhaustivenessCheck)(t)}if(!g||!p||!f)return[];const k=m(u[t.type],t.kind,p,f);switch(t.type){case"UserLoadedLikes":{if(e.locks.likeActions.has(k))return[];let s;switch(e.locks.likeActions.add(k),t.kind){case"comment":case"post":s=g.likes.peerIds.size;break;default:(0,a.exhaustivenessCheck)(t)}const o=0===g.likes.peerIds.size?l.LIKE_PEERS_FIRST_LOAD:l.LIKE_PEERS_PER_PAGE;return[(E=(0,n._)((function*({api:e}){try{const n=yield e.fetch("likes.getList",{type:t.kind,owner_id:p,item_id:f,extended:1,skip_own:1,count:o,offset:s});return(0,r._)({},t,{type:"UserLoadedLikes_RequestCompleted",response:n,hasFailed:!1})}catch(e){return(0,r._)({},t,{type:"UserLoadedLikes_RequestCompleted",hasFailed:!0})}})),function(e){return E.apply(this,arguments)})]}case"UserLoadedLikes_RequestCompleted":{const{hasFailed:s,response:n}=t;if(e.locks.likeActions.delete(k),s||!n)return[];const r=n.items.filter((e=>"profile"===e.type)),o=n.items.filter((e=>"group"===e.type)),c=n.items.map((e=>i.resolveId(e.id)));switch((0,d.insertPeers)(e,{apiUsers:r,apiGroups:o,apiContacts:[]}),t.kind){case"comment":case"post":c.forEach((e=>{var t;return null==(t=g)?void 0:t.likes.peerIds.add(e)}));break;default:(0,a.exhaustivenessCheck)(t)}return[]}case"UserChangedLike":{const{reactionId:s}=t,a=g.likes.reactionId;if(a===s)return[];const o=void 0!==a;return e.locks.likeActions.has(k)?[]:(e.locks.likeActions.add(k),void 0===s?g.likes.count-=1:o||(g.likes.count+=1),g.likes.reactionId=s,[(I=(0,n._)((function*({api:e}){try{const n=yield e.fetch(o&&void 0===s?"likes.delete":"likes.add",{type:t.kind,owner_id:p,item_id:f||0,reaction_id:s});return(0,r._)({},t,{type:"UserChangedLike_RequestCompleted",response:n,hasFailed:!1})}catch(e){return(0,r._)({},t,{type:"UserChangedLike_RequestCompleted",hasFailed:!0,prevReactionId:a})}})),function(e){return I.apply(this,arguments)})])}case"UserChangedLike_RequestCompleted":{const{hasFailed:n,response:a,prevReactionId:o}=t;return e.locks.likeActions.delete(k),n||!a?(h(e,(0,r._)({},t,{type:"UserChangedLike",reactionId:o}),s),e.locks.likeActions.delete(k),[]):(g.likes.count=a.likes,[])}default:(0,a.exhaustivenessCheck)(t)}var I,E},m=(e,t,s,n)=>`${e}-${t}-${s}-${n}`},464474:(e,t,s)=>{"use strict";s.d(t,{getCommentsHistoryLockKey:()=>h,handler:()=>u,mapOrderToSort:()=>m});var n=s(11010),r=s(434788),a=s(89131),o=s(86144),i=s(168465),c=s(991792),l=s(95154),d=s(851828);const u=(e,t)=>{switch(t.type){case"UserLoadedCommentsHistory":{var s;const{channelId:a,postCmid:c,direction:d,order:u,rootCommentCmid:f}=t,g=h(a,c,u,f);if(e.locks.getPostCommentsHistory.has(g))return[];e.locks.getPostCommentsHistory.add(g);const v=e.channels.get(a);if(!v||"ChannelRestricted"===v.kind)return[];const _=i.findNodeByCmid(v.history,c).node,C="Node"===(null==(s=_)?void 0:s.kind)&&_.item;if(!C)return[];let y,k;if(u!==C.comments.order&&o.changeCommentsOrder(C,u),f){const e=o.findCommentByCmid(C,f);if(!e)return[];y=e.replies.nextFrom,k=e.replies.prevFrom}else y=C.comments.nextFrom,k=C.comments.prevFrom;const I=m(u);return[(p=(0,n._)((function*({api:e}){try{const s=yield e.fetch("wall.getComments",{owner_id:a,post_id:c,count:l.COMMENTS_PER_PAGE,thread_items_count:l.THREAD_COMMENTS_COUNT,need_likes:1,extended:1,sort:I,comment_id:f,next_from:"forward"===d?y:void 0,prev_from:"backward"===d?k:void 0});return(0,r._)({},t,{type:"UserLoadedCommentsHistory_RequestSucceed",response:s})}catch(e){return{type:"UserLoadedCommentsHistory_RequestFailed",channelId:a,postCmid:c,order:u,direction:d,hasFailed:!0}}})),function(e){return p.apply(this,arguments)})]}case"UserLoadedCommentsHistory_RequestSucceed":{var u;const{response:s,channelId:n,postCmid:l,direction:m,order:p,rootCommentCmid:f}=t;e.locks.getPostCommentsHistory.delete(h(n,l,p,f));const g=e.channels.get(n);if(!g||"ChannelRestricted"===g.kind)return[];const v=i.findNodeByCmid(g.history,l).node,_="Node"===(null==(u=v)?void 0:u.kind)&&v.item;if(!_||_.comments.order!==p)return[];const C=s.items.map((e=>(0,d.fromApiComment)(e))),y=(e,t)=>{switch(m){case"forward":return(0,r._)({},e,{history:[...e.history,...t],nextFrom:s.next_from});case"backward":return(0,r._)({},e,{history:[...t,...e.history],prevFrom:s.prev_from});default:(0,a.exhaustivenessCheck)(m)}};if(f){const e=o.findCommentByCmid(_,f);if(!e)return[];e.replies=y(e.replies,C),e.replies.count=s.current_level_count||e.replies.count}else _.comments=y(_.comments,C),_.comments.count=s.count,_.comments.oneLevelCount=s.current_level_count||_.comments.oneLevelCount;return(0,c.insertPeers)(e,{apiUsers:s.profiles||[],apiGroups:s.groups||[],apiContacts:[]}),[]}case"UserLoadedCommentsHistory_RequestFailed":{const{channelId:s,postCmid:n,order:r,rootCommentCmid:a}=t;return e.locks.getPostCommentsHistory.delete(h(s,n,r,a)),[]}default:return(0,a.exhaustivenessCheck)(t)}var p},h=(e,t,s,n)=>`${e}-${t}-${s}-${n||""}`,m=e=>{switch(e){case"interesting":return;case"new":return"desc";case"old":return"asc";default:(0,a.exhaustivenessCheck)(e)}}},708315:(e,t,s)=>{"use strict";s.d(t,{handler:()=>d});var n=s(11010),r=s(906978),a=s(839963),o=s(83062),i=s(89131),c=s(927411),l=s(991792);const d=(e,t)=>{switch(t.type){case"UserOpenedChannel":{const{channelId:s}=t,r=e.locks.channelsCleanup.get(s)||0;e.locks.channelsCleanup.set(s,r+1);return e.channels.get(s)?[]:[(0,n._)((function*({api:e}){try{const t=yield e.fetch("channels.getById",{channel_ids:s.toString(),extended:1},{retries:2});return{type:"UserOpenedChannel_ChannelRequestCompleted",channelId:s,response:t,hasFailed:!1}}catch(e){return{type:"UserOpenedChannel_ChannelRequestCompleted",channelId:s,hasFailed:!0,errCode:e instanceof c.IApi.RequestError?e.code:void 0}}}))]}case"UserOpenedChannel_ChannelRequestCompleted":{const{hasFailed:s,channelId:n,response:a,errCode:c}=t;if(s&&c===r.API_ERROR_ACCESS)return e.channels.set(n,{id:n,kind:"ChannelRestricted"}),[];if(!a)return[];(0,l.insertChannels)(e,{apiChannels:a.items||[],apiGroups:a.groups||[]});const d=e.channels.get(n);if(!d){if(i.isDev)throw new Error("Диалог не был найден");return[]}return"ChannelRestricted"===d.kind||d.isMember&&o.refreshChannels(e.organisers,d),[]}case"UserClosedChannel":{const{channelId:s}=t,n=e.locks.channelsCleanup.get(s);if(n&&n>1)return e.locks.channelsCleanup.set(s,n-1),[];e.locks.channelsCleanup.delete(s);const r=e.channels.get(s);return r?("ChannelRestricted"===r.kind||a.cleanup(r),[]):[]}default:return(0,i.exhaustivenessCheck)(t)}}},733835:(e,t,s)=>{"use strict";s.d(t,{handler:()=>u});var n=s(11010),r=s(991792),a=s(96190),o=s(185327),i=s(83062),c=s(71568),l=s(89131),d=s(986727);const u=(e,t,s)=>{switch(t.type){case"LoadChatMembers":case"LoadStickers":case"ActualizeComposerDraft":return[];case"UserOpenedConvo":{e.convoLoadingFailed=void 0;const{peerId:a}=t,o=e.convos.get(a),i=e.locks.convosCleanup.get(a)||0;e.locks.convosCleanup.set(a,i+1);const c=(0,r.getOwnerGroupId)(e.ownerId);return o?u(e,{type:"UserOpenedConvo_ConvoRequestCompleted",peerId:a,hasFailed:!1},s):[(0,n._)((function*({api:e}){try{const t=yield e.fetch("messages.getConversationsById",{peer_ids:a.toString(),group_id:c,extended:1},{retries:3});return{type:"UserOpenedConvo_ConvoRequestCompleted",peerId:a,hasFailed:!1,profiles:t.profiles,groups:t.groups,conversations:t.items,contacts:t.contacts}}catch(e){return{type:"UserOpenedConvo_ConvoRequestCompleted",peerId:a,hasFailed:!0}}}))]}case"UserOpenedConvo_ConvoRequestCompleted":{const{peerId:d,conversations:u,profiles:m,groups:y,contacts:k,hasFailed:I}=t;if(I){if(l.isDev)throw new Error("Не удалось загрузить диалог");return e.convoLoadingFailed=d,[]}(0,r.insertConvos)(e,u||[]),(0,r.insertPeers)(e,{apiUsers:m||[],apiGroups:y||[],apiContacts:k||[]});const E=e.convos.get(d);if(!E){if(l.isDev)throw new Error("Диалог не был найден");return[]}const b=E.isMarkedUnread&&0===E.unreadCount;b&&o.markRead(E),i.refresh(e.organisers,E);const w="ChatConvo"===E.kind&&void 0===E.members&&o.canReadMembers(E)&&!e.locks.getConversationMembers.has(d);w&&e.locks.getConversationMembers.add(d);const M=(0,r.getOwnerGroupId)(e.ownerId),S=Object.values(s.me_sticker_packs).flat().map((e=>c.resolveStickerId(e))).filter((t=>!e.stickers.has(t))),R=S.length>0,A=!e.locks.loadStickerPacks;return A&&(e.locks.loadStickerPacks=!0),[w&&a.isChatPeerId(d)&&(C=(0,n._)((function*(){return{type:"LoadChatMembers",peerId:d}})),function(){return C.apply(this,arguments)}),R&&(_=(0,n._)((function*(){return{type:"LoadStickers",stickerIds:S}})),function(){return _.apply(this,arguments)}),A&&(v=(0,n._)((function*({api:e}){try{return{type:"UserOpenedConvo_StickerPacksRequestCompleted",response:yield e.fetch("store.getProducts",{type:"stickers",filters:"active",extended:1},{retries:10})}}catch(e){return{type:"UserOpenedConvo_StickerPacksRequestCompleted"}}})),function(e){return v.apply(this,arguments)}),(g=(0,n._)((function*({api:e,storage:t}){try{const n=yield function(e){return h.apply(this,arguments)}({api:e,storage:t,featureFlags:s});return{type:"UserOpenedConvo_StickersKeywordsRequestCompleted",response:n}}catch(e){return{type:"UserOpenedConvo_StickersKeywordsRequestCompleted"}}})),function(e){return g.apply(this,arguments)}),b&&(f=(0,n._)((function*({api:e}){try{yield e.fetch("messages.markAsRead",{peer_id:d,mark_conversation_as_read:1,group_id:M})}catch(e){}return{type:"Noop"}})),function(e){return f.apply(this,arguments)}),(p=(0,n._)((function*(){return{type:"ActualizeComposerDraft",peerId:d}})),function(){return p.apply(this,arguments)})]}case"UserClosedConvo":{const s=e.locks.convosCleanup.get(t.peerId);if(s&&s>1)return e.locks.convosCleanup.set(t.peerId,s-1),[];e.locks.convosCleanup.delete(t.peerId);const n=e.convos.get(t.peerId);return n?(o.cleanup(n),[]):[]}case"UserOpenedConvo_StickersKeywordsRequestCompleted":{const{response:s}=t;return s&&(e.stickersKeywords=(0,d.fromApiStickersKeywords)(s)),[]}case"UserOpenedConvo_StickerPacksRequestCompleted":{var m;const{response:s}=t;return s?(null==(m=s.items)||m.forEach((t=>{var s;null==(s=t.stickers)||s.forEach((t=>{e.stickers.set(c.resolveStickerId(t.sticker_id),(0,d.fromApiSticker)(t))}))})),[]):[]}default:return(0,l.exhaustivenessCheck)(t)}var p,f,g,v,_,C};function h(){return(h=(0,n._)((function*({api:e,storage:t,featureFlags:s}){const n=yield t.getIDB("stickers-keywords"),r=Math.round((new Date).getTime()/1e3),a=n&&n.expiresAt>r,o=a?n.response:yield e.fetch("store.getStickersKeywords",{need_stickers:0,all_products:s.vkm_send_promoted_stickers?1:0},{retries:3,timeout:3e4});return a||(yield t.setIDB("stickers-keywords",{response:o,expiresAt:r+86400}).catch((()=>{}))),o}))).apply(this,arguments)}},666840:(e,t,s)=>{"use strict";s.d(t,{handler:()=>d});var n=s(11010),r=s(434788),a=s(96190),o=s(89131),i=s(991792),c=s(185327),l=s(863536);const d=(e,t,s)=>{switch(t.type){case"LoadChatMembers":return[];case"UserOpenedConvoProfile":{const{peerId:r,isLinkWithHistory:a}=t,o=e.convos.get(r),c=e.ownerId;return o?d(e,{type:"UserOpenedConvoProfile_ConvoRequestCompleted",peerId:r,hasFailed:!1,isLinkWithHistory:a},s):[(0,n._)((function*({api:e}){try{let t;return o||(t=yield e.fetch("messages.getConversationsById",{peer_ids:r.toString(),extended:1,group_id:(0,i.getOwnerGroupId)(c)},{retries:3})),{type:"UserOpenedConvoProfile_ConvoRequestCompleted",peerId:r,hasFailed:!1,convoResponse:t,isLinkWithHistory:a}}catch(e){return{type:"UserOpenedConvoProfile_ConvoRequestCompleted",peerId:r,hasFailed:!0,isLinkWithHistory:a}}}))]}case"UserOpenedConvoProfile_ConvoRequestCompleted":{const{peerId:s,convoResponse:r,hasFailed:d,isLinkWithHistory:m}=t,p=e.ownerId;if(d){if(o.isDev)throw new Error("Не удалось загрузить диалог");return[(0,n._)((function*(){return{type:"Noop"}}))]}r&&((0,i.insertConvos)(e,r.items||[]),(0,i.insertPeers)(e,{apiUsers:r.profiles||[],apiGroups:r.groups||[],apiContacts:r.contacts||[]}));const f=e.convos.get(s);if(!f){if(o.isDev)throw new Error("Диалог не был найден");return[]}const g="ChatConvo"===f.kind&&void 0===f.members&&c.canReadMembers(f)&&!e.locks.getConversationMembers.has(s);g&&e.locks.getConversationMembers.add(s);const v="ChatConvo"===f.kind&&f.acl.canSeeInviteLink;return[g&&a.isChatPeerId(s)&&(h=(0,n._)((function*(){return{type:"LoadChatMembers",peerId:s}})),function(){return h.apply(this,arguments)}),v&&a.isChatPeerId(s)&&(u=(0,n._)((function*({api:e}){try{return{type:"UserOpenedConvoProfile_InviteLinksCompleted",peerId:s,isLinkWithHistory:m,response:yield e.fetch("messages.getInviteLink",{peer_id:s,visible_messages_count:m?l.VISIBLE_MESSAGES_COUNT:0,reset:0,group_id:(0,i.getOwnerGroupId)(p)},{retries:1})}}catch(e){}return{type:"Noop"}})),function(e){return u.apply(this,arguments)})]}case"UserOpenedConvoProfile_InviteLinksCompleted":{const{peerId:s,response:{link:n},isLinkWithHistory:a}=t,o=e.convos.get(s);return o&&"ChatConvo"===o.kind&&n?(c.replaceInviteLinks(o,(0,r._)({},o.inviteLinks,a?{withHistory:n}:{noHistory:n})),[]):[]}default:(0,o.exhaustivenessCheck)(t)}var u,h}},475881:(e,t,s)=>{"use strict";s.d(t,{handler:()=>l});var n=s(11010),r=s(185327),a=s(777634),o=s(89131),i=s(991792),c=s(453934);const l=(e,t)=>{switch(t.type){case"UserPlayedMessage":{var s;const{cmid:o,peerId:c}=t,l=e.convos.get(c),d=l&&r.findMessageByCmid(l,o),u=e.ownerId;return"Normal"===(null==(s=d)?void 0:s.kind)&&a.canChangeMessagePlayedStatus(d)?[(0,n._)((function*({api:e}){try{return{type:"UserPlayedMessage_RequestCompleted",hasFailed:1!==(yield e.fetch("messages.markAsPlayed",{peer_id:c,cmid:o,group_id:(0,i.getOwnerGroupId)(u)},{retries:1})),cmid:o,peerId:c}}catch(e){return{type:"UserPlayedMessage_RequestCompleted",hasFailed:!0,cmid:o,peerId:c}}}))]:[]}case"UserPlayedMessage_RequestCompleted":if(!t.hasFailed){var l;const{cmid:s,peerId:n}=t,o=e.convos.get(n),i=o&&(0,c.castDraft)(r.findMessageByCmid(o,s));if("Normal"!==(null==(l=i)?void 0:l.kind)||!a.canChangeMessagePlayedStatus(i))return[];i.isPlayed=!0}return[];default:(0,o.exhaustivenessCheck)(t)}}},807331:(e,t,s)=>{"use strict";s.d(t,{handler:()=>r});var n=s(89131);const r=(e,t)=>{if("UserProfileInfo_Update"===t.type){const{user:s,profileInfo:n}=t;return n&&(e.viewer.profileInfo=n),s&&e.peers.set(s.id,s),[]}(0,n.exhaustivenessCheck)(t.type)}},957046:(e,t,s)=>{"use strict";s.d(t,{handler:()=>o});var n=s(11010),r=s(89131),a=s(991792);const o=(e,t)=>{switch(t.type){case"UserReadAllReactions":{const{peerId:r}=t;if(e.locks.readAllReactions.has(r))return[];e.locks.readAllReactions.add(r);const o=(0,a.getOwnerGroupId)(e.ownerId),i=e.convos.get(r);let c=new Map;return i&&(c=new Map(i.unreadReactions.entries()),i.unreadReactions.clear()),[(s=(0,n._)((function*({api:e}){try{const t=yield e.fetch("messages.markReactionsAsRead",{peer_id:r,cmids:Array.from(c.keys()).join(","),group_id:o});return{type:"UserReadAllReactions_RequestCompleted",peerId:r,hasFailed:1!==t,unreadReactions:c}}catch(e){return{type:"UserReadAllReactions_RequestCompleted",peerId:r,hasFailed:!0,unreadReactions:c}}})),function(e){return s.apply(this,arguments)})]}case"UserReadAllReactions_RequestCompleted":{const{hasFailed:s,peerId:n,unreadReactions:r}=t;if(e.locks.readAllReactions.delete(n),!s)return[];const a=e.convos.get(n);return a&&(a.unreadReactions=new Map([...r,...a.unreadReactions])),[]}default:return(0,r.exhaustivenessCheck)(t)}var s}},262641:(e,t,s)=>{"use strict";s.d(t,{handler:()=>i});var n=s(11010),r=s(89131),a=s(83062),o=s(839963);const i=(e,t)=>{switch(t.type){case"UserReadPost":{const{cmid:s,channelId:n}=t,r=e.channels.get(n);if(!r)return[];if("ChannelRestricted"===r.kind)return[];if(s<=r.inReadCmid)return[];o.readUntil(r,s),a.refreshChannels(e.organisers,r);const i=e.channelReadQueues.has(n);return e.channelReadQueues.set(n,r.inReadCmid),i?[]:[c(n)]}case"UserReadPost_ThrottleTimedOut":{const{channelId:r}=t,a=e.channelReadQueues.get(r);return a?[(s=(0,n._)((function*({api:e}){try{yield e.fetch("channels.markAsRead",{channel_id:r,last_read_cmid:a})}catch(e){}return{type:"UserReadPost_RequestCompleted",channelId:r,readUntilCmid:a}})),function(e){return s.apply(this,arguments)})]:[]}case"UserReadPost_RequestCompleted":{const{channelId:s,readUntilCmid:n}=t,r=e.channelReadQueues.get(s);return r?n>=r?(e.channelReadQueues.delete(s),[]):[c(s)]:[]}default:return(0,r.exhaustivenessCheck)(t)}var s};function c(e){return t=(0,n._)((function*(){return yield(0,r.sleep)(300),{type:"UserReadPost_ThrottleTimedOut",channelId:e}})),function(){return t.apply(this,arguments)};var t}},328079:(e,t,s)=>{"use strict";s.d(t,{handler:()=>i});var n=s(11010),r=s(999504),a=s(89131),o=s(927411);const i=(e,t)=>{switch(t.type){case"UserReorderedFolders":{const{order:a}=t;return e.locks.reorderFolders?[]:(e.locks.reorderFolders=!0,r.reorderFolders(e.organisers.folders,a),[(s=(0,n._)((function*({api:e}){try{return{type:"UserReorderedFolders_ReorderRequestCompleted",hasFailed:1!==(yield e.fetch("messages.reorderFolders",{folder_ids:a.join(",")})),order:a}}catch(e){let t;return e instanceof o.IApi.RequestError&&(t=e.code),{type:"UserReorderedFolders_ReorderRequestCompleted",hasFailed:!0,error:t,order:a}}})),function(e){return s.apply(this,arguments)})])}case"UserReorderedFolders_ReorderRequestCompleted":{const{hasFailed:s}=t;if(e.locks.reorderFolders=!1,s){if(t.error);else if(a.isDev)throw new Error("Не удалось изменить порядок папок");return[]}return[]}default:(0,a.exhaustivenessCheck)(t)}var s}},863536:(e,t,s)=>{"use strict";s.d(t,{VISIBLE_MESSAGES_COUNT:()=>c,handler:()=>l});var n=s(11010),r=s(434788),a=s(89131),o=s(185327),i=s(991792);const c=250,l=(e,t)=>{switch(t.type){case"UserRequestChatInvitationLink":{const{peerId:s,isLinkWithHistory:r}=t,a=e.ownerId;return[(l=(0,n._)((function*({api:e}){try{const t=yield e.fetch("messages.getInviteLink",{peer_id:s,reset:0,visible_messages_count:r?c:0,group_id:(0,i.getOwnerGroupId)(a)},{retries:1});return{type:"UserRequestChatInvitationLink_RequestCompleted",hasFailed:!t.link,link:t.link,isLinkWithHistory:r,peerId:s}}catch(e){return{type:"UserRequestChatInvitationLink_RequestCompleted",hasFailed:!0,isLinkWithHistory:r,peerId:s}}})),function(e){return l.apply(this,arguments)})]}case"UserRequestChatInvitationLink_RequestCompleted":{const{peerId:s,link:n,isLinkWithHistory:a,hasFailed:i}=t,c=e.convos.get(s);return!i&&c&&"ChatConvo"===c.kind&&n?(o.replaceInviteLinks(c,(0,r._)({},c.inviteLinks,a?{withHistory:n}:{noHistory:n})),[]):[]}case"UserResetChatInvitationLink":{const{peerId:s}=t,r=e.ownerId;return[function(){var e=(0,n._)((function*({api:e}){try{const t=yield e.fetch("messages.getInviteLink",{peer_id:s,reset:1,visible_messages_count:c,group_id:(0,i.getOwnerGroupId)(r)},{retries:1}),n=yield e.fetch("messages.getInviteLink",{peer_id:s,reset:0,visible_messages_count:0,group_id:(0,i.getOwnerGroupId)(r)},{retries:1});return{type:"UserResetChatInvitationLink_RequestCompleted",hasFailed:!t.link||!n.link,links:{withHistory:t.link,noHistory:n.link},peerId:s}}catch(e){return{type:"UserResetChatInvitationLink_RequestCompleted",hasFailed:!0,peerId:s,links:{}}}}));return function(t){return e.apply(this,arguments)}}()]}case"UserResetChatInvitationLink_RequestCompleted":{var s;const{peerId:n,links:r,hasFailed:a}=t,i=e.convos.get(n);return a||"ChatConvo"!==(null==(s=i)?void 0:s.kind)?[]:r.noHistory&&r.withHistory?(o.replaceInviteLinks(i,r),[]):[]}default:return(0,a.exhaustivenessCheck)(t)}var l}},741497:(e,t,s)=>{"use strict";s.d(t,{handler:()=>u});var n=s(11010),r=s(89131),a=s(95154),o=s(839963),i=s(86144),c=s(168465),l=s(54965),d=s(991792);const u=(e,t)=>{switch(t.type){case"UserScrolledChannelHistory":{const{channelId:o,direction:i,startCmid:c,possibleSkipped:l}=t,d=e.channels.get(o);if(!d)return[];if("ChannelRestricted"===d.kind)return[];if(e.locks.getChannelHistory.has(h(o,c)))return[];e.locks.getChannelHistory.add(h(o,c));let u,m=Math.min(a.POSTS_PER_PAGE,l||a.POSTS_PER_PAGE)+2;switch(i){case"backward":u=-1;break;case"forward":u=1-m;break;case"around":m=a.POSTS_PER_PAGE,u=-Math.floor(.8*m),d.inReadCmid===c&&(u=Math.max(-d.unreadCount,u));break;default:(0,r.exhaustivenessCheck)(i)}return[(s=(0,n._)((function*({api:e}){try{const t=yield e.fetch("channels.getHistory",{channel_id:o,start_cmid:Math.max(c,1),count:m,offset:u,extended:1},{retries:5});let s,n;switch(i){case"backward":s=m===t.items.length,n=!0;break;case"around":{const e=t.items.filter((({cmid:e})=>e<=c)).length;s=e===m+u;const r=t.items.length-e;n=r===-u;break}case"forward":s=!0,n=m===t.items.length;break;default:(0,r.exhaustivenessCheck)(i)}return{type:"UserScrolledChannelHistory_RequestSucceed",channelId:o,startCmid:c,response:t,hasMoreBackward:s,hasMoreForward:n}}catch(e){return{type:"UserScrolledChannelHistory_RequestFailed",channelId:o,startCmid:c}}})),function(e){return s.apply(this,arguments)})]}case"UserScrolledChannelHistory_RequestSucceed":{const{channelId:s,startCmid:n,response:r,hasMoreBackward:a,hasMoreForward:u}=t;e.locks.getChannelHistory.delete(h(s,n));const m=e.channels.get(s);if(!m)return[];if("ChannelRestricted"===m.kind)return[];const p=[];return r.items.reverse().forEach(((t,s,n)=>{var r;const{post:d,reactions:h}=(0,l.fromApiPost)(t),f=o.findPostByCmid(m,d.cmid),g=i.merge(d,"Node"===(null==(r=f)?void 0:r.kind)?f.item:void 0);h.forEach((t=>{e.reactions.set(t.id,t)})),0===s&&g.cmid>1&&a&&p.push({kind:"GapNode",fromCmid:i.resolveCmid(1),toCmid:i.resolveCmid(g.cmid-1)}),p.push({kind:"Node",item:g});const v=c.lastCmid(m.history);s===n.length-1&&void 0!==v&&u&&g.cmid<v&&p.push({kind:"GapNode",fromCmid:i.resolveCmid(g.cmid+1),toCmid:i.resolveCmid(v)})})),o.insertPosts(m,p),(0,d.insertPeers)(e,{apiUsers:r.profiles||[],apiGroups:r.groups||[],apiContacts:[]}),[]}case"UserScrolledChannelHistory_RequestFailed":{const{channelId:s,startCmid:n}=t;return e.locks.getChannelHistory.delete(h(s,n)),[]}default:return(0,r.exhaustivenessCheck)(t)}var s};function h(e,t){return`${e}-${t}`}},527600:(e,t,s)=>{"use strict";s.d(t,{handler:()=>d});var n=s(11010),r=s(89131),a=s(185327),o=s(777634),i=s(95154),c=s(991792),l=s(481186);const d=(e,t)=>{switch(t.type){case"UserScrolledConvoHistory":{const{peerId:a,direction:l,startCmid:d,possibleSkipped:h}=t,m=e.ownerId,p=e.convos.get(a);if(!p)return[];const f=u(a,d);if(e.locks.getHistory.has(f))return[];e.locks.getHistory.add(f);let g,v=Math.min(i.MESSAGES_PER_PAGE,h||i.MESSAGES_PER_PAGE)+2;switch(l){case"backward":g=-1;break;case"forward":g=1-v;break;case"around":v=i.MESSAGES_PER_PAGE,g=-Math.floor(.8*v),p.inReadBy===d&&(g=Math.max(-p.unreadCount,g));break;default:(0,r.exhaustivenessCheck)(l)}return[(s=(0,n._)((function*({api:e}){try{const t=yield e.fetch("messages.getHistory",{peer_id:a,start_cmid:d,count:v,offset:g,extended:1,group_id:(0,c.getOwnerGroupId)(m),fwd_extended:1},{retries:5});let s,n;switch(l){case"backward":s=v===t.items.length,n=!0;break;case"around":{const e=t.items.filter((({conversation_message_id:e})=>o.resolveCmid(e)<=d)).length;s=e===v+g;const r=t.items.length-e;n=r===-g;break}case"forward":s=!0,n=v===t.items.length;break;default:(0,r.exhaustivenessCheck)(l)}return{type:"UserScrolledConvoHistory_RequestSucceed",response:t,peerId:a,startCmid:d,hasMoreBackward:s,hasMoreForward:n}}catch(e){return{type:"UserScrolledConvoHistory_RequestFailed",peerId:a,startCmid:d}}})),function(e){return s.apply(this,arguments)})]}case"UserScrolledConvoHistory_RequestSucceed":{const{peerId:s,startCmid:n,response:r,hasMoreBackward:o,hasMoreForward:i}=t;e.locks.getHistory.delete(u(s,n));const d=e.convos.get(s);if(!d)return[];const h=r.items.map((e=>(0,l.fromApiMessage)(e).message));return a.insertMessages(d,h,{backward:o,forward:i}),(0,c.insertPeers)(e,{apiUsers:r.profiles||[],apiGroups:r.groups||[],apiContacts:[]}),[]}case"UserScrolledConvoHistory_RequestFailed":{const{peerId:s,startCmid:n}=t;return e.locks.getHistory.delete(u(s,n)),[]}default:(0,r.exhaustivenessCheck)(t)}var s};function u(e,t){return`${e}-${t}`}},688088:(e,t,s)=>{"use strict";s.d(t,{handler:()=>a});var n=s(11010),r=s(89131);const a=(e,t)=>{switch(t.type){case"UserSeenHelpHint":return e.helpHints.delete(t.hintId)?[(s=(0,n._)((function*({api:e}){try{return{type:"UserSeenHelpHint_RequestCompleted",hasFailed:1!==(yield e.fetch("account.hideHelpHint",{hint_id:t.hintId},{retries:1}))}}catch(e){return{type:"UserSeenHelpHint_RequestCompleted",hasFailed:!0}}})),function(e){return s.apply(this,arguments)})]:[];case"UserSeenHelpHint_RequestCompleted":return[];default:(0,r.exhaustivenessCheck)(t)}var s}},876107:(e,t,s)=>{"use strict";s.d(t,{handler:()=>l});var n=s(11010),r=s(89131),a=s(185327),o=s(83062),i=s(168465),c=s(991792);const l=(e,t,s)=>{switch(t.type){case"UserSeenMessages":{const{fromCmid:s,toCmid:n,peerId:r}=t,c=e.convos.get(r);if(!c)return[];const l=i.around(c.history,s);if(void 0===l)return[];const u=l.nodes.reduce(((e,t)=>{const s="Node"===t.kind?t.item:void 0;return void 0!==s&&s.cmid>e&&s.cmid<=n&&!s.isOut&&(e=s.cmid),e}),s),h=c.inReadBy;a.readInUntil(c,u);const m=[...c.unreadReactions.keys()].filter((e=>e>=s&&e<=n));if(c.inReadBy===h&&0===m.length)return[];m.forEach((e=>a.readReactions(c,e))),o.refresh(e.organisers,c);const p=e.readQueues.get(r);return p?(p.inReadBy=c.inReadBy,m.forEach((e=>p.reactions.add(e))),[]):(e.readQueues.set(r,{inReadBy:c.inReadBy,reactions:new Set(m)}),[d(r,h)])}case"UserSeenMessages_ThrottleTimedOut":{const{peerId:r,prevInReadBy:a}=t;if(!e.convos.get(r))return e.readQueues.delete(r),[];const o=e.readQueues.get(r);if(!o)return[];const i=[];for(const e of o.reactions)if(i.push(e),o.reactions.delete(e),100===i.length)break;const d=o.inReadBy,h=e.ownerId,m=a<d,p=!1!==s.vkm_reactions&&i.length>0;return m||p?[(u=(0,n._)((function*({api:e}){try{yield e.fetchMany([m&&{method:"messages.markAsRead",params:{peer_id:r,up_to_cmid:d,mark_conversation_as_read:1,group_id:(0,c.getOwnerGroupId)(h)}},p&&{method:"messages.markReactionsAsRead",params:{peer_id:r,cmids:i.join(","),group_id:(0,c.getOwnerGroupId)(h)}}])}catch(e){}return{type:"UserSeenMessages_RequestCompleted",peerId:r,readUntilCmid:d}})),function(e){return u.apply(this,arguments)})]:l(e,{type:"UserSeenMessages_RequestCompleted",peerId:r,readUntilCmid:d},s)}case"UserSeenMessages_RequestCompleted":{const{peerId:s,readUntilCmid:n}=t;if(!e.convos.get(s))return[];const r=e.readQueues.get(s);return r?r.inReadBy<=n&&0===r.reactions.size?(e.readQueues.delete(s),[]):[d(s,n)]:[]}default:return(0,r.exhaustivenessCheck)(t)}var u};function d(e,t){return s=(0,n._)((function*(){return yield(0,r.sleep)(500),{type:"UserSeenMessages_ThrottleTimedOut",prevInReadBy:t,peerId:e}})),function(){return s.apply(this,arguments)};var s}},416947:(e,t,s)=>{"use strict";s.d(t,{handler:()=>i});var n=s(11010),r=s(89131),a=s(86144),o=s(839963);const i=(e,t)=>{switch(t.type){case"UserSeenPost":{const{posts:s,channelId:n}=t,r=e.channels.get(n);if(!r)return[];if("ChannelRestricted"===r.kind)return[];const i=0===e.seenPostsStatsQueues.posts.size&&0===e.seenPostsStatsQueues.reposts.size&&!e.locks.seenPostsStatsSend,l=(t,s,n)=>{e.seenPosts[n].has(t)||e.seenPosts[n].set(t,new Set);const r=e.seenPosts[n].get(t);var a;r&&!r.has(s)&&(r.add(s),e.seenPostsStatsQueues[n].has(t)||e.seenPostsStatsQueues[n].set(t,new Set),null==(a=e.seenPostsStatsQueues[n].get(t))||a.add(s),r.size>=60&&e.seenPosts[n].set(t,new Set(Array.from(r).slice(-30))))};return s.forEach((e=>{if(l(n,e.cmid,"posts"),e.attaches.wall&&o.isChannelId(e.attaches.wall.authorId)){const t=o.resolveId(e.attaches.wall.authorId),s=a.resolveCmid(e.attaches.wall.id);l(t,s,"reposts")}})),[i&&(0!==e.seenPostsStatsQueues.posts.size||0!==e.seenPostsStatsQueues.reposts.size)&&c()]}case"UserSeenPost_ThrottleTimedOut":{e.locks.seenPostsStatsSend=!0;const t=[];e.seenPostsStatsQueues.posts.forEach(((e,s)=>{t.push(...l(s,e))})),e.seenPostsStatsQueues.posts=new Map;const r=[];return e.seenPostsStatsQueues.reposts.forEach(((e,t)=>{r.push(...d(t,e))})),e.seenPostsStatsQueues.reposts=new Map,[(s=(0,n._)((function*({api:e}){try{yield e.fetch("stats.trackEvents",{events:JSON.stringify([{e:"view_post",post_ids:t,repost_ids:r}])})}catch(e){}return{type:"UserSeenPost_RequestCompleted"}})),function(e){return s.apply(this,arguments)})]}case"UserSeenPost_RequestCompleted":return 0===e.seenPostsStatsQueues.posts.size&&0===e.seenPostsStatsQueues.reposts.size?(e.locks.seenPostsStatsSend=!1,[]):[c()];default:return(0,r.exhaustivenessCheck)(t)}var s};function c(){return e=(0,n._)((function*(){return yield(0,r.sleep)(2e3),{type:"UserSeenPost_ThrottleTimedOut"}})),function(){return e.apply(this,arguments)};var e}const l=(e,t)=>Array.from(t).map((t=>`${e}_${t}|wall|im_channels|0`)),d=(e,t)=>Array.from(t).map((t=>`${e}_${t}`))},37425:(e,t,s)=>{"use strict";s.d(t,{handler:()=>c});var n=s(11010),r=s(89131),a=s(185327),o=s(991792),i=s(927411);const c=(e,t)=>{switch(t.type){case"UserSetMessageReaction":{const{peerId:s,cmid:r,reactionId:d,onFail:u}=t,h=e.convos.get(s);if(!h)return[];const m=a.findMessageByCmid(h,r);if(!m||"Normal"!==m.kind)return[];const p=m.reactionId,f=e.ownerId;return l(m,d,e.ownerId),[(c=(0,n._)((function*({api:e}){try{return{type:"UserSetMessageReaction_RequestCompleted",hasFailed:1!==(yield e.fetch("messages.sendReaction",{cmid:r,peer_id:s,reaction_id:d,group_id:(0,o.getOwnerGroupId)(f)})),cmid:r,peerId:s,reactionId:d,prevReactionId:p,onFail:u}}catch(e){let t;return e instanceof i.IApi.RequestError&&(t=e.code),{type:"UserSetMessageReaction_RequestCompleted",hasFailed:!0,cmid:r,error:t,peerId:s,reactionId:d,prevReactionId:p,onFail:u}}})),function(e){return c.apply(this,arguments)})]}case"UserSetMessageReaction_RequestCompleted":{const{hasFailed:s,peerId:n,cmid:r,prevReactionId:o,onFail:i}=t;if(!s)return[];1011===t.error&&i();const c=e.convos.get(n);if(!c)return[];const d=a.findMessageByCmid(c,r);return d&&"Normal"===d.kind?(l(d,o,e.ownerId),[]):[]}case"UserUnsetMessageReaction":{const{peerId:r,cmid:i}=t,c=e.convos.get(r);if(!c)return[];const d=a.findMessageByCmid(c,i);if(!d||"Normal"!==d.kind||!d.reactionId)return[];const u=d.reactionId,h=e.ownerId;return l(d,void 0,e.ownerId),[(s=(0,n._)((function*({api:e}){try{return{type:"UserUnsetMessageReaction_RequestCompleted",hasFailed:1!==(yield e.fetch("messages.deleteReaction",{cmid:i,peer_id:r,group_id:(0,o.getOwnerGroupId)(h)})),cmid:i,peerId:r,reactionId:u}}catch(e){return{type:"UserUnsetMessageReaction_RequestCompleted",hasFailed:!0,cmid:i,peerId:r,reactionId:u}}})),function(e){return s.apply(this,arguments)})]}case"UserUnsetMessageReaction_RequestCompleted":{const{hasFailed:s,peerId:n,cmid:r,reactionId:o}=t;if(!s)return[];const i=e.convos.get(n);if(!i)return[];const c=a.findMessageByCmid(i,r);return c&&"Normal"===c.kind?(l(c,o,e.ownerId),[]):[]}default:(0,r.exhaustivenessCheck)(t)}var s,c};function l(e,t,s){const n=e.reactionId;if(e.reactionId=t,n){const t=e.reactions.get(n);if(!t&&r.isDev)throw new Error("Реакция не найдена в списке реакций сообщения");t&&(t.count<=1?e.reactions.delete(n):(t.count-=1,t.peerIds.delete(s)))}if(t){const n=e.reactions.get(t);n?(n.count+=1,n.peerIds=new Set([s,...n.peerIds])):e.reactions.set(t,{reactionId:t,count:1,peerIds:new Set([s])})}}},166358:(e,t,s)=>{"use strict";s.d(t,{handler:()=>i});var n=s(11010),r=s(999504),a=s(89131),o=s(991792);const i=(e,t)=>{switch(t.type){case"UserUpdatedFolder":{const{folderId:s,name:n,addPeerIds:a,removePeerIds:i}=t;if(e.locks.updateFolder.has(s))return[];if(function(e,t){if(new Set([...e].filter((e=>t.has(e)))).size)return!0;return!1}(a,i))throw new Error("Peer id не может одновременно находиться в списке на добавление и на удаление");e.locks.updateFolder.add(s);const l=e.organisers.folders.find((e=>e.id===s));if(!l)return[];const d=(0,o.getConvosByIds)(e,Array.from(i)),u=(0,o.getConvosByIds)(e,Array.from(a));return n&&r.setName(l,n),(0,o.removeConvosFromFolder)(e,l.id,d),(0,o.addConvosToFolder)(e,l.id,u),[c(s,n,a,i)]}case"UserUpdatedFolder_UpdateRequestCompleted":{const{hasFailed:s,folderId:n}=t;if(e.locks.updateFolder.delete(n),s&&a.isDev)throw new Error("Не удалось изменить папку");return[]}default:(0,a.exhaustivenessCheck)(t)}};function c(e,t,s,r){return a=(0,n._)((function*({api:n}){let a=!1;const o={folder_id:e};t&&(o.name=t),s.size&&(o.add_included_peer_ids=[...s].join(",")),r.size&&(o.remove_included_peer_ids=[...r].join(","));try{a=1!==(yield n.fetch("messages.updateFolder",o))}catch(e){a=!0}return{type:"UserUpdatedFolder_UpdateRequestCompleted",hasFailed:a,folderId:e,addPeerIds:s,removePeerIds:r,name:t}})),function(e){return a.apply(this,arguments)};var a}},296078:(e,t,s)=>{"use strict";s.d(t,{handler:()=>a});var n=s(11010),r=s(89131);const a=(e,t)=>{switch(t.type){case"VideoMessageShapesGetById":{var s;const{shapeId:r}=t;return e.locks.getVideoMessageShapesById.has(r)||(null==(s=e.videoMessageShapes)?void 0:s.has(r))?[]:(e.locks.getVideoMessageShapesById.add(r),[(o=(0,n._)((function*({api:e,storage:t}){const s=t.get("videomessage-shapes");s&&(s.expiresAt=0);try{const t=yield e.fetch("messages.getVideoMessageShapesByIds",{ids:r.toString()});return{type:"VideoMessageShapesGetById__RequestCompleted",shapeId:r,response:t,hasFailed:!Boolean(t)}}catch(e){return{type:"VideoMessageShapesGetById__RequestCompleted",shapeId:r,response:null,hasFailed:!0}}})),function(e){return o.apply(this,arguments)})])}case"VideoMessageShapesGetById__RequestCompleted":{const{response:s,shapeId:n}=t;if(e.locks.getVideoMessageShapesById.delete(n),!s)return[];const r=s.shapes.reduce(((e,t)=>(e.set(t.id,t.raw_path),e)),new Map);var a;return e.videoMessageShapes=new Map([...null!=(a=e.videoMessageShapes)?a:[],...r]),[]}default:return(0,r.exhaustivenessCheck)(t)}var o}},378002:(e,t,s)=>{"use strict";s.d(t,{createStore:()=>o});var n=s(136517),r=s(89131),a=s(14106);function o(e,t,s=a.initial,o,c,l,d){let u=!1;const h=r.isDev&&(0,n.devTools)();let m=[],[p,f]=s(t,o,c,l,d);h&&h.init(p);const g=s=>{if(!u)throw new Error("Стор еще не был активирован. Нужно вызвать store.start().");const[n,r]=(0,a.reducer)(p,s,t);h&&h.send(s,n);const o=p!==n;if(p=n,i(g,r,e),o)for(const e of m)e(n)};return{start:()=>{u||(u=!0,i(g,f,e))},dispatch:g,subscribe:e=>(m.push(e),()=>{m=m.filter((t=>t!==e))}),featureFlags:t,getState:()=>p}}function i(e,t,s){0!==t.length&&setTimeout((()=>{for(const n of t)"function"==typeof n&&n(s).then(e).catch((e=>{s.logger.error("Необработанная ошибка редьюсера",e)}))}))}},136517:(e,t,s)=>{"use strict";function n(){return"undefined"!=typeof window&&"__REDUX_DEVTOOLS_EXTENSION__"in window?window.__REDUX_DEVTOOLS_EXTENSION__.connect({serialize:{options:{map:!0,set:!0}}}):null}s.d(t,{devTools:()=>n})},14106:(e,t,s)=>{"use strict";s.d(t,{IMPORTANT_USERS_COUNT:()=>Ke,initial:()=>ze,reducer:()=>He});var n=s(11010),r=s(434788),a=s(453934),o=s(474582),i=s(991792),c=s(89131),l=s(83062),d=s(498928),u=s(999504),h=s(452788),m=s(185327),p=s(96190),f=s(777634),g=s(400681),v=s(559360),_=s(839963),C=s(86144),y=s(821551),k=s(709646),I=s(504698),E=s(882670),b=s(95154),w=s(597990),M=s(273971),S=s(109424),R=s(876107),A=s(733835),P=s(500156),F=s(664061),U=s(490469),N=s(526025),T=s(619444),x=s(708807),O=s(959630),L=s(203677),q=s(382379),B=s(397384),D=s(192241),z=s(475881),H=s(688088),G=s(598801),V=s(115804),W=s(427418),K=s(395911),j=s(791175),Z=s(623022),$=s(666840),Q=s(61448),X=s(694598),J=s(166358),Y=s(351447),ee=s(328079),te=s(741497),se=s(708315),ne=s(541222),re=s(863536),ae=s(339962),oe=s(735130),ie=s(584781),ce=s(12190),le=s(416947),de=s(262641),ue=s(4854),he=s(807331),me=s(464474),pe=s(967819),fe=s(29064),ge=s(939903),ve=s(623267),_e=s(43109),Ce=s(601289),ye=s(695247),ke=s(296078),Ie=s(573610),Ee=s(228153),be=s(37425),we=s(565321),Me=s(637467),Se=s(978758),Re=s(553977),Ae=s(972284),Pe=s(446869),Fe=s(527600),Ue=s(957046),Ne=s(954811),Te=s(628010),xe=s(82358),Oe=s(15778),Le=s(171949),qe=s(750142),Be=s(847281),De=s(699642);const ze=(e,t,s,a,o)=>{var i,c;const d=p.resolveId(t),u=s?p.resolveId(s):void 0;if(!p.isUserPeerId(d))throw Error("Viewer может быть только пользователем");if(void 0!==u&&!p.isUserPeerId(u)&&!p.isGroupPeerId(u))throw Error("Owner может быть только пользователем или группой");const h=(0,w.fromApiProfileType)(a),m={convoConn:{status:"loading",pts:0},channelConn:{status:"running",ts:0},viewer:{id:d,profileType:h,settings:{ctrSubmit:!1,soundNotifications:!0,browserNotifications:!1,showRecommendations:!0,countOnlyNotMuted:!1,autoUnarchive:!0,transcriptAutoShow:!0,theme:"system",verticalFoldersView:!1,messageReactionAnimation:!0,businessNotify:!1,push:k.VIEWER_DEFAULT_PUSH_SETTINGS,teacherVerification:!1,rightClickActionsEnabled:!1,messageSelfMentionHighlighting:"none",eduAccountSwitchBanner:!0,autoExtendReactionPicker:!1,bubblesTheme:"default"},profileInfo:{id:d},accounts:[]},ownerId:p.resolveId(),organisers:l.empty(),channels:new Map([[_.resolveId(0),{kind:"Channel",id:_.resolveId(0),name:"",description:[],activity:"",adminLevel:0,isVerified:!1,photos:{},inReadCmid:C.resolveCmid(0),unreadCount:0,isArchived:!1,isRepostsDisabled:!1,isMuted:!1,isClosed:!1,notificationsDisabledUntil:0,majorSortId:0,minorSortId:0,membersCount:0,isMember:!1,rights:{canPost:!1,canSendDonut:!1},pending:{},locks:{loading:!1,cleanUp:0},history:{confirmed:[],pending:[]},actionButton:{isEnabled:!1}}]]),convos:new Map([[p.resolveId(),{kind:"UserConvo",peerId:p.resolveId(),unreadCount:0,majorSortId:0,minorSortId:0,inReadBy:f.resolveCmid(0),outReadBy:f.resolveCmid(0),isNew:!1,folderIds:new Set,isMarkedUnread:!1,isArchived:!1,canWrite:{allowed:!1,reason:"unknown"},push:{mode:"everything",disabledUntil:0},unreadExpireables:new Set,unreadReactions:new Map,entrypoint:null,history:{confirmed:[],pending:[]}}]]),composerDrafts:{},channelComposerDrafts:{},commentsComposerDrafts:{},readQueues:new Map,seenPosts:{posts:new Map,reposts:new Map},seenPostsStatsQueues:{posts:new Map,reposts:new Map},channelReadQueues:new Map,peers:new Map([[p.resolveId(),{kind:"User",id:p.resolveId(),firstName:"...",firstNameGen:"...",firstNameAcc:"...",lastName:"...",lastNameGen:"...",lastNameAcc:"...",sex:"unknown",isVerified:!1,canCall:!0,followersCount:0,canChangeFriendship:!1,canMessage:!1,friendship:"unfamiliar",isBlacklisted:!1,isBlacklistedByMe:!1,isProfileClosed:!1,isDeactivated:!1,canInviteToChats:!1}]]),lastSeens:new Map,typings:new Map,convosSearchIndex:y.create(),locks:{getConversations:{all:!1,unread:!1,archive:!1,messageRequest:!1},getChannels:{all:!1,unread:!1},hideFilter:{all:!1,unread:!1,chats:!1,archive:!1,messageRequest:!1,businessNotify:!1},getHistory:new Set,getConversationRestrictedMembers:new Set,getConversationMembers:new Set,getConversationInfo:new Set,sendQueue:new Map,edit:new Set,convosCleanup:new Map,channelsCleanup:new Map,updateFriendshipOrMembership:new Set,convoActions:new Set,messageActions:new Set,channelActions:new Set,channelPostActions:new Set,settings:new Set,contactList:!1,newFolder:!1,deleteFolder:new Set,updateFolder:new Set,reorderFolders:!1,getChannelHistory:new Set,changeMessageRequest:new Set,getPostCommentsHistory:new Set,likeActions:new Set,commentActions:new Set,getVideoMessageShapesById:new Set,loadStickers:new Set,seenPostsStatsSend:!1,invalidateMessageReactions:!1,loadStickersKeywords:!1,loadStickerPacks:!1,loadRecommendedFolders:!1,readAllReactions:new Set,sendComment:new Set},hiddenPinnedMessages:new Map,helpHints:new Set,stickers:new Map,stickersKeywords:{},contacts:{items:new Map,contacts:new Map,hasMore:!0},importantMessages:{messages:new Map,hasMore:!0},hiddenBotKeyboards:new Set,reactions:new Map,messageReactions:new Map,importantUsers:null,videoMessageShapes:null,activeCallsCount:0,messageReactedPeers:new Map};if(0===d)return[m,[]];const g=void 0!==o&&(null==(i=o.viewer)?void 0:i.id)===d&&(null==(c=o.viewer)?void 0:c.profileType)===h&&(void 0===u||o.ownerId===u);return[g?(0,r._)({},m,o):m,[(v=(0,n._)((function*({storage:e,stats:t}){return e.identify(d),t.init(),{type:"Noop"}})),function(e){return v.apply(this,arguments)}),()=>Promise.resolve({type:"InitialData",ownerId:u,withCache:g}),(0,n._)((function*({api:e,storage:t}){const s=yield function(e){return We.apply(this,arguments)}({api:e,storage:t});return{type:"LoadVideoMessageShapes_RequestCompleted",videoMessageShapes:s}})),(0,n._)((function*(){return e.vkm_reactions?{type:"InvalidateMessageReactions"}:{type:"Noop"}}))]];var v};function He(e,t,s){if("TemporaryHackForResync"===t.type){const[t,n]=ze(s,e.viewer.id,e.ownerId,"edu"===e.viewer.profileType?2:0);return t.organisers.filters.unread.headerNotMutedUnread=e.organisers.filters.unread.headerNotMutedUnread,[t,n]}const r=(0,a.createDraft)(e);let o;switch(t.type){case"Noop":o=[];break;case"InitialData":case"InitialData_RequestCompleted":case"InitialDataWithCached_RequestCompleted":case"InitialData_ChannelsReadyForUse":case"QueueConfigAndUsersFromSearch_RequestCompleted":o=Ge(r,t,s);break;case"LoadVideoMessageShapes_RequestCompleted":o=Ve(r,t,s);break;case"EngineBatchReceived":case"EngineBatchReceived_TypingsTimedOut":case"UpdateMessageRequestsCounter":case"UpdateMessageRequestsCounter_RequestCompleted":o=P.handler(r,t,s);break;case"ChannelEngineBatchReceived":o=F.handler(r,t,s);break;case"QueueBatchReceived":o=D.handler(r,t,s);break;case"MoreConvosNeeded":case"MoreConvosNeeded_RequestCompleted":o=L.handler(r,t,s);break;case"MoreChannelsNeeded":case"MoreChannelsNeeded_RequestCompleted":o=q.handler(r,t,s);break;case"CacheUpdateReceived":o=B.handler(r,t,s);break;case"UserSeenMessages":case"UserSeenMessages_ThrottleTimedOut":case"UserSeenMessages_RequestCompleted":o=R.handler(r,t,s);break;case"UserHitSend":case"UserHitSend_RequestCompleted":case"UserHitResendAllFailedMessages":case"ResendAllFailedMessages":case"UserHitResendFailedMessage":case"UserHitSendWidget":o=M.handler(r,t,s);break;case"UserHitEdit":case"UserHitEdit_RequestCompleted":o=S.handler(r,t,s);break;case"UserOpenedConvo":case"UserClosedConvo":case"UserOpenedConvo_ConvoRequestCompleted":case"UserOpenedConvo_StickersKeywordsRequestCompleted":case"UserOpenedConvo_StickerPacksRequestCompleted":o=A.handler(r,t,s);break;case"LoadStickers":case"LoadStickers_RequestCompleted":o=Ee.handler(r,t,s);break;case"UserChangedFriendship":case"UserChangedFriendship_RequestCompleted":o=x.handler(r,t,s);break;case"UserChangedGroupMembership":case"UserChangedGroupMembership_RequestCompleted":o=O.handler(r,t,s);break;case"UserChangedSetting":case"UserChangedSetting_RequestCompleted":o=U.handler(r,t,s);break;case"SettingThemeUpdated":case"SettingThemeUpdated_RequestCompleted":o=N.handler(r,t,s);break;case"SettingExperimentalUpdated":case"SettingExperimentalUpdated_RequestCompleted":o=T.handler(r,t,s);break;case"UserChangedBubblesTheme":case"UserChangedBubblesTheme_RequestCompleted":o=xe.handler(r,t,s);break;case"UserPlayedMessage":case"UserPlayedMessage_RequestCompleted":o=z.handler(r,t,s);break;case"UserSeenHelpHint":case"UserSeenHelpHint_RequestCompleted":o=H.handler(r,t,s);break;case"UserChangedConvo":case"UserChangedConvo_RequestCompleted":case"UserPinMessage":case"UserPinMessage_RequestCompleted":case"UserUnpinMessage":case"UserUnpinMessage_RequestCompleted":case"UserChangedMute":case"UserChangedMute_RequestCompleted":case"UserChangedBusinessNotify":case"UserChangedBusinessNotify_RequestCompleted":case"UserChangeForbidWritingAll":case"UserChangeForbidWritingAll_RequestCompleted":case"UserRestrictChatMemberToWrite":case"UserRestrictChatMemberToWrite_RequestCompleted":o=G.handler(r,t,s);break;case"UserChangedMessage":case"UserChangedMessage_RequestCompleted":case"UserDeleteMessage":case"UserDeleteMessage_RequestCompleted":case"UserDeleteFailedMessage":case"UserDeleteAllFailedMessage":case"UserRestoreMessage":case"UserRestoreMessage_RequestCompleted":o=V.handler(r,t,s);break;case"LoadContactList":case"LoadContactList_RequestCompleted":o=W.handler(r,t,s);break;case"UserHideFilter":case"UserHideFilter_Completed":case"UserUndoHideFilter":case"UserActualizeHideFilter":o=j.handler(r,t,s);break;case"UserAcceptedChatMessageRequest":case"UserRejectedMessageRequest":case"UserAcceptedChatMessageRequest_RequestCompleted":case"UserRejectedChatMessageRequest_RequestCompleted":o=K.handler(r,t,s);break;case"UserChangedChatTitle":case"UserChangedChatDescription":case"UserChangedChatTitle_RequestCompleted":case"UserChangedChatDescription_RequestCompleted":case"UserRemovedChatPhoto":case"UserSetChatPhoto":case"UserRemovedChatPhoto_RequestCompleted":case"UserChangedChatSettings":case"UserChangedChatSettings_RequestCompleted":o=Z.handler(r,t,s);break;case"UserOpenedConvoProfile":case"UserOpenedConvoProfile_ConvoRequestCompleted":case"UserOpenedConvoProfile_InviteLinksCompleted":o=$.handler(r,t,s);break;case"LoadImportantMessages":case"LoadImportantMessages_RequestCompleted":case"UserClosedImportantMessages":o=Q.handler(r,t,s);break;case"UserCreatedFolder":case"UserCreatedFolder_CreateRequestCompleted":o=X.handler(r,t,s);break;case"UserUpdatedFolder":case"UserUpdatedFolder_UpdateRequestCompleted":o=J.handler(r,t,s);break;case"UserDeletedFolder":case"UserDeletedFolder_DeleteRequestCompleted":o=Y.handler(r,t,s);break;case"UserReorderedFolders":case"UserReorderedFolders_ReorderRequestCompleted":o=ee.handler(r,t,s);break;case"UserScrolledChannelHistory":case"UserScrolledChannelHistory_RequestSucceed":case"UserScrolledChannelHistory_RequestFailed":o=te.handler(r,t,s);break;case"UserOpenedChannel":case"UserClosedChannel":case"UserOpenedChannel_ChannelRequestCompleted":o=se.handler(r,t,s);break;case"ConvoMediaViewerCacheRemoved":case"ConvoMediaViewerCacheInserted":case"ConvoMediaViewerCacheSetHasNext":case"ConvoMediaViewerCacheSetHasPrev":o=ue.handler(r,t,s);break;case"UserChangedChatMember":case"UserChangedChatMember_RequestCompleted":case"UserRemoveIncognitoMember":case"UserRemoveIncognitoMember_RequestCompleted":o=ne.handler(r,t,s);break;case"UserRequestChatInvitationLink":case"UserRequestChatInvitationLink_RequestCompleted":case"UserResetChatInvitationLink":case"UserResetChatInvitationLink_RequestCompleted":o=re.handler(r,t,s);break;case"LoadChatMembers":case"LoadChatMembers_RequestComplete":o=ae.handler(r,t,s);break;case"LoadChatInfo":case"LoadChatInfo_RequestComplete":o=oe.handler(r,t,s);break;case"UserChangedChannel":case"UserChangedChannel_RequestCompleted":case"UserSetChannelPhoto":case"UserUpdateChannelInfo":o=ie.handler(r,t,s);break;case"UserChangedChannelPost":case"UserChangedChannelPost_RequestCompleted":o=ce.handler(r,t,s);break;case"UserSeenPost":case"UserSeenPost_ThrottleTimedOut":case"UserSeenPost_RequestCompleted":o=le.handler(r,t,s);break;case"UserReadPost":case"UserReadPost_ThrottleTimedOut":case"UserReadPost_RequestCompleted":o=de.handler(r,t,s);break;case"UserLoadedCommentsHistory":case"UserLoadedCommentsHistory_RequestSucceed":case"UserLoadedCommentsHistory_RequestFailed":o=me.handler(r,t,s);break;case"ChannelsOnboardingDone":case"ChannelsOnboardingDone_RequestSucceeded":case"ChannelsOnboardingDone_RequestFailed":o=pe.handler(r,t,s);break;case"UserChangedComposerDraft":case"UserClearedComposerDraft":case"ComposerDraftsUpdateNeeded":case"ActualizeComposerDraft":case"ActualizeComposerDraft_RequestCompleted":o=fe.handler(r,t,s);break;case"ResetUpdatesCounter":case"ResetUpdatesCounter_RequestCompleted":o=ge.handler(r,t,s);break;case"UserProfileInfo_Update":o=he.handler(r,t,s);break;case"UserChangedMessageAttachment":case"UserChangedMessageAttachment_RequestCompleted":o=ve.handler(r,t,s);break;case"UserChangedComment":case"UserChangedComment_RequestCompleted":o=Ce.handler(r,t,s);break;case"UserLoadedLikes":case"UserLoadedLikes_RequestCompleted":case"UserChangedLike":case"UserChangedLike_RequestCompleted":o=_e.handler(r,t,s);break;case"UserChangedBrowserNotifications":case"UserChangedBrowserNotifications_RequestCompleted":o=ye.handler(r,t,s);break;case"UserSetMessageReaction":case"UserSetMessageReaction_RequestCompleted":case"UserUnsetMessageReaction":case"UserUnsetMessageReaction_RequestCompleted":o=be.handler(r,t,s);break;case"ImportContact":o=Re.handler(r,t,s);break;case"VideoMessageShapesGetById":case"VideoMessageShapesGetById__RequestCompleted":o=ke.handler(r,t,s);break;case"UserChangedPostAttachment":case"UserChangedPostAttachment_RequestCompleted":o=Ie.handler(r,t,s);break;case"PollConvoReactions":case"PollConvoReactions_RequestSucceed":o=we.handler(r,t,s);break;case"UserChangedChannelComposerDraft":case"UserClearedChannelComposerDraft":o=Me.handler(r,t,s);break;case"UserHitPostSend":case"UserHitPostSend_RequestCompleted":o=Se.handler(r,t,s);break;case"InvalidateMessageReactions":case"InvalidateMessageReactions_RequestCompleted":o=Ae.handler(r,t,s);break;case"UserChangedPushSetting":case"UserChangedPushSetting_RequestCompleted":o=Pe.handler(r,t,s);break;case"UserScrolledConvoHistory":case"UserScrolledConvoHistory_RequestSucceed":case"UserScrolledConvoHistory_RequestFailed":o=Fe.handler(r,t,s);break;case"UserReadAllReactions":case"UserReadAllReactions_RequestCompleted":o=Ue.handler(r,t,s);break;case"PollChannelPosts":case"PollChannelPosts_RequestSucceed":o=Te.handler(r,t,s);break;case"LoadRecommendedFolders":case"LoadRecommendedFolders_RequestComplete":o=Oe.handler(r,t,s);break;case"UserHitCommentSend":case"UserHitCommentSend_RequestCompleted":case"UserHitCommentSend_HistoryRequestCompleted":o=qe.handler(r,t,s);break;case"UserChangedCommentsComposerDraft":case"UserClearedCommentsComposerDraft":o=Be.handler(r,t,s);break;case"UserHitEditComment":case"UserHitEditComment_RequestCompleted":o=De.handler(r,t,s);break;default:(0,c.exhaustivenessCheck)(t)}r.convos.set(p.resolveId(),m.safeGet(e.convos,p.resolveId())),r.peers.set(p.resolveId(),p.safeGet(e.peers,p.resolveId())),r.channels.set(_.resolveId(0),_.safeGet(e.channels,_.resolveId(0)));const i=(0,a.finishDraft)(r);var l;if(e.hiddenPinnedMessages!==i.hiddenPinnedMessages&&o.push((l=(0,n._)((function*({storage:e}){return e.set("hidden-pinned-messages",Array.from(i.hiddenPinnedMessages.entries()).reduce(((e,[t,s])=>(e[t]=s,e)),{})),{type:"Noop"}})),function(e){return l.apply(this,arguments)})),e.hiddenBotKeyboards!==i.hiddenBotKeyboards&&o.push((0,n._)((function*({storage:e}){return e.set("hidden-bot-keyboards",i.hiddenBotKeyboards),{type:"Noop"}}))),i.organisers.filters.businessNotify.isHidden&&"Noop"!==t.type&&"UserUndoHideFilter"!==t.type&&"visible"===document.visibilityState){const e=i.organisers.filters.businessNotify.unreadCount;o.push((0,n._)((function*(){return 0===e?{type:"Noop"}:{type:"UserUndoHideFilter",kind:"businessNotify"}})))}return[i,o]}const Ge=(e,t,s)=>{switch(t.type){case"InitialData":{const{ownerId:a,withCache:l}=t,d=a?(0,i.getOwnerGroupId)(a):0,u=e.viewer.id,h=(0,n._)((function*({engine:e,api:t,storage:n}){var a,i,h,m,p;if(s.vkm_new_chunk_parser){I.dontUse__enableNewParser__hack();let e=!1,t=500;for(;!e;)try{yield(0,o.default)(),e=!0}catch(e){yield(0,c.sleep)(t),t=Math.min(2*t,2e3)}}if(l){var f,_;const[e,s,n]=yield t.fetchMany([{method:"account.getInfo",params:{fields:b.API_GET_INFO_FIELDS.join(",")}},{method:"account.getMulti",params:{fields:b.API_GET_MULTI_FIELDS.join(",")}},{method:"account.getProfileInfo",params:{}}],{retries:2,timeout:2e4});return{type:"InitialDataWithCached_RequestCompleted",responseMultiAccount:s,responseProfileInfo:n,serverUserSettings:{ctrSubmit:Boolean(e.messages_multiline_input),showRecommendations:!Boolean(e.messages_recommendation_list_hidden),countOnlyNotMuted:Boolean(e.show_only_not_muted_messages),autoUnarchive:Boolean(e.messages_auto_unarchive),transcriptAutoShow:Boolean(e.messages_transcript_auto_show),businessNotify:Boolean(e.business_notify_enabled),teacherVerification:Boolean("1"===(null==(_=e.settings)||null==(f=_.find((e=>"messages_show_banner_teacher_verification"===e.name)))?void 0:f.value))}}}const C=yield t.fetch("messages.getLongPollServer",{need_pts:1,lp_version:e.version,group_id:d},{retries:1/0,usePrefetch:!0});if(!C.pts)throw new Error("Отсутствует pts");e.connect((0,r._)({},C,{pts:C.pts}));const[y,E,w,M,S,R,A,P,F,U]=yield t.fetchMany([{method:"messages.getConversations",params:{count:b.CONVOS_PER_PAGE,group_id:d,extended:1}},{method:"messages.getConversationsById",params:{peer_ids:u.toString(),group_id:d,extended:1}},{method:"messages.getFolders",params:{}},{method:"users.get",params:{}},0!==d&&{method:"groups.getById",params:{group_ids:String(d)}},{method:"account.getCounters",params:{filter:"all"}},{method:"account.getInfo",params:{fields:b.API_GET_INFO_FIELDS.join(",")}},{method:"account.getHelpHints",params:{categories:"im"}},{method:"account.getMulti",params:{fields:b.API_GET_MULTI_FIELDS.join(",")}},{method:"account.getProfileInfo",params:{}}],{retries:1/0,timeout:2e4,usePrefetch:!0}),N=null==(i=S)||null==(a=i.groups)?void 0:a[0],T=M[0];if(!T)throw new Error("Не удалось получить текущего пользователя");var x,O,L,q,B,D,z,H,G,V,W;return{type:"InitialData_RequestCompleted",responseViewer:T,responseMultiAccount:F,responseGroup:N,responseConvos:y,responseProfileInfo:U,responseViewerConvo:E,hasMoreConvos:y.items.length>=b.CONVOS_PER_PAGE,folders:w,activeCallsCount:R.calls||0,unreadCount:{messages:R.messages||0,messagesUnmuted:R.messages_unread_unmuted||0,archive:R.messages_archive_unread||0,archiveMentions:R.messages_archive_mentions_count||0,archiveTotal:R.messages_archive||0,messageRequest:R.message_requests||0,businessNotify:R.business_notify||0,businessNotifyTotal:R.business_notify_all||0,channelsTotal:(null==(h=R.channels)?void 0:h.total_count)||0,folders:R.messages_folders||[]},convoLp:{pts:C.pts},hiddenPinnedMessages:n.get("hidden-pinned-messages"),hiddenBotKeyboards:n.get("hidden-bot-keyboards"),composerDrafts:g.validateRequiredFields(n.get("drafts")||{}),channelComposerDrafts:v.validateRequiredFields(n.get("channels-drafts")||{}),commentsComposerDrafts:n.get("comments-drafts")||{},businessNotifyManuallyHidden:!!n.get("business-notify-manually-hidden"),userSettings:{ctrSubmit:Boolean(A.messages_multiline_input),soundNotifications:null==(x=n.get("settings-sound-notifications-on"))||x,eduAccountSwitchBanner:null==(O=n.get("settings-edu-account-switch-banner-on"))||O,browserNotifications:null!=(L=n.get("settings-browser-notifications-on"))&&L,showRecommendations:!Boolean(A.messages_recommendation_list_hidden),countOnlyNotMuted:Boolean(A.show_only_not_muted_messages),autoUnarchive:Boolean(A.messages_auto_unarchive),transcriptAutoShow:Boolean(A.messages_transcript_auto_show),theme:null!=(q=n.get("theme"))?q:"system",verticalFoldersView:null!=(B=n.get("folders-view-vertical"))&&B,messageReactionAnimation:null==(D=n.get("message-reactions-animation"))||D,businessNotify:Boolean(A.business_notify_enabled),push:null!=(z=n.get("settings-push"))?z:k.VIEWER_DEFAULT_PUSH_SETTINGS,teacherVerification:Boolean("1"===(null==(p=A.settings)||null==(m=p.find((e=>"messages_show_banner_teacher_verification"===e.name)))?void 0:m.value)),rightClickActionsEnabled:null!=(H=n.get("settings-right-click-actions-enabled"))&&H,messageSelfMentionHighlighting:null!=(G=n.get("settings-message-self-mention-highlighting"))?G:"none",autoExtendReactionPicker:null!=(V=n.get("settings-auto-extend-reaction-picker"))&&V,bubblesTheme:null!=(W=n.get("settings-bubbles-theme"))?W:"default"},helpHints:P.items.reduce(((e,t)=>(e.add(t.id),e)),new Set)}}));return l?[(D=(0,n._)((function*(){return{type:"EngineBatchReceived",variant:{kind:"FromEngine",next:{kind:"Failure"}}}})),function(){return D.apply(this,arguments)}),h]:[(B=(0,n._)((function*({storage:e}){var t;return{type:"SettingThemeUpdated",value:null!=(t=e.get("theme"))?t:"system"}})),function(e){return B.apply(this,arguments)}),h]}case"InitialDataWithCached_RequestCompleted":e.viewer.profileInfo=(0,w.fromApiViewerProfileInfo)(t.responseProfileInfo),e.viewer.accounts=t.responseMultiAccount.items.map(w.fromApiViewerAccount),e.viewer.settings=(0,r._)({},e.viewer.settings,t.serverUserSettings);return[je(e.viewer.id,e.ownerId,!0),(q=(0,n._)((function*({channelEngine:e}){return e&&s.me_channels?{type:"ChannelEngineBatchReceived",variant:{kind:"FromChannelEngine",next:{kind:"Failure"}}}:{type:"Noop"}})),function(e){return q.apply(this,arguments)})];case"InitialData_RequestCompleted":{var a;e.convoConn={status:"running",pts:t.convoLp.pts},e.activeCallsCount=t.activeCallsCount,e.hiddenPinnedMessages=new Map(Object.entries(t.hiddenPinnedMessages||{}).map((([e,t])=>[p.resolveId(parseInt(e)),f.resolveCmid(t)]))),e.hiddenBotKeyboards=t.hiddenBotKeyboards||new Set,e.composerDrafts=t.composerDrafts,e.channelComposerDrafts=t.channelComposerDrafts,e.commentsComposerDrafts=t.commentsComposerDrafts;const r=(0,i.insertConvos)(e,t.responseConvos.items);(0,i.insertConvos)(e,t.responseViewerConvo.items),e.organisers.filters.businessNotify.isHidden=!!t.businessNotifyManuallyHidden,d.push(e.organisers.filters,"all",r,t.hasMoreConvos),0===t.unreadCount.archiveTotal&&d.push(e.organisers.filters,"archive",[],!1),0===t.unreadCount.messageRequest&&d.push(e.organisers.filters,"messageRequest",[],!1),d.updateCounters(e.organisers.filters,{unread:t.unreadCount.messages,unreadUnmuted:t.unreadCount.messagesUnmuted,archive:t.unreadCount.archive,archiveMentions:t.unreadCount.archiveMentions,archiveTotal:t.unreadCount.archiveTotal,messageRequests:t.unreadCount.messageRequest,businessNotify:t.unreadCount.businessNotify,businessNotifyTotal:t.unreadCount.businessNotifyTotal}),(0,i.insertFolders)(e,t.folders.items.map(Le.fromApiFolder)),null==(a=t.unreadCount.folders)||a.forEach((t=>{u.setUnreadCounters(e.organisers.folders,u.resolveId(t.folder_id),t.total_count,t.unmuted_count)})),h.updateCounters(e.organisers.channelFilters,{unread:t.unreadCount.channelsTotal,archiveTotal:0}),(0,i.insertPeers)(e,{apiUsers:[...t.responseConvos.profiles||[]],apiGroups:[...t.responseConvos.groups||[]],apiContacts:[...t.responseConvos.contacts||[]]}),e.viewer.profileInfo=(0,w.fromApiViewerProfileInfo)(t.responseProfileInfo);const{user:o}=(0,E.fromApiUser)(t.responseViewer);e.peers.set(o.id,o),e.viewer.id=o.id,e.viewer.accounts=t.responseMultiAccount.items.map(w.fromApiViewerAccount);const c=t.responseGroup?(0,E.fromApiGroup)(t.responseGroup):void 0;c&&e.peers.set(c.id,c);const l=c?c.id:o.id;return e.ownerId=l,e.viewer.settings=t.userSettings,e.helpHints=t.helpHints,[(L=(0,n._)((function*({engine:e}){return{type:"EngineBatchReceived",variant:{kind:"FromEngine",next:yield e.poll()}}})),function(e){return L.apply(this,arguments)}),je(o.id,l,!1),function(){var e=(0,n._)((function*({api:e,channelEngine:t}){if(!t||!s.me_channels)return{type:"Noop"};try{const[s,n]=yield e.fetchSeq([{method:"channels.getLongPollServer",params:{}},{method:"channels.get",params:{count:b.CHANNELS_PER_PAGE,extended:1}}],{retries:1/0});return t.connect(s),{type:"InitialData_ChannelsReadyForUse",channelLpTS:s.ts,channelsGetResponse:n}}catch(e){return{type:"Noop"}}}));return function(t){return e.apply(this,arguments)}}()]}case"QueueConfigAndUsersFromSearch_RequestCompleted":{var l,m,_,C;const{queueConfig:s,importantUsers:a,selectedFromSearchConvos:o}=t;var y,M,S,R,A,P,F;(0,i.insertConvos)(e,[...a.items,...null!=(y=null==(l=o)?void 0:l.items)?y:[]]),(0,i.insertPeers)(e,{apiUsers:[...null!=(M=a.profiles)?M:[],...null!=(S=null==(m=o)?void 0:m.profiles)?S:[]],apiGroups:[...null!=(R=a.groups)?R:[],...null!=(A=null==(_=o)?void 0:_.groups)?A:[]],apiContacts:[...null!=(P=a.contacts)?P:[],...null!=(F=null==(C=o)?void 0:C.contacts)?F:[]]});const c=a.items.reduce(((e,t)=>{const s=(0,Ne.fromApiConvo)(t);return s&&e.add(s.convo.peerId),e}),new Set);e.importantUsers=c;const d=e.viewer.id;return[(O=(0,n._)((function*({queue:e}){return e.connect((0,r._)({user_id:p.toRealId(d)},s)),{type:"QueueBatchReceived",next:yield e.poll()}})),function(e){return O.apply(this,arguments)})]}case"InitialData_ChannelsReadyForUse":{var U,N,T;e.channelConn={status:"running",ts:t.channelLpTS};const s=(0,i.insertChannels)(e,{apiChannels:t.channelsGetResponse.items||[],apiGroups:t.channelsGetResponse.groups||[]}),r=((null==(U=t.channelsGetResponse.items)?void 0:U.length)||0)>=b.CHANNELS_PER_PAGE;return h.push(e.organisers.channelFilters,"all",s,r),(0,i.insertPeers)(e,{apiUsers:[...(null==(N=t.channelsGetResponse)?void 0:N.profiles)||[]],apiGroups:[...(null==(T=t.channelsGetResponse)?void 0:T.groups)||[]],apiContacts:[]}),[(x=(0,n._)((function*({channelEngine:e}){return e?{type:"ChannelEngineBatchReceived",variant:{kind:"FromChannelEngine",next:yield e.poll()}}:{type:"Noop"}})),function(e){return x.apply(this,arguments)})]}default:return[]}var x,O,L,q,B,D},Ve=(e,t)=>{var s,n;return"LoadVideoMessageShapes_RequestCompleted"===t.type?(e.videoMessageShapes=null!=(n=null==(s=t.videoMessageShapes)?void 0:s.shapes.reduce(((e,{id:t,raw_path:s})=>(e.set(t,s),e)),new Map))?n:new Map,[]):[]};function We(){return(We=(0,n._)((function*({api:e,storage:t}){var s;const n=t.get("videomessage-shapes"),a=Math.round((new Date).getTime()/1e3),o=n&&n.expiresAt>a;let i=null;if(o)i=n.response;else try{var c,l;i=yield e.fetch("messages.getVideoMessageShapes",{client_version:null!=(l=null==(c=n)?void 0:c.response.version)?l:0},{retries:3})}catch(e){}const d=i?(0,r._)({},i,{shapes:[...(null==(s=n)?void 0:s.response.shapes)||[],...i.shapes]}):null;return!o&&d&&t.set("videomessage-shapes",{response:d,expiresAt:a+86400}),d}))).apply(this,arguments)}const Ke=10;function je(e,t,s){const r=(0,i.getOwnerGroupId)(t);return(0,n._)((function*({api:t,storage:n}){var a;const o=n.get("selected-convos-from-search"),[i,c,l]=yield t.fetchMany([{method:"queue.subscribe",params:{queue_ids:`onlfriends_${e},accountcounters_${e}`}},{method:"messages.searchConversations",params:{q:" ",count:Ke,extended:1,group_id:r}},!s&&!!(null==(a=o)?void 0:a.length)&&{method:"messages.getConversationsById",params:{peer_ids:o.join(","),extended:1,group_id:r}}],{retries:1/0});return{type:"QueueConfigAndUsersFromSearch_RequestCompleted",queueConfig:i,importantUsers:c,selectedFromSearchConvos:l}}))}},812081:(e,t,s)=>{"use strict";s.d(t,{initConfig:()=>r});var n=s(453934);function r(){(0,n.enableMapSet)()}},421199:(e,t,s)=>{"use strict";s.d(t,{useUniqId:()=>a});var n=s(667294);let r=0;function a(){const[e]=(0,n.useState)((()=>r++));return`:r${e}:`}},923562:(e,t,s)=>{"use strict";e.exports=s.p+"27cd5b4a8c2a8a0e12d1.js"}}]);try{stManager.done("dist/6371cbc4dd835690f02354240daa0a3d.99e2ac2a628883b2fb0e.js")}catch(e){}